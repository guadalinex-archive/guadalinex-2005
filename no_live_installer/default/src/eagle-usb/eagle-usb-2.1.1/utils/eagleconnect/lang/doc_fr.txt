EagleConnect v. 0.8 
(rev. 3 du 11/04/2004)

(Documentation réalisée avec OpenOffice 1.1.0)



Sommaire

 
Préambule ......................................................................2

Présentation ...................................................................2

	les nouveautés de la version 0.8 .........................................3

Paquetages ou logiciels requis .................................................4

Installer le driverEagle .......................................................4

Installer EagleConnect .........................................................6

	suppression de l'ancienne version d'EagleConnect..........................6
	récupération et installation des fichiers d'EagleConnect..................6
	modifier le fichier /etc/sudoers..........................................7

Utiliser EagleConnect ..........................................................8

	premier lancement d'EagleConnect..........................................9
	découverte d'EagleConnect................................................10
	modifier la langue de l'interface........................................11

Evolutions attendues ..........................................................12

Remerciements .................................................................12

Licence .......................................................................13

Disclaimer ....................................................................13

























I)Préambule

EagleConnect, avant d'être un logiciel, est d'abord un hommage. C'est l'expression d'un grand remerciement que j'adresse à tous les développeurs qui ont travaillé sur le pilote Eagle-usb, ses outils et sa documentation pour gérer le modem Sagem Fast 800 et ses dérivés sous Linux. 
Il ont permis à de simples utilisateurs, dont je fais partie, de pouvoir bénéficier de leur connexion ADSL sous ce magnifique système d'exploitation. 

Je remercie donc, dans l'ordre :  
- Benoît Audouard (Baud123, concepteur du module "Eaglediag", testeur et Webmaster du  
  site consacré au driver eagle :  http://eagle-usb.ath.cx/pub/sommaire.php3)
- Olivier Borowski (Tux,  gestion des packages et scripts install/init)
- Christian Casteyde (Correcteur du driver Eagle-usb fourni par Sagem/Free)
- Stéphane Collet (Sco35, ex Webmaster de l'ancien site, eagle-usb.fr.st)
- Jérôme Marant (Développeur de eagleconfig.pl, un configurateur graphique pour le driver) 
- Cyril Martin (Mcoolive, packaging Debian)
- Roland Mas (Packaging Debian)
- Frédérick Ros  (Sleeper, développeur du driver, gestion des packages, scripts install/init et  packages ebuild)
et toux ceux dont je n'ai pas les noms mais qui ont grandement contribué au projet.

EagleConnect a ensuite été créé pour les besoins de mes proches qui n'avaient pas l'habitude de Linux, et pour lesquels un front-end graphique au driver et ses utilitaires s'imposait. 





II) Présentation

EagleConnect est une interface graphique, réalisée en langage tcl/tk, destinée à  permettre aux utilisateurs de base de se connecter simplement sous Linux avec leur modem Sagem Fast 800  ou assimilé. 
EagleConnect n'est évidemment qu'un front-end : à savoir que sans les outils développés par toute l'équipe de Eagle-usb, ce logiciel n'aurait pas grande utilité. Au travers de quelques boutons de base, l'utilisateur communique en réalité avec les modules fctStartAdsl, fctStopAdsl, eaglediag, eaglestat et eaglectrl qui permettent, respectivement, de se connecter à l'Internet, de s'en déconnecter, d'effectuer un diagnostic système,  d'afficher les statistiques réseau et le statut (opérationnel / non opérationnel)  du modem, ou encore de réinitialiser ce dernier.















Les nouveautés de la version 0.8 par rapport à la précédente version (0.2) :

- La détection de la présence d'une connexion n'est plus basée sur les seuls pings. Elle se fonde à présent sur 2 méthodes  :

1- Via les résultats fournis par l'utilitaire Eaglediag au démarrage de l'interface et lorsqu'on appuie sur le bouton « Lancer la connexion ADSL » Avantage : EagleConnect est plus rapide au démarrage, et la détection repose sur un diagnostic plus fiable.
2- Via la comparaison du nombre de paquets reçus (grâce à l'utilitaire Eaglestat) et la détection de leur incrémentation (chaque minute). Cette méthode est également utlisée par l'applet (voir plus bas).


- Une interface graphique à l'utilitaire EagleDiag. Deux modes sont acessibles : un mode normal (commande eaglediag classique sans paramètres), et un mode expert (commande eaglediag -a). Des fenêtres comportant des conseils pour l'utilisateur sont également présentes (incomplet en mode expert pour le moment).

- Une interface graphique à l'utilitaire Eaglestat, qui tient compte des modifications du réseau toutes les 5 secondes environ.

- Un panneau (sommaire) des préférences utilisateur. Ce dernier doit y entrer pour l'instant les commandes (fctStartAdsl, fctStopAdsl, eaglediag, eaglestat, eaglectrl) et leur chemin qui peut différer d'un environnement à l'autre (constaté sur le forum).

- Une « applet », sommaire également : ici, point de possibilité  de l'ancrer au panneau KDE ou GNOME. Déposée sur le bureau, elle indique seulement le nombre de paquets reçus et transmis, et le statut de la connexion (qui se base sur la seconde méthode de détection citée plus haut) .

- Enfin, l'interface existe à présent en français ... et en anglais. La langue change en fait selon l'environnement de l'utilisateur. Il est d'ailleurs possible d'ajouter d'autres langues, un fichier, « x.msg » ayant été créé  à cet effet en anglais afin de rendre le portage plus aisé. 


EagleConnect en est donc à sa seconde version (0.8) et tourne sous la Linux Mandrake 9.2. N'hésitez pas à le tester sous d'autres distributions pour m'indiquer s'il tourne correctement.























III) Paquetages ou logiciels requis

J'ai élaboré ce front-end sous la Mandrake 9.2. Néanmoins, je pense qu'il devrait fonctionner assez facilement avec les autres versions de la Linux Mandrake puisqu'il n'y a pas de compilation du programme à effectuer, et peu de dépendances à résoudre.
Pour pouvoir utiliser EagleConnect, vous devez avoir, sur votre machine : 
la bibliothèque TCL/TK (version 8.4.2-1.mdk) 
le Driver Eagle 1.9.6,  que vous trouverez aux adresses suivantes  :
http://baud123.free.fr/eagle/eagle-usb-1.9.6.tar.bz2
http://tbasic.free.fr/eagle/1.9.6/
mais EagleConnect fonctionne également avec les drivers Eagle 1.9.5 et 1.9.3.




IV) Installer le driver Eagle sur la Mandrake  9.2

La Mandrake 9.2  est fournie avec le driver eagle-usb 1.0.4 stable, mais des problèmes subsistent en cas de dégroupage. Pour cette raison, il est préférable de passer à la version du driver la plus récente.
Une fois le nouveau driver installé, il ne faut plus utiliser l'utilitaire graphique « Drakconnect » présent dans la distribution, sous peine de  voir l'ancien driver écraser le nouveau fraîchement installé.
Par ailleurs, vous trouverez une liste des changements effectués depuis la version 1.0.4 du driver sur cette page : http://eagle-usb.ath.cx/eagledev/wakka.php?wiki=DeveloppementIntegration , avec, notamment, la disparition du service adiusbadsl.
Enfin, si nécessaire, vous trouverez de l'aide sur le forum à l'adresse suivante : 
http://eagle-usb.ath.cx/forum/

Avant de procéder à l'installation, rendez-vous à l'adresse suivante :
http://eagle-usb.ath.cx/pub/article.php3?id_article=23
et relevez les paramètres de votre fournisseur d'accès internet. Ils vous seront utiles ultérieurement.

a)

Après avoir téléchargé le fichier eagle-usb-1.9.6.tar.bz2 sur votre disque dur (par exemple dans le répertoire /usr/local/src), vous passerez d'abord en mode root en tapant dans un terminal la commande su , puis vous décompacterez le fichier en tapant  la commande suivante : 
 tar jxvf eagle-usb-1.9.6.tar.bz2
Vous obtiendrez alors le répertoire eagle-usb-1.9.6.



b) 
Ensuite, entrez dans ce répertoire en tapant dans le même terminal :
cd eagle-usb-1.9.6
et installez enfin le driver eagle-usb en tapant :
./configure
make uninstall
make clean
make
make install
eagleconfig

Notez qu'à l'étape de la commande eagleconfig , un tableau apparaîtra et vous demandera votre méthode de connexion : vous devrez sélectionner  votre fournisseur d'accès dans la liste (voir la page http://eagle-usb.ath.cx/pub/article.php3?id_article=23) , en prenant en compte si vous êtes dégroupé ou non.
Votre identifiant de connexion à internet (par exemple  : toto@clubadsl1) et votre mot de passe vous seront ensuite demandés.
Une dernière option vous proposera par ailleurs, si vous le souhaitez, la connexion ADSL au démarrage.

c)
Enfin, vous pourrez finalement vous connecter en tapant la commande :
startadsl   
(stopadsl pour vous déconnecter)

Pour toute information complémentaire, je vous invite également à vous rendre à l'adresse suivante :
http://eagle-usb.ath.cx/pub/article.php3?id_article=33  


















































 
V) Installer EagleConnect

a)				
Suppression de l'ancienne version d'EagleEconnect

Avant d'installer EagleConnect v. 0.8,  pensez d'abord à supprimer  (via Konqueror, par exemple) les fichiers liés à l'ancienne version (v. 0.2) : EagleConnect.tcl, aide.gif et les fichiers de documentation (EagleConnectDocumentation.html, .sxw, .rtf, .pdf et .doc). Supprimez également le répertoire EagleConnect  (ou eagleconnect) s'il existe.

b)
Récupération et installation des fichiers d'EagleConnect

Pour pouvoir bénéficier de l'interface graphique EagleConnect, installez au préalable  les bibliothèques   tcl-8.4.2-1.mdk  et tk-8.4.2-1.mdk présentes dans la  distribution Mandrake 9.2 sous forme de fichiers rpm.
Pour savoir si ces bibliothèques sont déjà installées sur votre système Mandrake 9.2, tapez dans un terminal les commandes : 
rpm -qi tcl
rpm -qi tk

Si les paquetages ne sont pas installés,  tapez à cet effet dans un terminal (en tant que root) :
rpm -ivh  tcl-8.4.2-1mdk.i586.rpm
rpm -ivh  tk-8.4.2-1mdk.i586.rpm
Notez cependant qu'il est possible qu'EagleConnect fonctionne tout de même avec des versions de tcl / tk antérieures à la 8.4.2 (non testé).

c)
Récupérez ensuite EagleConnect à l'adresse suivante :
 http://www.membres.lycos.fr/eyves/connexion/ 
Vous le trouverez sous la forme d'un fichier archive à décompacter, eagleconnect.tgz. 
Téléchargez ce fichier et copiez le dans votre répertoire  utilisateur (exemple : /home/emmanuel).
En tant tant que simple utilisateur (et non en root), décompactez-le en tapant dans un terminal la commande suivante :
tar -xzvf eagleconnect.tgz
Vous avez à présent un répertoire « eagleconnect » dans votre répertoire utilisateur.  Ne lancez pas EagleConnect pour l'instant. Passez  pour l'instant à l'étape suivante ci-dessous.



















d)

IMPORTANT

EagleConnect doit être exclusivement lancé en tant que simple utilisateur ne possédant pas les droits root (dans le cas contraire, voir plus bas). A cet effet,  il faut modifier au préalable le fichier /etc/sudoers en ajoutant à la fin :
votreloginsimpleuser ALL=NOPASSWD:/usr/local/sbin/nom de la commande à lancer
ou 
votreloginsimpleuser ALL=NOPASSWD:/usr/sbin/nom de la commande à lancer 
selon l'emplacement des utilitaires installés sur votre machine (fctStartAdsl, fctStopAdsl, eaglediag, eaglestat, eaglectrl etc...). Pour connaître simplement cet emplacement, tapez simplement dans un terminal  :
whereis  fctStartAdsl
Exemple :
[emmanuel@localhost eagleconnect]$ whereis  fctStartAdsl
fctStartAdsl: /usr/local/sbin/fctStartAdsl

Passons à la modification du fichier /etc/sudoers proprement dit :

Exemple dans le cas où fctStartAdsl, fctStopAdsl (etc) sont installés dans /usr/local/sbin 

Pour pouvoir modifier le fichier /etc/sudoers, vous devrez l'ouvrir avec votre éditeur de textes préféré en tant que root.
Prenons l'exemple d'un utilisateur nommé emmanuel sur le système. Vous ajouterez alors  à la fin du fichier /etc/sudoers  :
emmanuel ALL=NOPASSWD:/usr/local/sbin/fctStartAdsl
emmanuel ALL=NOPASSWD:/usr/local/sbin/fctStopAdsl -sf
emmanuel ALL=NOPASSWD:/usr/local/sbin/eaglediag
emmanuel ALL=NOPASSWD:/usr/local/sbin/eaglectrl -w

Surtout, veillez à ne pas ajouter le signe  # avant chacune de ces lignes, ce signe servant uniquement à ouvrir des commentaires.
L'utilitaire Eaglestat , quant-à-lui, pouvant être lancé en tant que simple  utilisateur, il n'est pas nécessaire de l'ajouter à la liste.



Si vous désirez modifier le fichier /etc/sudoers avec l'éditeur de textes vi, procédez comme suit  :
Ouvrez un terminal, loggez vous en root, et tapez :
vi /etc/sudoers
Appuyez sur la touche Inser puis sur la touche Entrée pour pouvoir modifier le fichier et ajouter les lignes mentionnées ci-dessus.
Une fois ceci fait, appuyez successivement sur les  cinq touches  (ne tenez pas compte des virgules) :
Echap , : (deux points) , w, q, ! (point d'exclamation)
Voilà, votre fichier est sauvegardé.

Nota 

Pour les utilisateurs désirant cependant lancer EagleConnect en root, il faut alors supprimer l'appel à sudo dans les scripts EagleConnect.tcl, diagnostic.tcl, reseau.tcl et parameeagleconnect.tcl, et ne laisser que la commande exec suivie de la variable qui contient le nom de la commande et son emplacement. Ainsi, 
exec sudo  $recupdiag
devient alors : 
exec $recupdiag










VI) Utiliser EagleConnect

a)  

Premier lancement d'EagleConnect

Pour lancer le programme, placez vous  dans le répertoire eagleconnect nouvellement créé, tapez dans un terminal :
cd eagleconnect 
et tapez enfin dans un terminal la commande : 
EagleConnect.tcl

Lorsque vous lancez EagleConnect pour la première fois, le programme vous informe que vous devez au préalable entrer dans la fenêtre dédiée les paramètres de connexion. Il s'agit simplement des commandes et de leur emplacement.
Dans le premier champ, par exemple, si la commande fctStartAdsl se trouve dans le répertoire   /usr/local/sbin, alors vous inscrirez : 
/usr/local/sbin/fctStartAdsl
Si le path est différent, qu'il s'agit de /usr/sbin, alors vous inscrirez :
usr/sbin/fctStartAdsl
Vous ferez de même pour les autres programmes (eaglediag, eaglestat etc ...), sans ajouter évidemment les options propres à ces utilitaires (comme : eaglediag -a, n'ajoutez surtout pas le -a, inscrivez simplement eaglediag).

Une fois ceci fait, sauvegardez vos préférences. Le fichier des préférences utilisateur sera alors créé dans le répertoire eagleconnect sous le nom d' « eagleconnect.pref ». A tout moment, vous pourrez le modifier si nécessaire via l'interface EagleConnect en allant dans le menu « Aide » >> « Configurer EagleConnect »  (qui appelle en fait le programme parameeagleconnect.tcl).

































b)

Découverte d'EagleConnect

Le programme n'est pas très complexe, il est composé d'un champ, de six boutons principaux et d'une petite icône située en haut à droite du menu « Aide » : 

1) Le champ situé au-dessus des boutons indique si la connexion est active ou non. Lorsque vous lancez EagleConnect, ce dernier vérifie d'emblée si vous êtes connecté en effectuant la commande Eaglediag dont le résultat est redirigé vers un fichier externe. Si tous les paramètres (module loaded, modem operational, pppd launched, service for connection, ping ip et test DND) sont à OK, alors vous êtes dans  conditions optimales pour surfer :-)  Dans le cas contraire, le programme vous informe que la connexion est inactive. Si tel est le cas,  cliquez alors sur le bouton « Diagnostic du système » de l'interface pour connaître la nature du problème auquel vous êtes confronté.
Par ailleurs, une fonction de détection d'incrémention des paquets reçus (basée sur Eaglestat) met à jour chaque minute l'état du champ. Si le nombre de  paquets reçus augmente effectivement, alors la connexion est active.

2) Le bouton "Etat du réseau", est basé sur l'utilitaire Eaglestat. Il permet de connaître l'état du réseau et le statut du modem : opérationnel ou non. Ce bouton lance l'interface « reseau.tcl » qui récupère les valeurs transmises par Eaglestat toutes les cinq secondes environ.

3) Le bouton « Diagnostic du système » est basé sur l'utilitaire Eaglediag. Il lance l'interface « diagnostic.tcl » qui comporte deux modes :
mode normal : l'utilitaire Eaglediag est lancé sans option de ligne de commande. C'est la commande par défaut. Elle vous permet néanmoins de dresser un état des lieux sur les paramètres de votre connexion. La fenêtre « Conseils » vous donne également quelques astuces si l'un de ces paramètres ne semble pas fonctionner correctement.
mode expert :  l'utilitaire Eaglediag est lancé avec l'option de ligne de commande -a, où tout est affiché.  Notez que la rubrique « Conseils » est  pour l'instant incomplète.

4)  « Réinitialiser le modem », permet de débloquer le modem  (cette option appelle la commande "eaglectrl -w") après avoir stoppé une connexion adsl éventuelle ("fctStopAdsl -sf", ces deux options permettant d'utiliser ifconfig et de fermer pppd). Une fois la réinitialisation effectuée, vous êtes ensuite invité  à lancer la connexion.

5)  « Lancer la connexion ADSL » et 6) « Arrêter la connection ADSL »  



7)  La petite icône située en haut à droite du menu « Aide »  vous permet de minimiser EagleConnect et de le faire apparaître sous forme d'applet. Cette dernière comporte deux champs : paquets reçus et envoyés qui sont actualisés chaque minute. Au lancement de l'applet, ces valeurs n'apparaissent pas instantanément. Il faut attendre une minute afin qu'elles ne s'inscrivent dans les deux champs.   
Ce petit bug sera corrigé prochainement.
Pour déplacer l'applet sur le bureau, laissez le bouton droit de la souris appuyé dessus. Pour la fermer et rouvrir l'interface EagleConnect, double-cliquez dessus avec le bouton gauche.








c)

Modifier la langue de l'interface

Grâce au fichier x.msg que vous trouverez dans le répertoire eagleconnect, vous pouvez aisément traduire EagleConnect dans la langue de votre choix. Chacun des scripts tcl, en effet, comporte un appel au catalogue de langue (*.msg) correspondant à la langue  du système de l'utilisateur (définie dans $env(LANG)).  EagleConnect étant à la base en anglais, l'interface va donc chercher le fichier fr.msg si   LANG = fr_FR.  
Extrait du fichier fr.msg :
::msgcat::mcset fr "Help" "Aide" 
::msgcat::mcset fr "EagleConnect Manual" "Manuel de EagleConnect" 
::msgcat::mcset fr "About EagleConnect" "A propos de EagleConnect" 
etc...
Le fichier x.msg comportant tous les termes de l'interface en anglais, il ne reste qu'à inclure dans ce fichier la traduction de chacune des phrases dans la langue de son choix, en prenant soin de supprimer fr et de mettre, par exemple, es à la place pour la langue espagnole. On renommera alors le fichier x.msg en es.msg.












































VII)  Evolutions attendues

EagleConnect est un logiciel que j'ai l'intention de faire évoluer - dans les mesure de mes possibilités et de ma disponibilité - parallèlement au fabuleux travail effectué par l'équipe de Eagle-usb.

Dans la prochaine version :

Visualisation des logs dans une fenêtre lors des différents processus
Possibilité d'utiliser EagleConnect en mode root si l'utilisateur le désire
Apparition de barres de progression pour signaler la présence de processus en cours (démarrage de connexion etc).
Améliorations diverses sur le plan de l'esthétique.
Plus ... selon les requêtes des utilisateurs :-)


VIII)  Remerciements

Je tiens d'abord à remercier Benoît Audouard (Baud123, concepteur du module "Eaglediag") qui m'a guidé dans l'élaboration de cette interface en me donnant d'inestimables conseils, tant par email qu'au travers des pages wiki consacrées au développement du driver eagle-usb et des outils affiliés :
http://eagle-usb.ath.cx/eagledev/wakka.php?wiki=PagePrincipale 

Je tiens également à remercier les utilisateurs qui m'ont adressé leurs encouragements et appréciations  par email, ainsi que le personnes rencontrées sur le forum du site http://eagle-usb.ath.cx/pub/ , grâce auxquelles j'ai pu apporter certaines améliorations à EagleConnect.





































IX)  LICENCE

Copyright (C) 2004 version 0.8  Emmanuel YVES

Ce programme est libre, vous pouvez le redistribuer et/ou le modifier selon les termes de la Licence Publique Générale GNU publiée par la Free Software Foundation (version 2 ou bien toute autre version ultérieure choisie par vous).

EagleConnect est distribué car potentiellement utile, mais SANS AUCUNE GARANTIE, ni explicite ni implicite, y compris les garanties de commercialisation ou d'adaptation dans un but spécifique. Reportez-vous à la Licence Publique Générale GNU pour plus de détails.

Vous devez avoir reçu une copie de la Licence Publique Générale GNU en même temps que ce programme ; si ce n'est pas le cas, écrivez à la Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307, États-Unis.


X)  DISCLAIMER

Ce programme en est à sa seconde version. Des bugs étant toujours possibles, vous utilisez donc ce programme en connaissance de cause. Je dégage pour ma part toute responsabilité quant aux dommages éventuels qui pourraient survenir lors de l'utilisation de ce programme.


Merci de bien vouloir me retourner vos remarques et suggestions à l'adresse email suivante :
eyves@club-internet.fr



								
								Paris, le 11 Avril 2004

