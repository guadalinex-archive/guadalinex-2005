GAS LISTING  			page 1


   1              	.file "ieee80211_crypt_tkip.c"
   9              	.Ltext0:
  10              	.section .modinfo,"a",@progbits
  13              	__mod_author29:
  14 0000 61757468 	.string "author=Jouni Malinen"
  14      6F723D4A 
  14      6F756E69 
  14      204D616C 
  14      696E656E 
  15 0015 00000000 	.align 32
  15      00000000 
  15      000000
  18              	__mod_description30:
  19 0020 64657363 	.string "description=Host AP crypt: TKIP"
  19      72697074 
  19      696F6E3D 
  19      486F7374 
  19      20415020 
  22              	__mod_license31:
  23 0040 6C696365 	.string "license=GPL"
  23      6E73653D 
  23      47504C00 
  24              	.text
  26              	ieee80211_tkip_set_flags:
  27              	.LFB687:
  28              	.file 1 "/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c"
   1:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** /*
   2:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c ****  * Host AP crypt: host-based TKIP encryption implementation for Host AP driver
   3:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c ****  *
   4:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c ****  * Copyright (c) 2003-2004, Jouni Malinen <jkmaline@cc.hut.fi>
   5:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c ****  *
   6:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c ****  * This program is free software; you can redistribute it and/or modify
   7:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c ****  * it under the terms of the GNU General Public License version 2 as
   8:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c ****  * published by the Free Software Foundation. See README and COPYING for
   9:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c ****  * more details.
  10:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c ****  */
  11:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  12:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <linux/config.h>
  13:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <linux/module.h>
  14:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <linux/init.h>
  15:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <linux/slab.h>
  16:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <linux/random.h>
  17:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <linux/skbuff.h>
  18:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <linux/netdevice.h>
  19:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <linux/if_ether.h>
  20:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <linux/if_arp.h>
  21:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <asm/string.h>
  22:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  23:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <net/ieee80211.h>
  24:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  25:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <linux/crypto.h>
  26:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <asm/scatterlist.h>
  27:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #include <linux/crc32.h>
  28:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  29:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** MODULE_AUTHOR("Jouni Malinen");
  30:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** MODULE_DESCRIPTION("Host AP crypt: TKIP");
  31:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** MODULE_LICENSE("GPL");
GAS LISTING  			page 2


  32:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  33:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** struct ieee80211_tkip_data {
  34:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #define TKIP_KEY_LEN 32
  35:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u8 key[TKIP_KEY_LEN];
  36:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	int key_set;
  37:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  38:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u32 tx_iv32;
  39:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u16 tx_iv16;
  40:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u16 tx_ttak[5];
  41:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	int tx_phase1_done;
  42:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  43:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u32 rx_iv32;
  44:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u16 rx_iv16;
  45:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u16 rx_ttak[5];
  46:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	int rx_phase1_done;
  47:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u32 rx_iv32_new;
  48:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u16 rx_iv16_new;
  49:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  50:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u32 dot11RSNAStatsTKIPReplays;
  51:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u32 dot11RSNAStatsTKIPICVErrors;
  52:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u32 dot11RSNAStatsTKIPLocalMICFailures;
  53:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  54:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	int key_idx;
  55:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  56:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct crypto_tfm *tfm_arc4;
  57:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct crypto_tfm *tfm_michael;
  58:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  59:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	/* scratch buffers for virt_to_page() (crypto API) */
  60:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u8 rx_hdr[16], tx_hdr[16];
  61:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  62:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	unsigned long flags;
  63:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** };
  64:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  65:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static unsigned long ieee80211_tkip_set_flags(unsigned long flags, void *priv)
  66:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
  29              	.loc 1 66 0
  30              	.loc 1 66 0
  31 0000 8B542408 	movl 8(%esp),%edx
  67:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_tkip_data *_priv = priv;
  68:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	unsigned long old_flags = _priv->flags;
  32              	.loc 1 68 0
  33 0004 8B828C00 	movl 140(%edx),%eax
  33      0000
  69:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	_priv->flags = flags;
  34              	.loc 1 69 0
  35 000a 8B4C2404 	movl 4(%esp),%ecx
  36 000e 898A8C00 	movl %ecx,140(%edx)
  36      0000
  70:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return old_flags;
  71:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
  37              	.loc 1 71 0
  38 0014 C3       	ret
  39              	.LFE687:
  42              	ieee80211_tkip_get_flags:
  43              	.LFB688:
  72:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  73:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static unsigned long ieee80211_tkip_get_flags(void *priv)
GAS LISTING  			page 3


  74:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
  44              	.loc 1 74 0
  75:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_tkip_data *_priv = priv;
  76:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return _priv->flags;
  45              	.loc 1 76 0
  46 0015 8B442404 	movl 4(%esp),%eax
  47 0019 8B808C00 	movl 140(%eax),%eax
  47      0000
  77:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
  48              	.loc 1 77 0
  49 001f C3       	ret
  50              	.LFE688:
  52              	.section .rodata.str1.1,"aMS",@progbits,1
  53              	.LC0:
  54 0000 61726334 	.string "arc4"
  54      00
  55              	.LC1:
  56 0005 3C373E69 	.string "<7>ieee80211_crypt_tkip: could not allocate crypto API arc4\n"
  56      65656538 
  56      30323131 
  56      5F637279 
  56      70745F74 
  57              	.LC2:
  58 0042 6D696368 	.string "michael_mic"
  58      61656C5F 
  58      6D696300 
  59              	.LC3:
  60 004e 3C373E69 	.string "<7>ieee80211_crypt_tkip: could not allocate crypto API michael_mic\n"
  60      65656538 
  60      30323131 
  60      5F637279 
  60      70745F74 
  61              	.text
  63              	ieee80211_tkip_init:
  64              	.LFB689:
  78:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  79:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static void *ieee80211_tkip_init(int key_idx)
  80:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
  65              	.loc 1 80 0
  66              	.L6:
  67 0020 57       	pushl %edi
  68              	.LCFI0:
  69 0021 56       	pushl %esi
  70              	.LCFI1:
  71 0022 53       	pushl %ebx
  72              	.LCFI2:
  73              	.loc 1 80 0
  74 0023 53       	pushl %ebx
  75              	.LCFI3:
  76              	.LBB2:
  77              	.LBB3:
  78              	.LBB4:
  79              	.LBB5:
  80              	.LBB6:
  81              	.file 2 "include/linux/slab.h"
   1:include/linux/slab.h **** /*
   2:include/linux/slab.h ****  * linux/mm/slab.h
GAS LISTING  			page 4


   3:include/linux/slab.h ****  * Written by Mark Hemment, 1996.
   4:include/linux/slab.h ****  * (markhe@nextd.demon.co.uk)
   5:include/linux/slab.h ****  */
   6:include/linux/slab.h **** 
   7:include/linux/slab.h **** #ifndef _LINUX_SLAB_H
   8:include/linux/slab.h **** #define	_LINUX_SLAB_H
   9:include/linux/slab.h **** 
  10:include/linux/slab.h **** #if	defined(__KERNEL__)
  11:include/linux/slab.h **** 
  12:include/linux/slab.h **** typedef struct kmem_cache_s kmem_cache_t;
  13:include/linux/slab.h **** 
  14:include/linux/slab.h **** #include	<linux/config.h>	/* kmalloc_sizes.h needs CONFIG_ options */
  15:include/linux/slab.h **** #include	<linux/gfp.h>
  16:include/linux/slab.h **** #include	<linux/init.h>
  17:include/linux/slab.h **** #include	<linux/types.h>
  18:include/linux/slab.h **** #include	<asm/page.h>		/* kmalloc_sizes.h needs PAGE_SIZE */
  19:include/linux/slab.h **** #include	<asm/cache.h>		/* kmalloc_sizes.h needs L1_CACHE_BYTES */
  20:include/linux/slab.h **** 
  21:include/linux/slab.h **** /* flags for kmem_cache_alloc() */
  22:include/linux/slab.h **** #define	SLAB_NOFS		GFP_NOFS
  23:include/linux/slab.h **** #define	SLAB_NOIO		GFP_NOIO
  24:include/linux/slab.h **** #define	SLAB_ATOMIC		GFP_ATOMIC
  25:include/linux/slab.h **** #define	SLAB_USER		GFP_USER
  26:include/linux/slab.h **** #define	SLAB_KERNEL		GFP_KERNEL
  27:include/linux/slab.h **** #define	SLAB_DMA		GFP_DMA
  28:include/linux/slab.h **** 
  29:include/linux/slab.h **** #define SLAB_LEVEL_MASK		GFP_LEVEL_MASK
  30:include/linux/slab.h **** 
  31:include/linux/slab.h **** #define	SLAB_NO_GROW		__GFP_NO_GROW	/* don't grow a cache */
  32:include/linux/slab.h **** 
  33:include/linux/slab.h **** /* flags to pass to kmem_cache_create().
  34:include/linux/slab.h ****  * The first 3 are only valid when the allocator as been build
  35:include/linux/slab.h ****  * SLAB_DEBUG_SUPPORT.
  36:include/linux/slab.h ****  */
  37:include/linux/slab.h **** #define	SLAB_DEBUG_FREE		0x00000100UL	/* Peform (expensive) checks on free */
  38:include/linux/slab.h **** #define	SLAB_DEBUG_INITIAL	0x00000200UL	/* Call constructor (as verifier) */
  39:include/linux/slab.h **** #define	SLAB_RED_ZONE		0x00000400UL	/* Red zone objs in a cache */
  40:include/linux/slab.h **** #define	SLAB_POISON		0x00000800UL	/* Poison objects */
  41:include/linux/slab.h **** #define	SLAB_NO_REAP		0x00001000UL	/* never reap from the cache */
  42:include/linux/slab.h **** #define	SLAB_HWCACHE_ALIGN	0x00002000UL	/* align objs on a h/w cache lines */
  43:include/linux/slab.h **** #define SLAB_CACHE_DMA		0x00004000UL	/* use GFP_DMA memory */
  44:include/linux/slab.h **** #define SLAB_MUST_HWCACHE_ALIGN	0x00008000UL	/* force alignment */
  45:include/linux/slab.h **** #define SLAB_STORE_USER		0x00010000UL	/* store the last owner for bug hunting */
  46:include/linux/slab.h **** #define SLAB_RECLAIM_ACCOUNT	0x00020000UL	/* track pages allocated to indicate
  47:include/linux/slab.h **** 						   what is reclaimable later*/
  48:include/linux/slab.h **** #define SLAB_PANIC		0x00040000UL	/* panic if kmem_cache_create() fails */
  49:include/linux/slab.h **** #define SLAB_DESTROY_BY_RCU	0x00080000UL	/* defer freeing pages to RCU */
  50:include/linux/slab.h **** 
  51:include/linux/slab.h **** /* flags passed to a constructor func */
  52:include/linux/slab.h **** #define	SLAB_CTOR_CONSTRUCTOR	0x001UL		/* if not set, then deconstructor */
  53:include/linux/slab.h **** #define SLAB_CTOR_ATOMIC	0x002UL		/* tell constructor it can't sleep */
  54:include/linux/slab.h **** #define	SLAB_CTOR_VERIFY	0x004UL		/* tell constructor it's a verify call */
  55:include/linux/slab.h **** 
  56:include/linux/slab.h **** /* prototypes */
  57:include/linux/slab.h **** extern void __init kmem_cache_init(void);
  58:include/linux/slab.h **** 
  59:include/linux/slab.h **** extern kmem_cache_t *kmem_cache_create(const char *, size_t, size_t, unsigned long,
GAS LISTING  			page 5


  60:include/linux/slab.h **** 				       void (*)(void *, kmem_cache_t *, unsigned long),
  61:include/linux/slab.h **** 				       void (*)(void *, kmem_cache_t *, unsigned long));
  62:include/linux/slab.h **** extern int kmem_cache_destroy(kmem_cache_t *);
  63:include/linux/slab.h **** extern int kmem_cache_shrink(kmem_cache_t *);
  64:include/linux/slab.h **** extern void *kmem_cache_alloc(kmem_cache_t *, unsigned int __nocast);
  65:include/linux/slab.h **** extern void kmem_cache_free(kmem_cache_t *, void *);
  66:include/linux/slab.h **** extern unsigned int kmem_cache_size(kmem_cache_t *);
  67:include/linux/slab.h **** extern kmem_cache_t *kmem_find_general_cachep(size_t size, int gfpflags);
  68:include/linux/slab.h **** 
  69:include/linux/slab.h **** /* Size description struct for general caches. */
  70:include/linux/slab.h **** struct cache_sizes {
  71:include/linux/slab.h **** 	size_t		 cs_size;
  72:include/linux/slab.h **** 	kmem_cache_t	*cs_cachep;
  73:include/linux/slab.h **** 	kmem_cache_t	*cs_dmacachep;
  74:include/linux/slab.h **** };
  75:include/linux/slab.h **** extern struct cache_sizes malloc_sizes[];
  76:include/linux/slab.h **** extern void *__kmalloc(size_t, unsigned int __nocast);
  77:include/linux/slab.h **** 
  78:include/linux/slab.h **** static inline void *kmalloc(size_t size, unsigned int __nocast flags)
  79:include/linux/slab.h **** {
  80:include/linux/slab.h **** 	if (__builtin_constant_p(size)) {
  81:include/linux/slab.h **** 		int i = 0;
  82:include/linux/slab.h **** #define CACHE(x) \
  83:include/linux/slab.h **** 		if (size <= x) \
  84:include/linux/slab.h **** 			goto found; \
  85:include/linux/slab.h **** 		else \
  86:include/linux/slab.h **** 			i++;
  87:include/linux/slab.h **** #include "kmalloc_sizes.h"
  88:include/linux/slab.h **** #undef CACHE
  89:include/linux/slab.h **** 		{
  90:include/linux/slab.h **** 			extern void __you_cannot_kmalloc_that_much(void);
  91:include/linux/slab.h **** 			__you_cannot_kmalloc_that_much();
  92:include/linux/slab.h **** 		}
  93:include/linux/slab.h **** found:
  82              	.loc 2 93 0
  83 0024 6A20     	pushl $32
  84              	.LCFI4:
  85 0026 FF352800 	pushl malloc_sizes+40
  85      0000
  86              	.LCFI5:
  87              	.LCFI6:
  88 002c E8FCFFFF 	call kmem_cache_alloc
  88      FF
  89 0031 31F6     	xorl %esi,%esi
  90 0033 5A       	popl %edx
  91              	.LCFI7:
  92              	.LBE6:
  93              	.LBE5:
  94              	.LBE4:
  95              	.file 3 "/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h"
   1:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /*
   2:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * Merged with mainline ieee80211.h in Aug 2004.  Original ieee802_11
   3:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * remains copyright by the original authors
   4:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
   5:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * Portions of the merged code are based on Host AP (software wireless
   6:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * LAN access point) driver for Intersil Prism2/2.5/3.
   7:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
GAS LISTING  			page 6


   8:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * Copyright (c) 2001-2002, SSH Communications Security Corp and Jouni Malinen
   9:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * <jkmaline@cc.hut.fi>
  10:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * Copyright (c) 2002-2003, Jouni Malinen <jkmaline@cc.hut.fi>
  11:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
  12:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * Adaption to a generic IEEE 802.11 stack by James Ketrenos
  13:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * <jketreno@linux.intel.com>
  14:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * Copyright (c) 2004-2005, Intel Corporation
  15:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
  16:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * This program is free software; you can redistribute it and/or modify
  17:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * it under the terms of the GNU General Public License version 2 as
  18:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * published by the Free Software Foundation. See README and COPYING for
  19:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * more details.
  20:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
  21:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * API Version History
  22:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * 1.0.x -- Initial version
  23:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * 1.1.x -- Added radiotap, QoS, TIM, ieee80211_geo APIs,
  24:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *          various structure changes, and crypto API init method
  25:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  */
  26:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #ifndef IEEE80211_H
  27:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_H
  28:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #include <linux/if_ether.h>	/* ETH_ALEN */
  29:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #include <linux/kernel.h>	/* ARRAY_SIZE */
  30:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #include <linux/wireless.h>
  31:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
  32:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_VERSION "1.1.12"
  33:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
  34:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DATA_LEN		2304
  35:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* Maximum size for the MA-UNITDATA primitive, 802.11 standard section
  36:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****    6.2.1.1.2.
  37:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
  38:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****    The figure in section 7.1.2 suggests a body size of up to 2312
  39:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****    bytes is allowed, which is a bit confusing, I suspect this
  40:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****    represents the 2304 bytes of real data, plus a possible 8 bytes of
  41:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****    WEP IV and ICV. (this interpretation suggested by Ramiro Barreiro) */
  42:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
  43:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_1ADDR_LEN 10
  44:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_2ADDR_LEN 16
  45:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_3ADDR_LEN 24
  46:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_4ADDR_LEN 30
  47:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FCS_LEN    4
  48:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_HLEN			(IEEE80211_4ADDR_LEN)
  49:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FRAME_LEN		(IEEE80211_DATA_LEN + IEEE80211_HLEN)
  50:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
  51:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define MIN_FRAG_THRESHOLD     256U
  52:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define	MAX_FRAG_THRESHOLD     2346U
  53:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
  54:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* Frame control field constants */
  55:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FCTL_VERS		0x0003
  56:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FCTL_FTYPE		0x000c
  57:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FCTL_STYPE		0x00f0
  58:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FCTL_TODS		0x0100
  59:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FCTL_FROMDS		0x0200
  60:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FCTL_MOREFRAGS	0x0400
  61:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FCTL_RETRY		0x0800
  62:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FCTL_PM		0x1000
  63:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FCTL_MOREDATA		0x2000
  64:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FCTL_PROTECTED	0x4000
GAS LISTING  			page 7


  65:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FCTL_ORDER		0x8000
  66:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
  67:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FTYPE_MGMT		0x0000
  68:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FTYPE_CTL		0x0004
  69:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FTYPE_DATA		0x0008
  70:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
  71:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* management */
  72:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_ASSOC_REQ	0x0000
  73:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_ASSOC_RESP 	0x0010
  74:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_REASSOC_REQ	0x0020
  75:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_REASSOC_RESP	0x0030
  76:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_PROBE_REQ	0x0040
  77:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_PROBE_RESP	0x0050
  78:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_BEACON		0x0080
  79:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_ATIM		0x0090
  80:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_DISASSOC	0x00A0
  81:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_AUTH		0x00B0
  82:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_DEAUTH		0x00C0
  83:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_ACTION		0x00D0
  84:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
  85:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* control */
  86:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_PSPOLL		0x00A0
  87:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_RTS		0x00B0
  88:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_CTS		0x00C0
  89:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_ACK		0x00D0
  90:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_CFEND		0x00E0
  91:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_CFENDACK	0x00F0
  92:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
  93:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* data */
  94:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_DATA		0x0000
  95:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_DATA_CFACK	0x0010
  96:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_DATA_CFPOLL	0x0020
  97:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_DATA_CFACKPOLL	0x0030
  98:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_NULLFUNC	0x0040
  99:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_CFACK		0x0050
 100:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_CFPOLL		0x0060
 101:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_CFACKPOLL	0x0070
 102:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STYPE_QOS_DATA        0x0080
 103:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 104:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_SCTL_FRAG		0x000F
 105:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_SCTL_SEQ		0xFFF0
 106:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 107:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* debug macros */
 108:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 109:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #ifdef CONFIG_IEEE80211_DEBUG
 110:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** extern u32 ieee80211_debug_level;
 111:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEBUG(level, fmt, args...) \
 112:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** do { if (ieee80211_debug_level & (level)) \
 113:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****   printk(KERN_DEBUG "ieee80211: %c %s " fmt, \
 114:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****          in_interrupt() ? 'I' : 'U', __FUNCTION__ , ## args); } while (0)
 115:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #else
 116:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEBUG(level, fmt, args...) do {} while (0)
 117:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #endif				/* CONFIG_IEEE80211_DEBUG */
 118:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 119:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* debug macros not dependent on CONFIG_IEEE80211_DEBUG */
 120:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 121:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define MAC_FMT "%02x:%02x:%02x:%02x:%02x:%02x"
GAS LISTING  			page 8


 122:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define MAC_ARG(x) ((u8*)(x))[0],((u8*)(x))[1],((u8*)(x))[2],((u8*)(x))[3],((u8*)(x))[4],((u8*)(x))
 123:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 124:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* compatibility macros */
 125:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #if WIRELESS_EXT < 17
 126:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IW_QUAL_QUAL_UPDATED    0x01    /* Value was updated since last read */
 127:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IW_QUAL_LEVEL_UPDATED   0x02
 128:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IW_QUAL_NOISE_UPDATED   0x04
 129:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IW_QUAL_ALL_UPDATED     0x07
 130:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IW_QUAL_QUAL_INVALID    0x10    /* Driver doesn't provide value */
 131:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IW_QUAL_LEVEL_INVALID   0x20
 132:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IW_QUAL_NOISE_INVALID   0x40
 133:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IW_QUAL_ALL_INVALID     0x70
 134:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #endif
 135:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 136:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #if WIRELESS_EXT < 19
 137:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IW_QUAL_DBM             0x08    /* Level + Noise are dBm */
 138:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #endif
 139:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 140:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #ifndef __bitwise /* if __leXX is not defined */
 141:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** typedef __u16 __le16;
 142:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** typedef __u64 __le64;
 143:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #endif
 144:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 145:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #ifndef DEFINE_SPINLOCK
 146:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define DEFINE_SPINLOCK(s)              spinlock_t s = SPIN_LOCK_UNLOCKED
 147:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #endif
 148:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 149:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* escape_essid() is intended to be used in debug (and possibly error)
 150:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * messages. It should never be used for passing essid to user space. */
 151:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** const char *escape_essid(const char *essid, u8 essid_len);
 152:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 153:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /*
 154:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * To use the debug system:
 155:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
 156:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * If you are defining a new debug classification, simply add it to the #define
 157:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * list here in the form of:
 158:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
 159:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * #define IEEE80211_DL_xxxx VALUE
 160:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
 161:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * shifting value to the left one bit from the previous entry.  xxxx should be
 162:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * the name of the classification (for example, WEP)
 163:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
 164:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * You then need to either add a IEEE80211_xxxx_DEBUG() macro definition for your
 165:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * classification, or use IEEE80211_DEBUG(IEEE80211_DL_xxxx, ...) whenever you want
 166:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * to send output to that classification.
 167:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
 168:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * To add your debug level to the list of levels seen when you perform
 169:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
 170:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * % cat /proc/net/ieee80211/debug_level
 171:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
 172:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * you simply need to add your entry to the ieee80211_debug_level array.
 173:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
 174:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * If you do not see debug_level in /proc/net/ieee80211 then you do not have
 175:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * CONFIG_IEEE80211_DEBUG defined in your kernel configuration
 176:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
 177:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  */
 178:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
GAS LISTING  			page 9


 179:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DL_INFO          (1<<0)
 180:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DL_WX            (1<<1)
 181:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DL_SCAN          (1<<2)
 182:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DL_STATE         (1<<3)
 183:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DL_MGMT          (1<<4)
 184:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DL_FRAG          (1<<5)
 185:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DL_DROP          (1<<7)
 186:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 187:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DL_TX            (1<<8)
 188:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DL_RX            (1<<9)
 189:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DL_QOS           (1<<31)
 190:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 191:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_ERROR(f, a...) printk(KERN_ERR "ieee80211: " f, ## a)
 192:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_WARNING(f, a...) printk(KERN_WARNING "ieee80211: " f, ## a)
 193:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEBUG_INFO(f, a...)   IEEE80211_DEBUG(IEEE80211_DL_INFO, f, ## a)
 194:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 195:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEBUG_WX(f, a...)     IEEE80211_DEBUG(IEEE80211_DL_WX, f, ## a)
 196:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEBUG_SCAN(f, a...)   IEEE80211_DEBUG(IEEE80211_DL_SCAN, f, ## a)
 197:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEBUG_STATE(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_STATE, f, ## a)
 198:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEBUG_MGMT(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_MGMT, f, ## a)
 199:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEBUG_FRAG(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_FRAG, f, ## a)
 200:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEBUG_DROP(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_DROP, f, ## a)
 201:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEBUG_TX(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_TX, f, ## a)
 202:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEBUG_RX(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_RX, f, ## a)
 203:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEBUG_QOS(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_QOS, f, ## a)
 204:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #include <linux/netdevice.h>
 205:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #include <linux/wireless.h>
 206:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #include <linux/if_arp.h>	/* ARPHRD_ETHER */
 207:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 208:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #ifndef WIRELESS_SPY
 209:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WIRELESS_SPY		/* enable iwspy support */
 210:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #endif
 211:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #include <net/iw_handler.h>	/* new driver API */
 212:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 213:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #ifndef ETH_P_PAE
 214:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define ETH_P_PAE 0x888E	/* Port Access Entity (IEEE 802.1X) */
 215:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #endif				/* ETH_P_PAE */
 216:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 217:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define ETH_P_PREAUTH 0x88C7	/* IEEE 802.11i pre-authentication */
 218:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 219:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #ifndef ETH_P_80211_RAW
 220:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define ETH_P_80211_RAW (ETH_P_ECONET + 1)
 221:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #endif
 222:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 223:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* IEEE 802.11 defines */
 224:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 225:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define P80211_OUI_LEN 3
 226:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 227:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_snap_hdr {
 228:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 229:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 dsap;		/* always 0xAA */
 230:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 ssap;		/* always 0xAA */
 231:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 ctrl;		/* always 0x03 */
 232:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 oui[P80211_OUI_LEN];	/* organizational universal id */
 233:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 234:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 235:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
GAS LISTING  			page 10


 236:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SNAP_SIZE sizeof(struct ieee80211_snap_hdr)
 237:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 238:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_FC_GET_VERS(fc) ((fc) & IEEE80211_FCTL_VERS)
 239:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_FC_GET_TYPE(fc) ((fc) & IEEE80211_FCTL_FTYPE)
 240:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_FC_GET_STYPE(fc) ((fc) & IEEE80211_FCTL_STYPE)
 241:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 242:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_GET_SEQ_FRAG(seq) ((seq) & IEEE80211_SCTL_FRAG)
 243:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_GET_SEQ_SEQ(seq)  ((seq) & IEEE80211_SCTL_SEQ)
 244:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 245:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* Authentication algorithms */
 246:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_AUTH_OPEN 0
 247:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_AUTH_SHARED_KEY 1
 248:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_AUTH_LEAP 2
 249:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 250:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_AUTH_CHALLENGE_LEN 128
 251:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 252:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_CAPABILITY_ESS (1<<0)
 253:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_CAPABILITY_IBSS (1<<1)
 254:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_CAPABILITY_CF_POLLABLE (1<<2)
 255:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_CAPABILITY_CF_POLL_REQUEST (1<<3)
 256:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_CAPABILITY_PRIVACY (1<<4)
 257:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_CAPABILITY_SHORT_PREAMBLE (1<<5)
 258:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_CAPABILITY_PBCC (1<<6)
 259:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_CAPABILITY_CHANNEL_AGILITY (1<<7)
 260:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_CAPABILITY_SPECTRUM_MGMT (1<<8)
 261:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_CAPABILITY_QOS (1<<9)
 262:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_CAPABILITY_SHORT_SLOT_TIME (1<<10)
 263:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WLAN_CAPABILITY_DSSS_OFDM (1<<13)
 264:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 265:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* Status codes */
 266:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** enum ieee80211_statuscode {
 267:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_SUCCESS = 0,
 268:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_UNSPECIFIED_FAILURE = 1,
 269:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_CAPS_UNSUPPORTED = 10,
 270:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_REASSOC_NO_ASSOC = 11,
 271:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_ASSOC_DENIED_UNSPEC = 12,
 272:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_NOT_SUPPORTED_AUTH_ALG = 13,
 273:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_UNKNOWN_AUTH_TRANSACTION = 14,
 274:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_CHALLENGE_FAIL = 15,
 275:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_AUTH_TIMEOUT = 16,
 276:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_AP_UNABLE_TO_HANDLE_NEW_STA = 17,
 277:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_ASSOC_DENIED_RATES = 18,
 278:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* 802.11b */
 279:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_ASSOC_DENIED_NOSHORTPREAMBLE = 19,
 280:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_ASSOC_DENIED_NOPBCC = 20,
 281:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_ASSOC_DENIED_NOAGILITY = 21,
 282:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* 802.11h */
 283:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_ASSOC_DENIED_NOSPECTRUM = 22,
 284:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_ASSOC_REJECTED_BAD_POWER = 23,
 285:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_ASSOC_REJECTED_BAD_SUPP_CHAN = 24,
 286:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* 802.11g */
 287:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_ASSOC_DENIED_NOSHORTTIME = 25,
 288:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_ASSOC_DENIED_NODSSSOFDM = 26,
 289:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* 802.11i */
 290:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_INVALID_IE = 40,
 291:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_INVALID_GROUP_CIPHER = 41,
 292:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_INVALID_PAIRWISE_CIPHER = 42,
GAS LISTING  			page 11


 293:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_INVALID_AKMP = 43,
 294:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_UNSUPP_RSN_VERSION = 44,
 295:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_INVALID_RSN_IE_CAP = 45,
 296:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_STATUS_CIPHER_SUITE_REJECTED = 46,
 297:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 298:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 299:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* Reason codes */
 300:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** enum ieee80211_reasoncode {
 301:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_UNSPECIFIED = 1,
 302:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_PREV_AUTH_NOT_VALID = 2,
 303:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_DEAUTH_LEAVING = 3,
 304:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_DISASSOC_DUE_TO_INACTIVITY = 4,
 305:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_DISASSOC_AP_BUSY = 5,
 306:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_CLASS2_FRAME_FROM_NONAUTH_STA = 6,
 307:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_CLASS3_FRAME_FROM_NONASSOC_STA = 7,
 308:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_DISASSOC_STA_HAS_LEFT = 8,
 309:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_STA_REQ_ASSOC_WITHOUT_AUTH = 9,
 310:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* 802.11h */
 311:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_DISASSOC_BAD_POWER = 10,
 312:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_DISASSOC_BAD_SUPP_CHAN = 11,
 313:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* 802.11i */
 314:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_INVALID_IE = 13,
 315:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_MIC_FAILURE = 14,
 316:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_4WAY_HANDSHAKE_TIMEOUT = 15,
 317:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_GROUP_KEY_HANDSHAKE_TIMEOUT = 16,
 318:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_IE_DIFFERENT = 17,
 319:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_INVALID_GROUP_CIPHER = 18,
 320:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_INVALID_PAIRWISE_CIPHER = 19,
 321:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_INVALID_AKMP = 20,
 322:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_UNSUPP_RSN_VERSION = 21,
 323:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_INVALID_RSN_IE_CAP = 22,
 324:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_IEEE8021X_FAILED = 23,
 325:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_REASON_CIPHER_SUITE_REJECTED = 24,
 326:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 327:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 328:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* Action categories - 802.11h */
 329:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** enum ieee80211_actioncategories {
 330:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_ACTION_SPECTRUM_MGMT = 0,
 331:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Reserved 1-127  */
 332:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Error    128-255 */
 333:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 334:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 335:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* Action details - 802.11h */
 336:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** enum ieee80211_actiondetails {
 337:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_ACTION_CATEGORY_MEASURE_REQUEST = 0,
 338:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_ACTION_CATEGORY_MEASURE_REPORT = 1,
 339:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_ACTION_CATEGORY_TPC_REQUEST = 2,
 340:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_ACTION_CATEGORY_TPC_REPORT = 3,
 341:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	WLAN_ACTION_CATEGORY_CHANNEL_SWITCH = 4,
 342:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* 5 - 255 Reserved */
 343:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 344:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 345:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STATMASK_SIGNAL (1<<0)
 346:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STATMASK_RSSI (1<<1)
 347:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STATMASK_NOISE (1<<2)
 348:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STATMASK_RATE (1<<3)
 349:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_STATMASK_WEMASK 0x7
GAS LISTING  			page 12


 350:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 351:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_CCK_MODULATION    (1<<0)
 352:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_MODULATION   (1<<1)
 353:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 354:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_24GHZ_BAND     (1<<0)
 355:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_52GHZ_BAND     (1<<1)
 356:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 357:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_CCK_RATE_1MB		        0x02
 358:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_CCK_RATE_2MB		        0x04
 359:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_CCK_RATE_5MB		        0x0B
 360:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_CCK_RATE_11MB		        0x16
 361:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_6MB		        0x0C
 362:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_9MB		        0x12
 363:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_12MB		0x18
 364:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_18MB		0x24
 365:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_24MB		0x30
 366:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_36MB		0x48
 367:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_48MB		0x60
 368:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_54MB		0x6C
 369:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_BASIC_RATE_MASK		0x80
 370:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 371:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_CCK_RATE_1MB_MASK		(1<<0)
 372:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_CCK_RATE_2MB_MASK		(1<<1)
 373:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_CCK_RATE_5MB_MASK		(1<<2)
 374:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_CCK_RATE_11MB_MASK		(1<<3)
 375:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_6MB_MASK		(1<<4)
 376:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_9MB_MASK		(1<<5)
 377:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_12MB_MASK		(1<<6)
 378:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_18MB_MASK		(1<<7)
 379:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_24MB_MASK		(1<<8)
 380:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_36MB_MASK		(1<<9)
 381:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_48MB_MASK		(1<<10)
 382:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATE_54MB_MASK		(1<<11)
 383:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 384:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_CCK_RATES_MASK	        0x0000000F
 385:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_CCK_BASIC_RATES_MASK	(IEEE80211_CCK_RATE_1MB_MASK | \
 386:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_CCK_RATE_2MB_MASK)
 387:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_CCK_DEFAULT_RATES_MASK	(IEEE80211_CCK_BASIC_RATES_MASK | \
 388:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****         IEEE80211_CCK_RATE_5MB_MASK | \
 389:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****         IEEE80211_CCK_RATE_11MB_MASK)
 390:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 391:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_RATES_MASK		0x00000FF0
 392:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_BASIC_RATES_MASK	(IEEE80211_OFDM_RATE_6MB_MASK | \
 393:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_OFDM_RATE_12MB_MASK | \
 394:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_OFDM_RATE_24MB_MASK)
 395:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_DEFAULT_RATES_MASK	(IEEE80211_OFDM_BASIC_RATES_MASK | \
 396:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_OFDM_RATE_9MB_MASK  | \
 397:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_OFDM_RATE_18MB_MASK | \
 398:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_OFDM_RATE_36MB_MASK | \
 399:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_OFDM_RATE_48MB_MASK | \
 400:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_OFDM_RATE_54MB_MASK)
 401:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_DEFAULT_RATES_MASK (IEEE80211_OFDM_DEFAULT_RATES_MASK | \
 402:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****                                 IEEE80211_CCK_DEFAULT_RATES_MASK)
 403:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 404:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_NUM_OFDM_RATES	    8
 405:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_NUM_CCK_RATES	            4
 406:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_OFDM_SHIFT_MASK_A         4
GAS LISTING  			page 13


 407:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 408:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* NOTE: This data is for statistical purposes; not all hardware provides this
 409:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *       information for frames received.
 410:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *       For ieee80211_rx_mgt, you need to set at least the 'len' parameter.
 411:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  */
 412:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_rx_stats {
 413:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u32 mac_time;
 414:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	s8 rssi;
 415:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 signal;
 416:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 noise;
 417:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 rate;		/* in 100 kbps */
 418:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 received_channel;
 419:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 control;
 420:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 mask;
 421:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 freq;
 422:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 len;
 423:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u64 tsf;
 424:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u32 beacon_time;
 425:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 426:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 427:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* IEEE 802.11 requires that STA supports concurrent reception of at least
 428:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * three fragmented frames. This define can be increased to support more
 429:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * concurrent frames, but it should be noted that each entry can consume about
 430:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * 2 kB of RAM and increasing cache size will slow down frame reassembly. */
 431:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_FRAG_CACHE_LEN 4
 432:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 433:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_frag_entry {
 434:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned long first_frag_time;
 435:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int seq;
 436:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int last_frag;
 437:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct sk_buff *skb;
 438:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 src_addr[ETH_ALEN];
 439:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 dst_addr[ETH_ALEN];
 440:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 441:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 442:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_stats {
 443:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int tx_unicast_frames;
 444:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int tx_multicast_frames;
 445:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int tx_fragments;
 446:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int tx_unicast_octets;
 447:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int tx_multicast_octets;
 448:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int tx_deferred_transmissions;
 449:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int tx_single_retry_frames;
 450:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int tx_multiple_retry_frames;
 451:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int tx_retry_limit_exceeded;
 452:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int tx_discards;
 453:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int rx_unicast_frames;
 454:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int rx_multicast_frames;
 455:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int rx_fragments;
 456:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int rx_unicast_octets;
 457:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int rx_multicast_octets;
 458:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int rx_fcs_errors;
 459:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int rx_discards_no_buffer;
 460:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int tx_discards_wrong_sa;
 461:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int rx_discards_undecryptable;
 462:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int rx_message_in_msg_fragments;
 463:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int rx_message_in_bad_msg_fragments;
GAS LISTING  			page 14


 464:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 465:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 466:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_device;
 467:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 468:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #include "ieee80211_crypt.h"
 469:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 470:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_KEY_1		(1<<0)
 471:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_KEY_2		(1<<1)
 472:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_KEY_3		(1<<2)
 473:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_KEY_4		(1<<3)
 474:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_ACTIVE_KEY		(1<<4)
 475:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_AUTH_MODE		(1<<5)
 476:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_UNICAST_GROUP	(1<<6)
 477:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_LEVEL		(1<<7)
 478:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_ENABLED		(1<<8)
 479:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_ENCRYPT		(1<<9)
 480:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 481:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_LEVEL_0		0	/* None */
 482:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_LEVEL_1		1	/* WEP 40 and 104 bit */
 483:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_LEVEL_2		2	/* Level 1 + TKIP */
 484:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_LEVEL_2_CKIP	3	/* Level 1 + CKIP */
 485:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_LEVEL_3		4	/* Level 2 + CCMP */
 486:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 487:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_ALG_NONE		0
 488:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_ALG_WEP		1
 489:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_ALG_TKIP		2
 490:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SEC_ALG_CCMP		3
 491:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 492:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WEP_KEYS		4
 493:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define WEP_KEY_LEN		13
 494:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SCM_KEY_LEN		32
 495:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define SCM_TEMPORAL_KEY_LENGTH	16
 496:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 497:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_security {
 498:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 active_key:2,
 499:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	    enabled:1,
 500:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	    auth_mode:2, auth_algo:4, unicast_uses_group:1, encrypt:1;
 501:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 encode_alg[WEP_KEYS];
 502:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 key_sizes[WEP_KEYS];
 503:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 keys[WEP_KEYS][SCM_KEY_LEN];
 504:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 level;
 505:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 flags;
 506:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 507:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 508:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /*
 509:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 510:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  802.11 data frame from AP
 511:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 512:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****       ,-------------------------------------------------------------------.
 513:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** Bytes |  2   |  2   |    6    |    6    |    6    |  2   | 0..2312 |   4  |
 514:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****       |------|------|---------|---------|---------|------|---------|------|
 515:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** Desc. | ctrl | dura |  DA/RA  |   TA    |    SA   | Sequ |  frame  |  fcs |
 516:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****       |      | tion | (BSSID) |         |         | ence |  data   |      |
 517:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****       `-------------------------------------------------------------------'
 518:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 519:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** Total: 28-2340 bytes
 520:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
GAS LISTING  			page 15


 521:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** */
 522:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 523:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define BEACON_PROBE_SSID_ID_POSITION 12
 524:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 525:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* Management Frame Information Element Types */
 526:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** enum ieee80211_mfie {
 527:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_SSID = 0,
 528:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_RATES = 1,
 529:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_FH_SET = 2,
 530:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_DS_SET = 3,
 531:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_CF_SET = 4,
 532:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_TIM = 5,
 533:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_IBSS_SET = 6,
 534:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_COUNTRY = 7,
 535:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_HOP_PARAMS = 8,
 536:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_HOP_TABLE = 9,
 537:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_REQUEST = 10,
 538:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_CHALLENGE = 16,
 539:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_POWER_CONSTRAINT = 32,
 540:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_POWER_CAPABILITY = 33,
 541:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_TPC_REQUEST = 34,
 542:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_TPC_REPORT = 35,
 543:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_SUPP_CHANNELS = 36,
 544:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_CSA = 37,
 545:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_MEASURE_REQUEST = 38,
 546:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_MEASURE_REPORT = 39,
 547:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_QUIET = 40,
 548:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_IBSS_DFS = 41,
 549:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_ERP_INFO = 42,
 550:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_RSN = 48,
 551:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_RATES_EX = 50,
 552:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_GENERIC = 221,
 553:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	MFIE_TYPE_QOS_PARAMETER = 222,
 554:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 555:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 556:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* Minimal header; can be used for passing 802.11 frames with sufficient
 557:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * information to determine what type of underlying data type is actually
 558:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * stored in the data. */
 559:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_hdr {
 560:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 frame_ctl;
 561:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 duration_id;
 562:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 payload[0];
 563:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 564:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 565:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_hdr_1addr {
 566:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 frame_ctl;
 567:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 duration_id;
 568:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr1[ETH_ALEN];
 569:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 payload[0];
 570:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 571:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 572:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_hdr_2addr {
 573:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 frame_ctl;
 574:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 duration_id;
 575:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr1[ETH_ALEN];
 576:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr2[ETH_ALEN];
 577:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 payload[0];
GAS LISTING  			page 16


 578:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 579:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 580:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_hdr_3addr {
 581:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 frame_ctl;
 582:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 duration_id;
 583:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr1[ETH_ALEN];
 584:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr2[ETH_ALEN];
 585:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr3[ETH_ALEN];
 586:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 seq_ctl;
 587:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 payload[0];
 588:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 589:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 590:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_hdr_4addr {
 591:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 frame_ctl;
 592:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 duration_id;
 593:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr1[ETH_ALEN];
 594:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr2[ETH_ALEN];
 595:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr3[ETH_ALEN];
 596:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 seq_ctl;
 597:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr4[ETH_ALEN];
 598:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 payload[0];
 599:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 600:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 601:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_hdr_3addrqos {
 602:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 frame_ctl;
 603:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 duration_id;
 604:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr1[ETH_ALEN];
 605:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr2[ETH_ALEN];
 606:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr3[ETH_ALEN];
 607:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 seq_ctl;
 608:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 payload[0];
 609:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 qos_ctl;
 610:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 611:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 612:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_hdr_4addrqos {
 613:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 frame_ctl;
 614:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 duration_id;
 615:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr1[ETH_ALEN];
 616:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr2[ETH_ALEN];
 617:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr3[ETH_ALEN];
 618:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 seq_ctl;
 619:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 addr4[ETH_ALEN];
 620:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 payload[0];
 621:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 qos_ctl;
 622:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 623:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 624:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_info_element {
 625:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 id;
 626:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 len;
 627:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 data[0];
 628:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 629:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 630:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /*
 631:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * These are the data types that can make up management packets
 632:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  *
 633:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 auth_algorithm;
 634:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 auth_sequence;
GAS LISTING  			page 17


 635:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 beacon_interval;
 636:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 capability;
 637:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 current_ap[ETH_ALEN];
 638:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 listen_interval;
 639:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct {
 640:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 		u16 association_id:14, reserved:2;
 641:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	} __attribute__ ((packed));
 642:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u32 time_stamp[2];
 643:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 reason;
 644:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 status;
 645:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** */
 646:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 647:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_auth {
 648:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_hdr_3addr header;
 649:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 algorithm;
 650:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 transaction;
 651:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 status;
 652:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* challenge */
 653:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_info_element info_element[0];
 654:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 655:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 656:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_channel_switch {
 657:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 id;
 658:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 len;
 659:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 mode;
 660:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 channel;
 661:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 count;
 662:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 663:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 664:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_action {
 665:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_hdr_3addr header;
 666:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 category;
 667:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 action;
 668:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	union {
 669:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 		struct ieee80211_action_exchange {
 670:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 			u8 token;
 671:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 			struct ieee80211_info_element info_element[0];
 672:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 		} exchange;
 673:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 		struct ieee80211_channel_switch channel_switch;
 674:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 675:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	} format;
 676:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 677:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 678:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_disassoc {
 679:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_hdr_3addr header;
 680:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 reason;
 681:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 682:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 683:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* Alias deauth for disassoc */
 684:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define ieee80211_deauth ieee80211_disassoc
 685:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 686:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_probe_request {
 687:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_hdr_3addr header;
 688:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* SSID, supported rates */
 689:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_info_element info_element[0];
 690:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 691:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
GAS LISTING  			page 18


 692:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_probe_response {
 693:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_hdr_3addr header;
 694:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u32 time_stamp[2];
 695:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 beacon_interval;
 696:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 capability;
 697:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* SSID, supported rates, FH params, DS params,
 698:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	 * CF params, IBSS params, TIM (if beacon), RSN */
 699:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_info_element info_element[0];
 700:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 701:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 702:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* Alias beacon for probe_response */
 703:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define ieee80211_beacon ieee80211_probe_response
 704:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 705:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_assoc_request {
 706:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_hdr_3addr header;
 707:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 capability;
 708:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 listen_interval;
 709:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* SSID, supported rates, RSN */
 710:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_info_element info_element[0];
 711:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 712:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 713:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_reassoc_request {
 714:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_hdr_3addr header;
 715:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 capability;
 716:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 listen_interval;
 717:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 current_ap[ETH_ALEN];
 718:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_info_element info_element[0];
 719:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 720:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 721:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_assoc_response {
 722:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_hdr_3addr header;
 723:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 capability;
 724:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 status;
 725:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 aid;
 726:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* supported rates */
 727:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_info_element info_element[0];
 728:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 729:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 730:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_txb {
 731:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 nr_frags;
 732:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 encrypted;
 733:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 rts_included;
 734:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 reserved;
 735:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 frag_size;
 736:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 payload_size;
 737:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct sk_buff *fragments[0];
 738:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 739:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 740:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* SWEEP TABLE ENTRIES NUMBER */
 741:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define MAX_SWEEP_TAB_ENTRIES		  42
 742:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define MAX_SWEEP_TAB_ENTRIES_PER_PACKET  7
 743:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* MAX_RATES_LENGTH needs to be 12.  The spec says 8, and many APs
 744:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * only use 8, and then use extended rates for the remaining supported
 745:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * rates.  Other APs, however, stick all of their supported rates on the
 746:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****  * main rates information element... */
 747:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define MAX_RATES_LENGTH                  ((u8)12)
 748:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define MAX_RATES_EX_LENGTH               ((u8)16)
GAS LISTING  			page 19


 749:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define MAX_NETWORK_COUNT                  128
 750:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 751:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define CRC_LENGTH                 4U
 752:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 753:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define MAX_WPA_IE_LEN 64
 754:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 755:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define NETWORK_EMPTY_ESSID    (1<<0)
 756:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define NETWORK_HAS_OFDM       (1<<1)
 757:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define NETWORK_HAS_CCK        (1<<2)
 758:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 759:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* QoS structure */
 760:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define NETWORK_HAS_QOS_PARAMETERS      (1<<3)
 761:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define NETWORK_HAS_QOS_INFORMATION     (1<<4)
 762:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define NETWORK_HAS_QOS_MASK            (NETWORK_HAS_QOS_PARAMETERS | \
 763:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 					 NETWORK_HAS_QOS_INFORMATION)
 764:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 765:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* 802.11h */
 766:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define NETWORK_HAS_POWER_CONSTRAINT    (1<<5)
 767:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define NETWORK_HAS_CSA                 (1<<6)
 768:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define NETWORK_HAS_QUIET               (1<<7)
 769:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define NETWORK_HAS_IBSS_DFS            (1<<8)
 770:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define NETWORK_HAS_TPC_REPORT          (1<<9)
 771:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 772:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define QOS_QUEUE_NUM                   4
 773:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define QOS_OUI_LEN                     3
 774:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define QOS_OUI_TYPE                    2
 775:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define QOS_ELEMENT_ID                  221
 776:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define QOS_OUI_INFO_SUB_TYPE           0
 777:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define QOS_OUI_PARAM_SUB_TYPE          1
 778:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define QOS_VERSION_1                   1
 779:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define QOS_AIFSN_MIN_VALUE             2
 780:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 781:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_qos_information_element {
 782:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 elementID;
 783:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 length;
 784:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 qui[QOS_OUI_LEN];
 785:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 qui_type;
 786:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 qui_subtype;
 787:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 version;
 788:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 ac_info;
 789:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 790:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 791:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_qos_ac_parameter {
 792:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 aci_aifsn;
 793:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 ecw_min_max;
 794:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 tx_op_limit;
 795:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 796:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 797:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_qos_parameter_info {
 798:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_qos_information_element info_element;
 799:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 reserved;
 800:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_qos_ac_parameter ac_params_record[QOS_QUEUE_NUM];
 801:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 802:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 803:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_qos_parameters {
 804:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 cw_min[QOS_QUEUE_NUM];
 805:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 cw_max[QOS_QUEUE_NUM];
GAS LISTING  			page 20


 806:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 aifs[QOS_QUEUE_NUM];
 807:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 flag[QOS_QUEUE_NUM];
 808:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 tx_op_limit[QOS_QUEUE_NUM];
 809:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 810:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 811:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_qos_data {
 812:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_qos_parameters parameters;
 813:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int active;
 814:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int supported;
 815:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 param_count;
 816:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 old_param_count;
 817:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 818:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 819:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_tim_parameters {
 820:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 tim_count;
 821:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 tim_period;
 822:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 823:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 824:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /*******************************************************/
 825:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 826:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** enum {				/* ieee80211_basic_report.map */
 827:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_BASIC_MAP_BSS = (1 << 0),
 828:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_BASIC_MAP_OFDM = (1 << 1),
 829:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_BASIC_MAP_UNIDENTIFIED = (1 << 2),
 830:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_BASIC_MAP_RADAR = (1 << 3),
 831:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_BASIC_MAP_UNMEASURED = (1 << 4),
 832:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Bits 5-7 are reserved */
 833:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 834:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 835:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_basic_report {
 836:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 channel;
 837:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le64 start_time;
 838:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 duration;
 839:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 map;
 840:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 841:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 842:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** enum {				/* ieee80211_measurement_request.mode */
 843:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Bit 0 is reserved */
 844:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_MEASUREMENT_ENABLE = (1 << 1),
 845:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_MEASUREMENT_REQUEST = (1 << 2),
 846:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_MEASUREMENT_REPORT = (1 << 3),
 847:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Bits 4-7 are reserved */
 848:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 849:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 850:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** enum {
 851:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_REPORT_BASIC = 0,	/* required */
 852:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_REPORT_CCA = 1,	/* optional */
 853:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_REPORT_RPI = 2,	/* optional */
 854:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* 3-255 reserved */
 855:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 856:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 857:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_measurement_params {
 858:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 channel;
 859:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le64 start_time;
 860:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	__le16 duration;
 861:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 862:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
GAS LISTING  			page 21


 863:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_measurement_request {
 864:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_info_element ie;
 865:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 token;
 866:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 mode;
 867:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 type;
 868:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_measurement_params params[0];
 869:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 870:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 871:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_measurement_report {
 872:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_info_element ie;
 873:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 token;
 874:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 mode;
 875:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 type;
 876:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	union {
 877:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 		struct ieee80211_basic_report basic[0];
 878:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	} u;
 879:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 880:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 881:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_tpc_report {
 882:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 transmit_power;
 883:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 link_margin;
 884:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 885:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 886:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_channel_map {
 887:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 channel;
 888:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 map;
 889:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 890:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 891:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_ibss_dfs {
 892:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_info_element ie;
 893:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 owner[ETH_ALEN];
 894:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 recovery_interval;
 895:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_channel_map channel_map[0];
 896:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 897:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 898:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_csa {
 899:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 mode;
 900:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 channel;
 901:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 count;
 902:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 903:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 904:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_quiet {
 905:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 count;
 906:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 period;
 907:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 duration;
 908:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 offset;
 909:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** } __attribute__ ((packed));
 910:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 911:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_network {
 912:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* These entries are used to identify a unique network */
 913:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 bssid[ETH_ALEN];
 914:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 channel;
 915:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Ensure null-terminated for any debug msgs */
 916:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 ssid[IW_ESSID_MAX_SIZE + 1];
 917:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 ssid_len;
 918:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 919:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_qos_data qos_data;
GAS LISTING  			page 22


 920:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 921:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* These are network statistics */
 922:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_rx_stats stats;
 923:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 capability;
 924:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 rates[MAX_RATES_LENGTH];
 925:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 rates_len;
 926:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 rates_ex[MAX_RATES_EX_LENGTH];
 927:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 rates_ex_len;
 928:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned long last_scanned;
 929:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 mode;
 930:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u32 flags;
 931:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u32 last_associate;
 932:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u32 time_stamp[2];
 933:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 beacon_interval;
 934:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 listen_interval;
 935:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 atim_window;
 936:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 erp_value;
 937:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 wpa_ie[MAX_WPA_IE_LEN];
 938:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	size_t wpa_ie_len;
 939:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 rsn_ie[MAX_WPA_IE_LEN];
 940:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	size_t rsn_ie_len;
 941:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_tim_parameters tim;
 942:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 943:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* 802.11h info */
 944:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 945:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Power Constraint - mandatory if spctrm mgmt required */
 946:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 power_constraint;
 947:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 948:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* TPC Report - mandatory if spctrm mgmt required */
 949:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_tpc_report tpc_report;
 950:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 951:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* IBSS DFS - mandatory if spctrm mgmt required and IBSS
 952:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	 * NOTE: This is variable length and so must be allocated dynamically */
 953:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_ibss_dfs *ibss_dfs;
 954:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 955:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Channel Switch Announcement - optional if spctrm mgmt required */
 956:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_csa csa;
 957:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 958:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Quiet - optional if spctrm mgmt required */
 959:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_quiet quiet;
 960:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 961:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct list_head list;
 962:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 963:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 964:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** enum ieee80211_state {
 965:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_UNINITIALIZED = 0,
 966:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_INITIALIZED,
 967:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_ASSOCIATING,
 968:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_ASSOCIATED,
 969:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_AUTHENTICATING,
 970:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_AUTHENTICATED,
 971:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_SHUTDOWN
 972:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 973:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 974:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define DEFAULT_MAX_SCAN_AGE (15 * HZ)
 975:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define DEFAULT_FTS 2346
 976:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
GAS LISTING  			page 23


 977:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define CFG_IEEE80211_RESERVE_FCS (1<<0)
 978:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define CFG_IEEE80211_COMPUTE_FCS (1<<1)
 979:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define CFG_IEEE80211_RTS (1<<2)
 980:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 981:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_24GHZ_MIN_CHANNEL 1
 982:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_24GHZ_MAX_CHANNEL 14
 983:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_24GHZ_CHANNELS    14
 984:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 985:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_52GHZ_MIN_CHANNEL 34
 986:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_52GHZ_MAX_CHANNEL 165
 987:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE80211_52GHZ_CHANNELS    131
 988:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 989:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** enum {
 990:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_CH_PASSIVE_ONLY = (1 << 0),
 991:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_CH_B_ONLY = (1 << 2),
 992:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_CH_NO_IBSS = (1 << 3),
 993:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_CH_UNIFORM_SPREADING = (1 << 4),
 994:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_CH_RADAR_DETECT = (1 << 5),
 995:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	IEEE80211_CH_INVALID = (1 << 6),
 996:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
 997:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
 998:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_channel {
 999:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u32 freq;
1000:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 channel;
1001:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 flags;
1002:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 max_power;
1003:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
1004:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1005:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_geo {
1006:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 name[4];
1007:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 bg_channels;
1008:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 a_channels;
1009:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_channel bg[IEEE80211_24GHZ_CHANNELS];
1010:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_channel a[IEEE80211_52GHZ_CHANNELS];
1011:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
1012:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1013:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** struct ieee80211_device {
1014:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct net_device *dev;
1015:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_security sec;
1016:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1017:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Bookkeeping structures */
1018:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct net_device_stats stats;
1019:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_stats ieee_stats;
1020:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1021:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_geo geo;
1022:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1023:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Probe / Beacon management */
1024:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct list_head network_free_list;
1025:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct list_head network_list;
1026:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_network *networks;
1027:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int scans;
1028:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int scan_age;
1029:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1030:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int iw_mode;		/* operating mode (IW_MODE_*) */
1031:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct iw_spy_data spy_data;	/* iwspy support */
1032:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1033:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	spinlock_t lock;
GAS LISTING  			page 24


1034:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1035:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int tx_headroom;	/* Set to size of any additional room needed at front
1036:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				 * of allocated Tx SKBs */
1037:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u32 config;
1038:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1039:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* WEP and other encryption related settings at the device level */
1040:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int open_wep;		/* Set to 1 to allow unencrypted frames */
1041:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1042:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int reset_on_keychange;	/* Set to 1 if the HW needs to be reset on
1043:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				 * WEP key changes */
1044:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1045:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* If the host performs {en,de}cryption, then set to 1 */
1046:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int host_encrypt;
1047:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int host_encrypt_msdu;
1048:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int host_decrypt;
1049:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* host performs multicast decryption */
1050:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int host_mc_decrypt;
1051:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1052:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int host_open_frag;
1053:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int host_build_iv;
1054:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int ieee802_1x;		/* is IEEE 802.1X used */
1055:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1056:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* WPA data */
1057:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int wpa_enabled;
1058:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int drop_unencrypted;
1059:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int privacy_invoked;
1060:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	size_t wpa_ie_len;
1061:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 *wpa_ie;
1062:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1063:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct list_head crypt_deinit_list;
1064:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_crypt_data *crypt[WEP_KEYS];
1065:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int tx_keyidx;		/* default TX key index (crypt[tx_keyidx]) */
1066:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct timer_list crypt_deinit_timer;
1067:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int crypt_quiesced;
1068:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1069:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int bcrx_sta_key;	/* use individual keys to override default keys even
1070:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				 * with RX of broad/multicast frames */
1071:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1072:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Fragmentation structures */
1073:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	struct ieee80211_frag_entry frag_cache[IEEE80211_FRAG_CACHE_LEN];
1074:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	unsigned int frag_next_idx;
1075:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 fts;		/* Fragmentation Threshold */
1076:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u16 rts;		/* RTS threshold */
1077:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1078:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Association info */
1079:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 bssid[ETH_ALEN];
1080:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1081:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	enum ieee80211_state state;
1082:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1083:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int mode;		/* A, B, G */
1084:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int modulation;		/* CCK, OFDM */
1085:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int freq_band;		/* 2.4Ghz, 5.2Ghz, Mixed */
1086:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int abg_true;		/* ABG flag              */
1087:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1088:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int perfect_rssi;
1089:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int worst_rssi;
1090:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
GAS LISTING  			page 25


1091:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Callback functions */
1092:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	void (*set_security) (struct net_device * dev,
1093:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 			      struct ieee80211_security * sec);
1094:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*hard_start_xmit) (struct ieee80211_txb * txb,
1095:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				struct net_device * dev, int pri);
1096:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*reset_port) (struct net_device * dev);
1097:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*is_queue_full) (struct net_device * dev, int pri);
1098:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1099:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*handle_management) (struct net_device * dev,
1100:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				  struct ieee80211_network * network, u16 type);
1101:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1102:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Typical STA methods */
1103:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*handle_auth) (struct net_device * dev,
1104:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 			    struct ieee80211_auth * auth);
1105:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*handle_deauth) (struct net_device * dev,
1106:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 			      struct ieee80211_deauth * auth);
1107:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*handle_action) (struct net_device * dev,
1108:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 			      struct ieee80211_action * action,
1109:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 			      struct ieee80211_rx_stats * stats);
1110:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*handle_disassoc) (struct net_device * dev,
1111:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				struct ieee80211_disassoc * assoc);
1112:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*handle_beacon) (struct net_device * dev,
1113:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 			      struct ieee80211_beacon * beacon,
1114:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 			      struct ieee80211_network * network);
1115:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*handle_probe_response) (struct net_device * dev,
1116:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				      struct ieee80211_probe_response * resp,
1117:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				      struct ieee80211_network * network);
1118:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*handle_probe_request) (struct net_device * dev,
1119:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				     struct ieee80211_probe_request * req,
1120:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				     struct ieee80211_rx_stats * stats);
1121:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*handle_assoc_response) (struct net_device * dev,
1122:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				      struct ieee80211_assoc_response * resp,
1123:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				      struct ieee80211_network * network);
1124:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1125:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* Typical AP methods */
1126:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*handle_assoc_request) (struct net_device * dev);
1127:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	int (*handle_reassoc_request) (struct net_device * dev,
1128:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 				       struct ieee80211_reassoc_request * req);
1129:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1130:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	/* This must be the last item so that it points to the data
1131:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	 * allocated beyond this structure by alloc_ieee80211 */
1132:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	u8 priv[0];
1133:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** };
1134:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1135:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE_A            (1<<0)
1136:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE_B            (1<<1)
1137:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE_G            (1<<2)
1138:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define IEEE_MODE_MASK    (IEEE_A|IEEE_B|IEEE_G)
1139:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1140:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #include <linux/version.h>	/* KERNEL_VERSION */
1141:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #if LINUX_VERSION_CODE < KERNEL_VERSION(2,6,12)
1142:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** static inline int is_multicast_ether_addr(const u8 *addr)
1143:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** {
1144:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h ****        return addr[0] & 0x01;
1145:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** }
1146:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #endif
1147:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
GAS LISTING  			page 26


1148:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** /* Fix for kernels < 2.6.12, since we use __nocast */
1149:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #ifndef __nocast
1150:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #define __nocast
1151:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #endif
1152:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 
1153:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** #if LINUX_VERSION_CODE < KERNEL_VERSION(2,6,14)
1154:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** static inline void *kzalloc(size_t size, unsigned __nocast flags)
1155:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** {
1156:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	void *ret = kmalloc(size, flags);
1157:/home/usuario/ipw3945install/ieee80211-1.1.12/net/ieee80211.h **** 	if (ret)
  96              	.loc 3 1157 0
  97 0034 85C0     	testl %eax,%eax
  98              	.LBB7:
  99              	.LBB8:
 100              	.LBB9:
 101              	.loc 2 93 0
 102 0036 59       	popl %ecx
 103              	.LCFI8:
 104 0037 89C3     	movl %eax,%ebx
 105              	.LBE9:
 106              	.LBE8:
 107              	.LBE7:
 108              	.loc 3 1157 0
 109 0039 7477     	je .L57
 110              	.LBB10:
 111              	.LBB11:
 112              	.LBB12:
 113              	.file 4 "include/asm/string.h"
   1:include/asm/string.h **** #ifndef _I386_STRING_H_
   2:include/asm/string.h **** #define _I386_STRING_H_
   3:include/asm/string.h **** 
   4:include/asm/string.h **** #ifdef __KERNEL__
   5:include/asm/string.h **** #include <linux/config.h>
   6:include/asm/string.h **** /*
   7:include/asm/string.h ****  * On a 486 or Pentium, we are better off not using the
   8:include/asm/string.h ****  * byte string operations. But on a 386 or a PPro the
   9:include/asm/string.h ****  * byte string ops are faster than doing it by hand
  10:include/asm/string.h ****  * (MUCH faster on a Pentium).
  11:include/asm/string.h ****  */
  12:include/asm/string.h **** 
  13:include/asm/string.h **** /*
  14:include/asm/string.h ****  * This string-include defines all string functions as inline
  15:include/asm/string.h ****  * functions. Use gcc. It also assumes ds=es=data space, this should be
  16:include/asm/string.h ****  * normal. Most of the string-functions are rather heavily hand-optimized,
  17:include/asm/string.h ****  * see especially strsep,strstr,str[c]spn. They should work, but are not
  18:include/asm/string.h ****  * very easy to understand. Everything is done entirely within the register
  19:include/asm/string.h ****  * set, making the functions fast and clean. String instructions have been
  20:include/asm/string.h ****  * used through-out, making for "slightly" unclear code :-)
  21:include/asm/string.h ****  *
  22:include/asm/string.h ****  *		NO Copyright (C) 1991, 1992 Linus Torvalds,
  23:include/asm/string.h ****  *		consider these trivial functions to be PD.
  24:include/asm/string.h ****  */
  25:include/asm/string.h **** 
  26:include/asm/string.h **** /* AK: in fact I bet it would be better to move this stuff all out of line.
  27:include/asm/string.h ****  */
  28:include/asm/string.h **** 
  29:include/asm/string.h **** #define __HAVE_ARCH_STRCPY
GAS LISTING  			page 27


  30:include/asm/string.h **** static inline char * strcpy(char * dest,const char *src)
  31:include/asm/string.h **** {
  32:include/asm/string.h **** int d0, d1, d2;
  33:include/asm/string.h **** __asm__ __volatile__(
  34:include/asm/string.h **** 	"1:\tlodsb\n\t"
  35:include/asm/string.h **** 	"stosb\n\t"
  36:include/asm/string.h **** 	"testb %%al,%%al\n\t"
  37:include/asm/string.h **** 	"jne 1b"
  38:include/asm/string.h **** 	: "=&S" (d0), "=&D" (d1), "=&a" (d2)
  39:include/asm/string.h **** 	:"0" (src),"1" (dest) : "memory");
  40:include/asm/string.h **** return dest;
  41:include/asm/string.h **** }
  42:include/asm/string.h **** 
  43:include/asm/string.h **** #define __HAVE_ARCH_STRNCPY
  44:include/asm/string.h **** static inline char * strncpy(char * dest,const char *src,size_t count)
  45:include/asm/string.h **** {
  46:include/asm/string.h **** int d0, d1, d2, d3;
  47:include/asm/string.h **** __asm__ __volatile__(
  48:include/asm/string.h **** 	"1:\tdecl %2\n\t"
  49:include/asm/string.h **** 	"js 2f\n\t"
  50:include/asm/string.h **** 	"lodsb\n\t"
  51:include/asm/string.h **** 	"stosb\n\t"
  52:include/asm/string.h **** 	"testb %%al,%%al\n\t"
  53:include/asm/string.h **** 	"jne 1b\n\t"
  54:include/asm/string.h **** 	"rep\n\t"
  55:include/asm/string.h **** 	"stosb\n"
  56:include/asm/string.h **** 	"2:"
  57:include/asm/string.h **** 	: "=&S" (d0), "=&D" (d1), "=&c" (d2), "=&a" (d3)
  58:include/asm/string.h **** 	:"0" (src),"1" (dest),"2" (count) : "memory");
  59:include/asm/string.h **** return dest;
  60:include/asm/string.h **** }
  61:include/asm/string.h **** 
  62:include/asm/string.h **** #define __HAVE_ARCH_STRCAT
  63:include/asm/string.h **** static inline char * strcat(char * dest,const char * src)
  64:include/asm/string.h **** {
  65:include/asm/string.h **** int d0, d1, d2, d3;
  66:include/asm/string.h **** __asm__ __volatile__(
  67:include/asm/string.h **** 	"repne\n\t"
  68:include/asm/string.h **** 	"scasb\n\t"
  69:include/asm/string.h **** 	"decl %1\n"
  70:include/asm/string.h **** 	"1:\tlodsb\n\t"
  71:include/asm/string.h **** 	"stosb\n\t"
  72:include/asm/string.h **** 	"testb %%al,%%al\n\t"
  73:include/asm/string.h **** 	"jne 1b"
  74:include/asm/string.h **** 	: "=&S" (d0), "=&D" (d1), "=&a" (d2), "=&c" (d3)
  75:include/asm/string.h **** 	: "0" (src), "1" (dest), "2" (0), "3" (0xffffffffu):"memory");
  76:include/asm/string.h **** return dest;
  77:include/asm/string.h **** }
  78:include/asm/string.h **** 
  79:include/asm/string.h **** #define __HAVE_ARCH_STRNCAT
  80:include/asm/string.h **** static inline char * strncat(char * dest,const char * src,size_t count)
  81:include/asm/string.h **** {
  82:include/asm/string.h **** int d0, d1, d2, d3;
  83:include/asm/string.h **** __asm__ __volatile__(
  84:include/asm/string.h **** 	"repne\n\t"
  85:include/asm/string.h **** 	"scasb\n\t"
  86:include/asm/string.h **** 	"decl %1\n\t"
GAS LISTING  			page 28


  87:include/asm/string.h **** 	"movl %8,%3\n"
  88:include/asm/string.h **** 	"1:\tdecl %3\n\t"
  89:include/asm/string.h **** 	"js 2f\n\t"
  90:include/asm/string.h **** 	"lodsb\n\t"
  91:include/asm/string.h **** 	"stosb\n\t"
  92:include/asm/string.h **** 	"testb %%al,%%al\n\t"
  93:include/asm/string.h **** 	"jne 1b\n"
  94:include/asm/string.h **** 	"2:\txorl %2,%2\n\t"
  95:include/asm/string.h **** 	"stosb"
  96:include/asm/string.h **** 	: "=&S" (d0), "=&D" (d1), "=&a" (d2), "=&c" (d3)
  97:include/asm/string.h **** 	: "0" (src),"1" (dest),"2" (0),"3" (0xffffffffu), "g" (count)
  98:include/asm/string.h **** 	: "memory");
  99:include/asm/string.h **** return dest;
 100:include/asm/string.h **** }
 101:include/asm/string.h **** 
 102:include/asm/string.h **** #define __HAVE_ARCH_STRCMP
 103:include/asm/string.h **** static inline int strcmp(const char * cs,const char * ct)
 104:include/asm/string.h **** {
 105:include/asm/string.h **** int d0, d1;
 106:include/asm/string.h **** register int __res;
 107:include/asm/string.h **** __asm__ __volatile__(
 108:include/asm/string.h **** 	"1:\tlodsb\n\t"
 109:include/asm/string.h **** 	"scasb\n\t"
 110:include/asm/string.h **** 	"jne 2f\n\t"
 111:include/asm/string.h **** 	"testb %%al,%%al\n\t"
 112:include/asm/string.h **** 	"jne 1b\n\t"
 113:include/asm/string.h **** 	"xorl %%eax,%%eax\n\t"
 114:include/asm/string.h **** 	"jmp 3f\n"
 115:include/asm/string.h **** 	"2:\tsbbl %%eax,%%eax\n\t"
 116:include/asm/string.h **** 	"orb $1,%%al\n"
 117:include/asm/string.h **** 	"3:"
 118:include/asm/string.h **** 	:"=a" (__res), "=&S" (d0), "=&D" (d1)
 119:include/asm/string.h **** 	:"1" (cs),"2" (ct)
 120:include/asm/string.h **** 	:"memory");
 121:include/asm/string.h **** return __res;
 122:include/asm/string.h **** }
 123:include/asm/string.h **** 
 124:include/asm/string.h **** #define __HAVE_ARCH_STRNCMP
 125:include/asm/string.h **** static inline int strncmp(const char * cs,const char * ct,size_t count)
 126:include/asm/string.h **** {
 127:include/asm/string.h **** register int __res;
 128:include/asm/string.h **** int d0, d1, d2;
 129:include/asm/string.h **** __asm__ __volatile__(
 130:include/asm/string.h **** 	"1:\tdecl %3\n\t"
 131:include/asm/string.h **** 	"js 2f\n\t"
 132:include/asm/string.h **** 	"lodsb\n\t"
 133:include/asm/string.h **** 	"scasb\n\t"
 134:include/asm/string.h **** 	"jne 3f\n\t"
 135:include/asm/string.h **** 	"testb %%al,%%al\n\t"
 136:include/asm/string.h **** 	"jne 1b\n"
 137:include/asm/string.h **** 	"2:\txorl %%eax,%%eax\n\t"
 138:include/asm/string.h **** 	"jmp 4f\n"
 139:include/asm/string.h **** 	"3:\tsbbl %%eax,%%eax\n\t"
 140:include/asm/string.h **** 	"orb $1,%%al\n"
 141:include/asm/string.h **** 	"4:"
 142:include/asm/string.h **** 	:"=a" (__res), "=&S" (d0), "=&D" (d1), "=&c" (d2)
 143:include/asm/string.h **** 	:"1" (cs),"2" (ct),"3" (count)
GAS LISTING  			page 29


 144:include/asm/string.h **** 	:"memory");
 145:include/asm/string.h **** return __res;
 146:include/asm/string.h **** }
 147:include/asm/string.h **** 
 148:include/asm/string.h **** #define __HAVE_ARCH_STRCHR
 149:include/asm/string.h **** static inline char * strchr(const char * s, int c)
 150:include/asm/string.h **** {
 151:include/asm/string.h **** int d0;
 152:include/asm/string.h **** register char * __res;
 153:include/asm/string.h **** __asm__ __volatile__(
 154:include/asm/string.h **** 	"movb %%al,%%ah\n"
 155:include/asm/string.h **** 	"1:\tlodsb\n\t"
 156:include/asm/string.h **** 	"cmpb %%ah,%%al\n\t"
 157:include/asm/string.h **** 	"je 2f\n\t"
 158:include/asm/string.h **** 	"testb %%al,%%al\n\t"
 159:include/asm/string.h **** 	"jne 1b\n\t"
 160:include/asm/string.h **** 	"movl $1,%1\n"
 161:include/asm/string.h **** 	"2:\tmovl %1,%0\n\t"
 162:include/asm/string.h **** 	"decl %0"
 163:include/asm/string.h **** 	:"=a" (__res), "=&S" (d0)
 164:include/asm/string.h **** 	:"1" (s),"0" (c)
 165:include/asm/string.h **** 	:"memory");
 166:include/asm/string.h **** return __res;
 167:include/asm/string.h **** }
 168:include/asm/string.h **** 
 169:include/asm/string.h **** #define __HAVE_ARCH_STRRCHR
 170:include/asm/string.h **** static inline char * strrchr(const char * s, int c)
 171:include/asm/string.h **** {
 172:include/asm/string.h **** int d0, d1;
 173:include/asm/string.h **** register char * __res;
 174:include/asm/string.h **** __asm__ __volatile__(
 175:include/asm/string.h **** 	"movb %%al,%%ah\n"
 176:include/asm/string.h **** 	"1:\tlodsb\n\t"
 177:include/asm/string.h **** 	"cmpb %%ah,%%al\n\t"
 178:include/asm/string.h **** 	"jne 2f\n\t"
 179:include/asm/string.h **** 	"leal -1(%%esi),%0\n"
 180:include/asm/string.h **** 	"2:\ttestb %%al,%%al\n\t"
 181:include/asm/string.h **** 	"jne 1b"
 182:include/asm/string.h **** 	:"=g" (__res), "=&S" (d0), "=&a" (d1)
 183:include/asm/string.h **** 	:"0" (0),"1" (s),"2" (c)
 184:include/asm/string.h **** 	:"memory");
 185:include/asm/string.h **** return __res;
 186:include/asm/string.h **** }
 187:include/asm/string.h **** 
 188:include/asm/string.h **** #define __HAVE_ARCH_STRLEN
 189:include/asm/string.h **** static inline size_t strlen(const char * s)
 190:include/asm/string.h **** {
 191:include/asm/string.h **** int d0;
 192:include/asm/string.h **** register int __res;
 193:include/asm/string.h **** __asm__ __volatile__(
 194:include/asm/string.h **** 	"repne\n\t"
 195:include/asm/string.h **** 	"scasb\n\t"
 196:include/asm/string.h **** 	"notl %0\n\t"
 197:include/asm/string.h **** 	"decl %0"
 198:include/asm/string.h **** 	:"=c" (__res), "=&D" (d0)
 199:include/asm/string.h **** 	:"1" (s),"a" (0), "0" (0xffffffffu)
 200:include/asm/string.h **** 	:"memory");
GAS LISTING  			page 30


 201:include/asm/string.h **** return __res;
 202:include/asm/string.h **** }
 203:include/asm/string.h **** 
 204:include/asm/string.h **** static inline void * __memcpy(void * to, const void * from, size_t n)
 205:include/asm/string.h **** {
 206:include/asm/string.h **** int d0, d1, d2;
 207:include/asm/string.h **** __asm__ __volatile__(
 208:include/asm/string.h **** 	"rep ; movsl\n\t"
 209:include/asm/string.h **** 	"movl %4,%%ecx\n\t"
 210:include/asm/string.h **** 	"andl $3,%%ecx\n\t"
 211:include/asm/string.h **** #if 1	/* want to pay 2 byte penalty for a chance to skip microcoded rep? */
 212:include/asm/string.h **** 	"jz 1f\n\t"
 213:include/asm/string.h **** #endif
 214:include/asm/string.h **** 	"rep ; movsb\n\t"
 215:include/asm/string.h **** 	"1:"
 216:include/asm/string.h **** 	: "=&c" (d0), "=&D" (d1), "=&S" (d2)
 217:include/asm/string.h **** 	: "0" (n/4), "g" (n), "1" ((long) to), "2" ((long) from)
 218:include/asm/string.h **** 	: "memory");
 219:include/asm/string.h **** return (to);
 220:include/asm/string.h **** }
 221:include/asm/string.h **** 
 222:include/asm/string.h **** /*
 223:include/asm/string.h ****  * This looks ugly, but the compiler can optimize it totally,
 224:include/asm/string.h ****  * as the count is constant.
 225:include/asm/string.h ****  */
 226:include/asm/string.h **** static inline void * __constant_memcpy(void * to, const void * from, size_t n)
 227:include/asm/string.h **** {
 228:include/asm/string.h **** 	long esi, edi;
 229:include/asm/string.h **** 	if (!n) return to;
 230:include/asm/string.h **** #if 1	/* want to do small copies with non-string ops? */
 231:include/asm/string.h **** 	switch (n) {
 232:include/asm/string.h **** 		case 1: *(char*)to = *(char*)from; return to;
 233:include/asm/string.h **** 		case 2: *(short*)to = *(short*)from; return to;
 234:include/asm/string.h **** 		case 4: *(int*)to = *(int*)from; return to;
 235:include/asm/string.h **** #if 1	/* including those doable with two moves? */
 236:include/asm/string.h **** 		case 3: *(short*)to = *(short*)from;
 237:include/asm/string.h **** 			*((char*)to+2) = *((char*)from+2); return to;
 238:include/asm/string.h **** 		case 5: *(int*)to = *(int*)from;
 239:include/asm/string.h **** 			*((char*)to+4) = *((char*)from+4); return to;
 240:include/asm/string.h **** 		case 6: *(int*)to = *(int*)from;
 241:include/asm/string.h **** 			*((short*)to+2) = *((short*)from+2); return to;
 242:include/asm/string.h **** 		case 8: *(int*)to = *(int*)from;
 243:include/asm/string.h **** 			*((int*)to+1) = *((int*)from+1); return to;
 244:include/asm/string.h **** #endif
 245:include/asm/string.h **** 	}
 246:include/asm/string.h **** #endif
 247:include/asm/string.h **** 	esi = (long) from;
 248:include/asm/string.h **** 	edi = (long) to;
 249:include/asm/string.h **** 	if (n >= 5*4) {
 250:include/asm/string.h **** 		/* large block: use rep prefix */
 251:include/asm/string.h **** 		int ecx;
 252:include/asm/string.h **** 		__asm__ __volatile__(
 253:include/asm/string.h **** 			"rep ; movsl"
 254:include/asm/string.h **** 			: "=&c" (ecx), "=&D" (edi), "=&S" (esi)
 255:include/asm/string.h **** 			: "0" (n/4), "1" (edi),"2" (esi)
 256:include/asm/string.h **** 			: "memory"
 257:include/asm/string.h **** 		);
GAS LISTING  			page 31


 258:include/asm/string.h **** 	} else {
 259:include/asm/string.h **** 		/* small block: don't clobber ecx + smaller code */
 260:include/asm/string.h **** 		if (n >= 4*4) __asm__ __volatile__("movsl"
 261:include/asm/string.h **** 			:"=&D"(edi),"=&S"(esi):"0"(edi),"1"(esi):"memory");
 262:include/asm/string.h **** 		if (n >= 3*4) __asm__ __volatile__("movsl"
 263:include/asm/string.h **** 			:"=&D"(edi),"=&S"(esi):"0"(edi),"1"(esi):"memory");
 264:include/asm/string.h **** 		if (n >= 2*4) __asm__ __volatile__("movsl"
 265:include/asm/string.h **** 			:"=&D"(edi),"=&S"(esi):"0"(edi),"1"(esi):"memory");
 266:include/asm/string.h **** 		if (n >= 1*4) __asm__ __volatile__("movsl"
 267:include/asm/string.h **** 			:"=&D"(edi),"=&S"(esi):"0"(edi),"1"(esi):"memory");
 268:include/asm/string.h **** 	}
 269:include/asm/string.h **** 	switch (n % 4) {
 270:include/asm/string.h **** 		/* tail */
 271:include/asm/string.h **** 		case 0: return to;
 272:include/asm/string.h **** 		case 1: __asm__ __volatile__("movsb"
 273:include/asm/string.h **** 			:"=&D"(edi),"=&S"(esi):"0"(edi),"1"(esi):"memory");
 274:include/asm/string.h **** 			return to;
 275:include/asm/string.h **** 		case 2: __asm__ __volatile__("movsw"
 276:include/asm/string.h **** 			:"=&D"(edi),"=&S"(esi):"0"(edi),"1"(esi):"memory");
 277:include/asm/string.h **** 			return to;
 278:include/asm/string.h **** 		default: __asm__ __volatile__("movsw\n\tmovsb"
 279:include/asm/string.h **** 			:"=&D"(edi),"=&S"(esi):"0"(edi),"1"(esi):"memory");
 280:include/asm/string.h **** 			return to;
 281:include/asm/string.h **** 	}
 282:include/asm/string.h **** }
 283:include/asm/string.h **** 
 284:include/asm/string.h **** #define __HAVE_ARCH_MEMCPY
 285:include/asm/string.h **** 
 286:include/asm/string.h **** #ifdef CONFIG_X86_USE_3DNOW
 287:include/asm/string.h **** 
 288:include/asm/string.h **** #include <asm/mmx.h>
 289:include/asm/string.h **** 
 290:include/asm/string.h **** /*
 291:include/asm/string.h ****  *	This CPU favours 3DNow strongly (eg AMD Athlon)
 292:include/asm/string.h ****  */
 293:include/asm/string.h **** 
 294:include/asm/string.h **** static inline void * __constant_memcpy3d(void * to, const void * from, size_t len)
 295:include/asm/string.h **** {
 296:include/asm/string.h **** 	if (len < 512)
 297:include/asm/string.h **** 		return __constant_memcpy(to, from, len);
 298:include/asm/string.h **** 	return _mmx_memcpy(to, from, len);
 299:include/asm/string.h **** }
 300:include/asm/string.h **** 
 301:include/asm/string.h **** static __inline__ void *__memcpy3d(void *to, const void *from, size_t len)
 302:include/asm/string.h **** {
 303:include/asm/string.h **** 	if (len < 512)
 304:include/asm/string.h **** 		return __memcpy(to, from, len);
 305:include/asm/string.h **** 	return _mmx_memcpy(to, from, len);
 306:include/asm/string.h **** }
 307:include/asm/string.h **** 
 308:include/asm/string.h **** #define memcpy(t, f, n) \
 309:include/asm/string.h **** (__builtin_constant_p(n) ? \
 310:include/asm/string.h ****  __constant_memcpy3d((t),(f),(n)) : \
 311:include/asm/string.h ****  __memcpy3d((t),(f),(n)))
 312:include/asm/string.h **** 
 313:include/asm/string.h **** #else
 314:include/asm/string.h **** 
GAS LISTING  			page 32


 315:include/asm/string.h **** /*
 316:include/asm/string.h ****  *	No 3D Now!
 317:include/asm/string.h ****  */
 318:include/asm/string.h ****  
 319:include/asm/string.h **** #define memcpy(t, f, n) \
 320:include/asm/string.h **** (__builtin_constant_p(n) ? \
 321:include/asm/string.h ****  __constant_memcpy((t),(f),(n)) : \
 322:include/asm/string.h ****  __memcpy((t),(f),(n)))
 323:include/asm/string.h **** 
 324:include/asm/string.h **** #endif
 325:include/asm/string.h **** 
 326:include/asm/string.h **** #define __HAVE_ARCH_MEMMOVE
 327:include/asm/string.h **** void *memmove(void * dest,const void * src, size_t n);
 328:include/asm/string.h **** 
 329:include/asm/string.h **** #define memcmp __builtin_memcmp
 330:include/asm/string.h **** 
 331:include/asm/string.h **** #define __HAVE_ARCH_MEMCHR
 332:include/asm/string.h **** static inline void * memchr(const void * cs,int c,size_t count)
 333:include/asm/string.h **** {
 334:include/asm/string.h **** int d0;
 335:include/asm/string.h **** register void * __res;
 336:include/asm/string.h **** if (!count)
 337:include/asm/string.h **** 	return NULL;
 338:include/asm/string.h **** __asm__ __volatile__(
 339:include/asm/string.h **** 	"repne\n\t"
 340:include/asm/string.h **** 	"scasb\n\t"
 341:include/asm/string.h **** 	"je 1f\n\t"
 342:include/asm/string.h **** 	"movl $1,%0\n"
 343:include/asm/string.h **** 	"1:\tdecl %0"
 344:include/asm/string.h **** 	:"=D" (__res), "=&c" (d0)
 345:include/asm/string.h **** 	:"a" (c),"0" (cs),"1" (count)
 346:include/asm/string.h **** 	:"memory");
 347:include/asm/string.h **** return __res;
 348:include/asm/string.h **** }
 349:include/asm/string.h **** 
 350:include/asm/string.h **** static inline void * __memset_generic(void * s, char c,size_t count)
 351:include/asm/string.h **** {
 352:include/asm/string.h **** int d0, d1;
 353:include/asm/string.h **** __asm__ __volatile__(
 354:include/asm/string.h **** 	"rep\n\t"
 355:include/asm/string.h **** 	"stosb"
 356:include/asm/string.h **** 	: "=&c" (d0), "=&D" (d1)
 357:include/asm/string.h **** 	:"a" (c),"1" (s),"0" (count)
 358:include/asm/string.h **** 	:"memory");
 359:include/asm/string.h **** return s;
 360:include/asm/string.h **** }
 361:include/asm/string.h **** 
 362:include/asm/string.h **** /* we might want to write optimized versions of these later */
 363:include/asm/string.h **** #define __constant_count_memset(s,c,count) __memset_generic((s),(c),(count))
 364:include/asm/string.h **** 
 365:include/asm/string.h **** /*
 366:include/asm/string.h ****  * memset(x,0,y) is a reasonably common thing to do, so we want to fill
 367:include/asm/string.h ****  * things 32 bits at a time even when we don't know the size of the
 368:include/asm/string.h ****  * area at compile-time..
 369:include/asm/string.h ****  */
 370:include/asm/string.h **** static inline void * __constant_c_memset(void * s, unsigned long c, size_t count)
 371:include/asm/string.h **** {
GAS LISTING  			page 33


 372:include/asm/string.h **** int d0, d1;
 373:include/asm/string.h **** __asm__ __volatile__(
 374:include/asm/string.h **** 	"rep ; stosl\n\t"
 375:include/asm/string.h **** 	"testb $2,%b3\n\t"
 376:include/asm/string.h **** 	"je 1f\n\t"
 377:include/asm/string.h **** 	"stosw\n"
 378:include/asm/string.h **** 	"1:\ttestb $1,%b3\n\t"
 379:include/asm/string.h **** 	"je 2f\n\t"
 380:include/asm/string.h **** 	"stosb\n"
 381:include/asm/string.h **** 	"2:"
 382:include/asm/string.h **** 	:"=&c" (d0), "=&D" (d1)
 383:include/asm/string.h **** 	:"a" (c), "q" (count), "0" (count/4), "1" ((long) s)
 384:include/asm/string.h **** 	:"memory");
 385:include/asm/string.h **** return (s);	
 386:include/asm/string.h **** }
 387:include/asm/string.h **** 
 388:include/asm/string.h **** /* Added by Gertjan van Wingerde to make minix and sysv module work */
 389:include/asm/string.h **** #define __HAVE_ARCH_STRNLEN
 390:include/asm/string.h **** static inline size_t strnlen(const char * s, size_t count)
 391:include/asm/string.h **** {
 392:include/asm/string.h **** int d0;
 393:include/asm/string.h **** register int __res;
 394:include/asm/string.h **** __asm__ __volatile__(
 395:include/asm/string.h **** 	"movl %2,%0\n\t"
 396:include/asm/string.h **** 	"jmp 2f\n"
 397:include/asm/string.h **** 	"1:\tcmpb $0,(%0)\n\t"
 398:include/asm/string.h **** 	"je 3f\n\t"
 399:include/asm/string.h **** 	"incl %0\n"
 400:include/asm/string.h **** 	"2:\tdecl %1\n\t"
 401:include/asm/string.h **** 	"cmpl $-1,%1\n\t"
 402:include/asm/string.h **** 	"jne 1b\n"
 403:include/asm/string.h **** 	"3:\tsubl %2,%0"
 404:include/asm/string.h **** 	:"=a" (__res), "=&d" (d0)
 405:include/asm/string.h **** 	:"c" (s),"1" (count)
 406:include/asm/string.h **** 	:"memory");
 407:include/asm/string.h **** return __res;
 408:include/asm/string.h **** }
 409:include/asm/string.h **** /* end of additional stuff */
 410:include/asm/string.h **** 
 411:include/asm/string.h **** #define __HAVE_ARCH_STRSTR
 412:include/asm/string.h **** 
 413:include/asm/string.h **** extern char *strstr(const char *cs, const char *ct);
 414:include/asm/string.h **** 
 415:include/asm/string.h **** /*
 416:include/asm/string.h ****  * This looks horribly ugly, but the compiler can optimize it totally,
 417:include/asm/string.h ****  * as we by now know that both pattern and count is constant..
 418:include/asm/string.h ****  */
 419:include/asm/string.h **** static inline void * __constant_c_and_count_memset(void * s, unsigned long pattern, size_t count)
 420:include/asm/string.h **** {
 421:include/asm/string.h **** 	switch (count) {
 422:include/asm/string.h **** 		case 0:
 423:include/asm/string.h **** 			return s;
 424:include/asm/string.h **** 		case 1:
 425:include/asm/string.h **** 			*(unsigned char *)s = pattern;
 426:include/asm/string.h **** 			return s;
 427:include/asm/string.h **** 		case 2:
 428:include/asm/string.h **** 			*(unsigned short *)s = pattern;
GAS LISTING  			page 34


 429:include/asm/string.h **** 			return s;
 430:include/asm/string.h **** 		case 3:
 431:include/asm/string.h **** 			*(unsigned short *)s = pattern;
 432:include/asm/string.h **** 			*(2+(unsigned char *)s) = pattern;
 433:include/asm/string.h **** 			return s;
 434:include/asm/string.h **** 		case 4:
 435:include/asm/string.h **** 			*(unsigned long *)s = pattern;
 436:include/asm/string.h **** 			return s;
 437:include/asm/string.h **** 	}
 438:include/asm/string.h **** #define COMMON(x) \
 439:include/asm/string.h **** __asm__  __volatile__( \
 440:include/asm/string.h **** 	"rep ; stosl" \
 441:include/asm/string.h **** 	x \
 442:include/asm/string.h **** 	: "=&c" (d0), "=&D" (d1) \
 443:include/asm/string.h **** 	: "a" (pattern),"0" (count/4),"1" ((long) s) \
 444:include/asm/string.h **** 	: "memory")
 445:include/asm/string.h **** {
 446:include/asm/string.h **** 	int d0, d1;
 447:include/asm/string.h **** 	switch (count % 4) {
 448:include/asm/string.h **** 		case 0: COMMON(""); return s;
 114              	.loc 4 448 0
 115 003b 89C7     	movl %eax,%edi
 116 003d B9240000 	movl $36,%ecx
 116      00
 117 0042 89F0     	movl %esi,%eax
 118              	
 119 0044 F3AB     	rep
 120              	
 121              	.LBE12:
 122              	.LBE11:
 123              	.LBE10:
 124              	.LBE3:
 125              	.LBE2:
  81:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_tkip_data *priv;
  82:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  83:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	priv = kzalloc(sizeof(*priv), GFP_ATOMIC);
  84:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (priv == NULL)
  85:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		goto fail;
  86:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  87:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	priv->key_idx = key_idx;
 126              	.loc 1 87 0
 127 0046 8B442414 	movl 20(%esp),%eax
 128 004a 894360   	movl %eax,96(%ebx)
  88:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  89:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	priv->tfm_arc4 = crypto_alloc_tfm("arc4", 0);
 129              	.loc 1 89 0
 130 004d 6A00     	pushl $0
 131              	.LCFI9:
 132 004f 68000000 	pushl $.LC0
 132      00
 133              	.LCFI10:
 134              	.LCFI11:
 135 0054 E8FCFFFF 	call crypto_alloc_tfm
 135      FF
 136 0059 894364   	movl %eax,100(%ebx)
  90:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (priv->tfm_arc4 == NULL) {
 137              	.loc 1 90 0
GAS LISTING  			page 35


 138 005c 5E       	popl %esi
 139              	.LCFI12:
 140 005d 85C0     	testl %eax,%eax
 141 005f 5F       	popl %edi
 142              	.LCFI13:
 143 0060 7507     	jne .L55
  91:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		printk(KERN_DEBUG "ieee80211_crypt_tkip: could not allocate "
 144              	.loc 1 91 0
 145 0062 68050000 	pushl $.LC1
 145      00
 146              	.LCFI14:
 147 0067 EB1C     	jmp .L60
 148              	.LCFI15:
 149              	.L55:
  92:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		       "crypto API arc4\n");
  93:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		goto fail;
  94:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
  95:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
  96:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	priv->tfm_michael = crypto_alloc_tfm("michael_mic", 0);
 150              	.loc 1 96 0
 151 0069 6A00     	pushl $0
 152              	.LCFI16:
 153 006b 68420000 	pushl $.LC2
 153      00
 154              	.LCFI17:
 155 0070 E8FCFFFF 	call crypto_alloc_tfm
 155      FF
 156 0075 894368   	movl %eax,104(%ebx)
  97:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (priv->tfm_michael == NULL) {
 157              	.loc 1 97 0
 158 0078 5A       	popl %edx
 159              	.LCFI18:
 160 0079 85C0     	testl %eax,%eax
 161 007b 59       	popl %ecx
 162              	.LCFI19:
  98:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		printk(KERN_DEBUG "ieee80211_crypt_tkip: could not allocate "
  99:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		       "crypto API michael_mic\n");
 100:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		goto fail;
 101:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 102:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 103:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return priv;
 163              	.loc 1 103 0
 164 007c 89DA     	movl %ebx,%edx
 165              	.loc 1 97 0
 166 007e 7534     	jne .L3
 167              	.loc 1 98 0
 168 0080 684E0000 	pushl $.LC3
 168      00
 169              	.LCFI20:
 170              	.L60:
 171              	.L54:
 172 0085 E8FCFFFF 	call printk
 172      FF
 104:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 105:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c ****       fail:
 106:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (priv) {
 173              	.loc 1 106 0
GAS LISTING  			page 36


 174 008a 85DB     	testl %ebx,%ebx
 175              	.loc 1 100 0
 176 008c 58       	popl %eax
 177              	.LCFI21:
 178              	.loc 1 106 0
 179 008d 7423     	je .L57
 107:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		if (priv->tfm_michael)
 180              	.loc 1 107 0
 181 008f 8B4368   	movl 104(%ebx),%eax
 182 0092 85C0     	testl %eax,%eax
 183 0094 7407     	je .L58
 108:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			crypto_free_tfm(priv->tfm_michael);
 184              	.loc 1 108 0
 185 0096 50       	pushl %eax
 186              	.LCFI22:
 187 0097 E8FCFFFF 	call crypto_free_tfm
 187      FF
 188 009c 5F       	popl %edi
 189              	.LCFI23:
 190              	.L58:
 109:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		if (priv->tfm_arc4)
 191              	.loc 1 109 0
 192 009d 8B4364   	movl 100(%ebx),%eax
 193 00a0 85C0     	testl %eax,%eax
 194 00a2 7407     	je .L59
 110:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			crypto_free_tfm(priv->tfm_arc4);
 195              	.loc 1 110 0
 196 00a4 50       	pushl %eax
 197              	.LCFI24:
 198 00a5 E8FCFFFF 	call crypto_free_tfm
 198      FF
 199 00aa 5E       	popl %esi
 200              	.LCFI25:
 201              	.L59:
 111:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		kfree(priv);
 202              	.loc 1 111 0
 203 00ab 53       	pushl %ebx
 204              	.LCFI26:
 205 00ac E8FCFFFF 	call kfree
 205      FF
 206 00b1 59       	popl %ecx
 207              	.LCFI27:
 208              	.L57:
 112:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 113:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 114:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return NULL;
 209              	.loc 1 114 0
 210 00b2 31D2     	xorl %edx,%edx
 211              	.L3:
 115:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 212              	.loc 1 115 0
 213 00b4 89D0     	movl %edx,%eax
 214 00b6 5A       	popl %edx
 215              	.LCFI28:
 216 00b7 5B       	popl %ebx
 217 00b8 5E       	popl %esi
 218 00b9 5F       	popl %edi
GAS LISTING  			page 37


 219 00ba C3       	ret
 220              	.LFE689:
 223              	ieee80211_tkip_deinit:
 224              	.LFB690:
 116:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 117:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static void ieee80211_tkip_deinit(void *priv)
 118:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 225              	.loc 1 118 0
 226 00bb 53       	pushl %ebx
 227              	.LCFI29:
 228              	.loc 1 118 0
 229 00bc 8B5C2408 	movl 8(%esp),%ebx
 119:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_tkip_data *_priv = priv;
 120:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (_priv && _priv->tfm_michael)
 230              	.loc 1 120 0
 231 00c0 85DB     	testl %ebx,%ebx
 232 00c2 741C     	je .L63
 233 00c4 8B4368   	movl 104(%ebx),%eax
 234 00c7 85C0     	testl %eax,%eax
 235 00c9 7407     	je .L62
 121:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		crypto_free_tfm(_priv->tfm_michael);
 236              	.loc 1 121 0
 237 00cb 50       	pushl %eax
 238              	.LCFI30:
 239 00cc E8FCFFFF 	call crypto_free_tfm
 239      FF
 240 00d1 58       	popl %eax
 241              	.LCFI31:
 242              	.L62:
 122:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (_priv && _priv->tfm_arc4)
 243              	.loc 1 122 0
 244 00d2 8B4364   	movl 100(%ebx),%eax
 245 00d5 85C0     	testl %eax,%eax
 246 00d7 7407     	je .L63
 123:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		crypto_free_tfm(_priv->tfm_arc4);
 247              	.loc 1 123 0
 248 00d9 50       	pushl %eax
 249              	.LCFI32:
 250 00da E8FCFFFF 	call crypto_free_tfm
 250      FF
 251 00df 58       	popl %eax
 252              	.LCFI33:
 253              	.L63:
 124:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	kfree(priv);
 254              	.loc 1 124 0
 255 00e0 895C2408 	movl %ebx,8(%esp)
 256 00e4 5B       	popl %ebx
 257              	.LCFI34:
 258 00e5 E9FCFFFF 	jmp kfree
 258      FF
 259              	.LFE690:
 261              	.section .rodata
 262              	.align 32
 265              	Sbox:
 522              	.text
 524              	tkip_mixing_phase1:
 525              	.LFB699:
GAS LISTING  			page 38


 125:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 126:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 127:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static inline u16 RotR1(u16 val)
 128:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 129:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return (val >> 1) | (val << 15);
 130:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 131:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 132:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static inline u8 Lo8(u16 val)
 133:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 134:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return val & 0xff;
 135:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 136:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 137:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static inline u8 Hi8(u16 val)
 138:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 139:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return val >> 8;
 140:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 141:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 142:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static inline u16 Lo16(u32 val)
 143:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 144:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return val & 0xffff;
 145:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 146:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 147:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static inline u16 Hi16(u32 val)
 148:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 149:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return val >> 16;
 150:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 151:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 152:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static inline u16 Mk16(u8 hi, u8 lo)
 153:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 154:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return lo | (((u16) hi) << 8);
 155:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 156:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 157:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static inline u16 Mk16_le(u16 * v)
 158:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 159:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return le16_to_cpu(*v);
 160:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 161:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 162:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static const u16 Sbox[256] = {
 163:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xC6A5, 0xF884, 0xEE99, 0xF68D, 0xFF0D, 0xD6BD, 0xDEB1, 0x9154,
 164:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x6050, 0x0203, 0xCEA9, 0x567D, 0xE719, 0xB562, 0x4DE6, 0xEC9A,
 165:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x8F45, 0x1F9D, 0x8940, 0xFA87, 0xEF15, 0xB2EB, 0x8EC9, 0xFB0B,
 166:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x41EC, 0xB367, 0x5FFD, 0x45EA, 0x23BF, 0x53F7, 0xE496, 0x9B5B,
 167:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x75C2, 0xE11C, 0x3DAE, 0x4C6A, 0x6C5A, 0x7E41, 0xF502, 0x834F,
 168:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x685C, 0x51F4, 0xD134, 0xF908, 0xE293, 0xAB73, 0x6253, 0x2A3F,
 169:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x080C, 0x9552, 0x4665, 0x9D5E, 0x3028, 0x37A1, 0x0A0F, 0x2FB5,
 170:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x0E09, 0x2436, 0x1B9B, 0xDF3D, 0xCD26, 0x4E69, 0x7FCD, 0xEA9F,
 171:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x121B, 0x1D9E, 0x5874, 0x342E, 0x362D, 0xDCB2, 0xB4EE, 0x5BFB,
 172:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xA4F6, 0x764D, 0xB761, 0x7DCE, 0x527B, 0xDD3E, 0x5E71, 0x1397,
 173:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xA6F5, 0xB968, 0x0000, 0xC12C, 0x4060, 0xE31F, 0x79C8, 0xB6ED,
 174:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xD4BE, 0x8D46, 0x67D9, 0x724B, 0x94DE, 0x98D4, 0xB0E8, 0x854A,
 175:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xBB6B, 0xC52A, 0x4FE5, 0xED16, 0x86C5, 0x9AD7, 0x6655, 0x1194,
 176:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x8ACF, 0xE910, 0x0406, 0xFE81, 0xA0F0, 0x7844, 0x25BA, 0x4BE3,
 177:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xA2F3, 0x5DFE, 0x80C0, 0x058A, 0x3FAD, 0x21BC, 0x7048, 0xF104,
 178:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x63DF, 0x77C1, 0xAF75, 0x4263, 0x2030, 0xE51A, 0xFD0E, 0xBF6D,
 179:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x814C, 0x1814, 0x2635, 0xC32F, 0xBEE1, 0x35A2, 0x88CC, 0x2E39,
 180:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x9357, 0x55F2, 0xFC82, 0x7A47, 0xC8AC, 0xBAE7, 0x322B, 0xE695,
 181:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xC0A0, 0x1998, 0x9ED1, 0xA37F, 0x4466, 0x547E, 0x3BAB, 0x0B83,
GAS LISTING  			page 39


 182:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x8CCA, 0xC729, 0x6BD3, 0x283C, 0xA779, 0xBCE2, 0x161D, 0xAD76,
 183:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xDB3B, 0x6456, 0x744E, 0x141E, 0x92DB, 0x0C0A, 0x486C, 0xB8E4,
 184:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x9F5D, 0xBD6E, 0x43EF, 0xC4A6, 0x39A8, 0x31A4, 0xD337, 0xF28B,
 185:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xD532, 0x8B43, 0x6E59, 0xDAB7, 0x018C, 0xB164, 0x9CD2, 0x49E0,
 186:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xD8B4, 0xACFA, 0xF307, 0xCF25, 0xCAAF, 0xF48E, 0x47E9, 0x1018,
 187:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x6FD5, 0xF088, 0x4A6F, 0x5C72, 0x3824, 0x57F1, 0x73C7, 0x9751,
 188:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xCB23, 0xA17C, 0xE89C, 0x3E21, 0x96DD, 0x61DC, 0x0D86, 0x0F85,
 189:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xE090, 0x7C42, 0x71C4, 0xCCAA, 0x90D8, 0x0605, 0xF701, 0x1C12,
 190:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xC2A3, 0x6A5F, 0xAEF9, 0x69D0, 0x1791, 0x9958, 0x3A27, 0x27B9,
 191:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0xD938, 0xEB13, 0x2BB3, 0x2233, 0xD2BB, 0xA970, 0x0789, 0x33A7,
 192:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x2DB6, 0x3C22, 0x1592, 0xC920, 0x8749, 0xAAFF, 0x5078, 0xA57A,
 193:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x038F, 0x59F8, 0x0980, 0x1A17, 0x65DA, 0xD731, 0x84C6, 0xD0B8,
 194:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	0x82C3, 0x29B0, 0x5A77, 0x1E11, 0x7BCB, 0xA8FC, 0x6DD6, 0x2C3A,
 195:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** };
 196:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 197:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static inline u16 _S_(u16 v)
 198:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 199:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u16 t = Sbox[Hi8(v)];
 200:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return Sbox[Lo8(v)] ^ ((t << 8) | (t >> 8));
 201:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 202:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 203:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #define PHASE1_LOOP_COUNT 8
 204:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 205:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static void tkip_mixing_phase1(u16 * TTAK, const u8 * TK, const u8 * TA,
 206:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       u32 IV32)
 207:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 526              	.loc 1 207 0
 527 00ea 55       	pushl %ebp
 528              	.LCFI35:
 529 00eb 57       	pushl %edi
 530              	.LCFI36:
 531 00ec 56       	pushl %esi
 532              	.LCFI37:
 533 00ed 53       	pushl %ebx
 534              	.LCFI38:
 535              	.loc 1 207 0
 536 00ee 8B442420 	movl 32(%esp),%eax
 537 00f2 8B7C2414 	movl 20(%esp),%edi
 538 00f6 8B4C241C 	movl 28(%esp),%ecx
 539 00fa 8B6C2418 	movl 24(%esp),%ebp
 540              	.loc 1 143 0
 541 00fe 668907   	movw %ax,(%edi)
 542              	.LBB13:
 543              	.LBB14:
 544              	.loc 1 149 0
 545 0101 C1E810   	shrl $16,%eax
 546              	.LBE14:
 547              	.LBE13:
 548              	.loc 1 148 0
 549 0104 66894702 	movw %ax,2(%edi)
 550              	.LBB15:
 551              	.LBB16:
 552              	.loc 1 154 0
 553 0108 0FB65101 	movzbl 1(%ecx),%edx
 554 010c 0FB601   	movzbl (%ecx),%eax
 555 010f C1E208   	sall $8,%edx
 556 0112 09D0     	orl %edx,%eax
GAS LISTING  			page 40


 557              	.LBE16:
 558              	.LBE15:
 559              	.loc 1 153 0
 560 0114 66894704 	movw %ax,4(%edi)
 561              	.LBB17:
 562              	.LBB18:
 563              	.loc 1 154 0
 564 0118 0FB65103 	movzbl 3(%ecx),%edx
 565 011c 0FB64102 	movzbl 2(%ecx),%eax
 566 0120 C1E208   	sall $8,%edx
 567 0123 09D0     	orl %edx,%eax
 568              	.LBE18:
 569              	.LBE17:
 570              	.loc 1 153 0
 571 0125 66894706 	movw %ax,6(%edi)
 572              	.LBB19:
 573              	.LBB20:
 574              	.loc 1 154 0
 575 0129 0FB65105 	movzbl 5(%ecx),%edx
 576 012d 0FB64104 	movzbl 4(%ecx),%eax
 577 0131 C1E208   	sall $8,%edx
 578 0134 09D0     	orl %edx,%eax
 579              	.LBE20:
 580              	.LBE19:
 581              	.loc 1 153 0
 582 0136 66894708 	movw %ax,8(%edi)
 208:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	int i, j;
 209:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 210:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	/* Initialize the 80-bit TTAK from TSC (IV32) and TA[0..5] */
 211:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	TTAK[0] = Lo16(IV32);
 212:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	TTAK[1] = Hi16(IV32);
 213:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	TTAK[2] = Mk16(TA[1], TA[0]);
 214:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	TTAK[3] = Mk16(TA[3], TA[2]);
 215:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	TTAK[4] = Mk16(TA[5], TA[4]);
 216:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 217:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	for (i = 0; i < PHASE1_LOOP_COUNT; i++) {
 583              	.loc 1 217 0
 584 013a 31F6     	xorl %esi,%esi
 585              	.L93:
 218:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		j = 2 * (i & 1);
 586              	.loc 1 218 0
 587 013c 89F3     	movl %esi,%ebx
 588 013e 83E301   	andl $1,%ebx
 589 0141 D1E3     	sall %ebx
 590              	.LBB21:
 591              	.LBB22:
 592              	.LBB23:
 593              	.loc 1 154 0
 594 0143 0FB6441D 	movzbl 1(%ebp,%ebx),%eax
 594      01
 595 0148 0FB6541D 	movzbl (%ebp,%ebx),%edx
 595      00
 596 014d C1E008   	sall $8,%eax
 597 0150 09C2     	orl %eax,%edx
 598              	.LBE23:
 599              	.LBE22:
 600              	.loc 1 153 0
GAS LISTING  			page 41


 601 0152 668B4F08 	movw 8(%edi),%cx
 602 0156 31D1     	xorl %edx,%ecx
 603              	.LBB24:
 604              	.loc 1 138 0
 605 0158 0FB6C5   	movzbl %ch,%eax
 606 015b 668B9400 	movw Sbox(%eax,%eax),%dx
 606      00000000 
 607              	.loc 1 133 0
 608 0163 0FB7C2   	movzwl %dx,%eax
 609 0166 C1E008   	sall $8,%eax
 610 0169 66C1EA08 	shrw $8,%dx
 611 016d 09C2     	orl %eax,%edx
 612 016f 0FB6C9   	movzbl %cl,%ecx
 613 0172 66339409 	xorw Sbox(%ecx,%ecx),%dx
 613      00000000 
 614              	.LBE24:
 615              	.LBE21:
 616              	.loc 1 155 0
 617 017a 660317   	addw (%edi),%dx
 618 017d 668917   	movw %dx,(%edi)
 619              	.LBB25:
 620              	.LBB26:
 621              	.LBB27:
 622              	.loc 1 154 0
 623 0180 0FB64C1D 	movzbl 5(%ebp,%ebx),%ecx
 623      05
 624 0185 0FB6441D 	movzbl 4(%ebp,%ebx),%eax
 624      04
 625 018a C1E108   	sall $8,%ecx
 626 018d 09C8     	orl %ecx,%eax
 627              	.LBE27:
 628              	.LBE26:
 629              	.loc 1 153 0
 630 018f 31C2     	xorl %eax,%edx
 631              	.LBB28:
 632              	.loc 1 138 0
 633 0191 0FB6C6   	movzbl %dh,%eax
 634 0194 668B8C00 	movw Sbox(%eax,%eax),%cx
 634      00000000 
 635              	.loc 1 133 0
 636 019c 0FB7C1   	movzwl %cx,%eax
 637 019f C1E008   	sall $8,%eax
 638 01a2 66C1E908 	shrw $8,%cx
 639 01a6 09C1     	orl %eax,%ecx
 640 01a8 0FB6D2   	movzbl %dl,%edx
 641 01ab 66338C12 	xorw Sbox(%edx,%edx),%cx
 641      00000000 
 642              	.LBE28:
 643              	.LBE25:
 644              	.loc 1 155 0
 645 01b3 66034F02 	addw 2(%edi),%cx
 646 01b7 66894F02 	movw %cx,2(%edi)
 647              	.LBB29:
 648              	.LBB30:
 649              	.LBB31:
 650              	.loc 1 154 0
 651 01bb 0FB6541D 	movzbl 9(%ebp,%ebx),%edx
GAS LISTING  			page 42


 651      09
 652 01c0 0FB6441D 	movzbl 8(%ebp,%ebx),%eax
 652      08
 653 01c5 C1E208   	sall $8,%edx
 654 01c8 09D0     	orl %edx,%eax
 655              	.LBE31:
 656              	.LBE30:
 657              	.loc 1 153 0
 658 01ca 31C1     	xorl %eax,%ecx
 659              	.LBB32:
 660              	.loc 1 138 0
 661 01cc 0FB6C5   	movzbl %ch,%eax
 662 01cf 668B9400 	movw Sbox(%eax,%eax),%dx
 662      00000000 
 663              	.loc 1 133 0
 664 01d7 0FB7C2   	movzwl %dx,%eax
 665 01da C1E008   	sall $8,%eax
 666 01dd 66C1EA08 	shrw $8,%dx
 667 01e1 09C2     	orl %eax,%edx
 668 01e3 0FB6C9   	movzbl %cl,%ecx
 669 01e6 66339409 	xorw Sbox(%ecx,%ecx),%dx
 669      00000000 
 670              	.LBE32:
 671              	.LBE29:
 672              	.loc 1 155 0
 673 01ee 66035704 	addw 4(%edi),%dx
 674 01f2 66895704 	movw %dx,4(%edi)
 675              	.LBB33:
 676              	.LBB34:
 677              	.LBB35:
 678              	.loc 1 154 0
 679 01f6 0FB64C1D 	movzbl 13(%ebp,%ebx),%ecx
 679      0D
 680 01fb C1E108   	sall $8,%ecx
 681 01fe 0FB6441D 	movzbl 12(%ebp,%ebx),%eax
 681      0C
 682 0203 09C8     	orl %ecx,%eax
 683              	.LBE35:
 684              	.LBE34:
 685              	.loc 1 153 0
 686 0205 31C2     	xorl %eax,%edx
 687              	.LBB36:
 688              	.loc 1 138 0
 689 0207 0FB6C6   	movzbl %dh,%eax
 690 020a 668B8C00 	movw Sbox(%eax,%eax),%cx
 690      00000000 
 691              	.loc 1 133 0
 692 0212 0FB7C1   	movzwl %cx,%eax
 693 0215 C1E008   	sall $8,%eax
 694 0218 66C1E908 	shrw $8,%cx
 695 021c 09C1     	orl %eax,%ecx
 696 021e 0FB6D2   	movzbl %dl,%edx
 697 0221 66338C12 	xorw Sbox(%edx,%edx),%cx
 697      00000000 
 698              	.LBE36:
 699              	.LBE33:
 700              	.loc 1 155 0
GAS LISTING  			page 43


 701 0229 66034F06 	addw 6(%edi),%cx
 702 022d 66894F06 	movw %cx,6(%edi)
 703              	.LBB37:
 704              	.LBB38:
 705              	.LBB39:
 706              	.loc 1 154 0
 707 0231 0FB6541D 	movzbl 1(%ebp,%ebx),%edx
 707      01
 708 0236 C1E208   	sall $8,%edx
 709 0239 0FB6441D 	movzbl (%ebp,%ebx),%eax
 709      00
 710 023e 09D0     	orl %edx,%eax
 711              	.LBE39:
 712              	.LBE38:
 713              	.loc 1 153 0
 714 0240 31C1     	xorl %eax,%ecx
 715              	.LBB40:
 716              	.loc 1 138 0
 717 0242 0FB6C5   	movzbl %ch,%eax
 718 0245 668B8400 	movw Sbox(%eax,%eax),%ax
 718      00000000 
 719              	.loc 1 133 0
 720 024d 0FB7D0   	movzwl %ax,%edx
 721 0250 C1E208   	sall $8,%edx
 722 0253 66C1E808 	shrw $8,%ax
 723 0257 09D0     	orl %edx,%eax
 724 0259 0FB6C9   	movzbl %cl,%ecx
 725 025c 66338409 	xorw Sbox(%ecx,%ecx),%ax
 725      00000000 
 726              	.LBE40:
 727              	.LBE37:
 728              	.loc 1 155 0
 729 0264 01F0     	addl %esi,%eax
 730              	.loc 1 217 0
 731 0266 46       	incl %esi
 732              	.loc 1 155 0
 733 0267 66034708 	addw 8(%edi),%ax
 734              	.loc 1 217 0
 735 026b 83FE07   	cmpl $7,%esi
 736              	.loc 1 155 0
 737 026e 66894708 	movw %ax,8(%edi)
 738              	.loc 1 217 0
 739 0272 0F8EC4FE 	jle .L93
 739      FFFF
 740 0278 5B       	popl %ebx
 741 0279 5E       	popl %esi
 742 027a 5F       	popl %edi
 743 027b 5D       	popl %ebp
 744 027c C3       	ret
 745              	.LFE699:
 748              	tkip_mixing_phase2:
 749              	.LFB700:
 219:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		TTAK[0] += _S_(TTAK[4] ^ Mk16(TK[1 + j], TK[0 + j]));
 220:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		TTAK[1] += _S_(TTAK[0] ^ Mk16(TK[5 + j], TK[4 + j]));
 221:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		TTAK[2] += _S_(TTAK[1] ^ Mk16(TK[9 + j], TK[8 + j]));
 222:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		TTAK[3] += _S_(TTAK[2] ^ Mk16(TK[13 + j], TK[12 + j]));
 223:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		TTAK[4] += _S_(TTAK[3] ^ Mk16(TK[1 + j], TK[0 + j])) + i;
GAS LISTING  			page 44


 224:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 225:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 226:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 227:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static void tkip_mixing_phase2(u8 * WEPSeed, const u8 * TK, const u16 * TTAK,
 228:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       u16 IV16)
 229:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 750              	.loc 1 229 0
 751 027d 55       	pushl %ebp
 752              	.LCFI39:
 753 027e 57       	pushl %edi
 754              	.LCFI40:
 755 027f 56       	pushl %esi
 756              	.LCFI41:
 757 0280 53       	pushl %ebx
 758              	.LCFI42:
 759              	.loc 1 229 0
 760 0281 8B54241C 	movl 28(%esp),%edx
 761 0285 8B7C2414 	movl 20(%esp),%edi
 230:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	/* Make temporary area overlap WEP seed so that the final copy can be
 231:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	 * avoided on little endian hosts. */
 232:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u16 *PPK = (u16 *) & WEPSeed[4];
 233:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 234:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	/* Step 1 - make copy of TTAK and bring in TSC */
 235:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[0] = TTAK[0];
 762              	.loc 1 235 0
 763 0289 668B02   	movw (%edx),%ax
 764              	.loc 1 229 0
 765 028c 8B6C2418 	movl 24(%esp),%ebp
 766              	.loc 1 235 0
 767 0290 66894704 	movw %ax,4(%edi)
 768              	.loc 1 232 0
 769 0294 8D5F04   	leal 4(%edi),%ebx
 236:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[1] = TTAK[1];
 770              	.loc 1 236 0
 771 0297 668B4202 	movw 2(%edx),%ax
 772 029b 66894302 	movw %ax,2(%ebx)
 237:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[2] = TTAK[2];
 773              	.loc 1 237 0
 774 029f 668B4204 	movw 4(%edx),%ax
 775 02a3 66894304 	movw %ax,4(%ebx)
 238:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[3] = TTAK[3];
 776              	.loc 1 238 0
 777 02a7 668B4206 	movw 6(%edx),%ax
 778 02ab 66894306 	movw %ax,6(%ebx)
 239:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[4] = TTAK[4];
 779              	.loc 1 239 0
 780 02af 668B4208 	movw 8(%edx),%ax
 781 02b3 66894308 	movw %ax,8(%ebx)
 240:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[5] = TTAK[4] + IV16;
 782              	.loc 1 240 0
 783 02b7 8B442420 	movl 32(%esp),%eax
 784 02bb 66034208 	addw 8(%edx),%ax
 785 02bf 6689430A 	movw %ax,10(%ebx)
 786              	.LBB41:
 787              	.loc 1 158 0
 788 02c3 668B4D00 	movw (%ebp),%cx
 789 02c7 31C1     	xorl %eax,%ecx
GAS LISTING  			page 45


 790              	.LBB42:
 791              	.loc 1 138 0
 792 02c9 BE000000 	movl $Sbox,%esi
 792      00
 793 02ce 0FB6C5   	movzbl %ch,%eax
 794 02d1 668B0446 	movw (%esi,%eax,2),%ax
 795              	.loc 1 133 0
 796 02d5 0FB7D0   	movzwl %ax,%edx
 797 02d8 C1E208   	sall $8,%edx
 798 02db 66C1E808 	shrw $8,%ax
 799 02df 09D0     	orl %edx,%eax
 800 02e1 0FB6C9   	movzbl %cl,%ecx
 801 02e4 6633044E 	xorw (%esi,%ecx,2),%ax
 802              	.LBE42:
 803              	.LBE41:
 804              	.loc 1 160 0
 805 02e8 66034704 	addw 4(%edi),%ax
 806 02ec 66894704 	movw %ax,4(%edi)
 807              	.LBB43:
 808              	.loc 1 158 0
 809 02f0 668B4D02 	movw 2(%ebp),%cx
 810 02f4 31C1     	xorl %eax,%ecx
 811              	.LBB44:
 812              	.loc 1 138 0
 813 02f6 0FB6C5   	movzbl %ch,%eax
 814 02f9 668B0446 	movw (%esi,%eax,2),%ax
 815              	.loc 1 133 0
 816 02fd 0FB7D0   	movzwl %ax,%edx
 817 0300 C1E208   	sall $8,%edx
 818 0303 66C1E808 	shrw $8,%ax
 819 0307 09D0     	orl %edx,%eax
 820 0309 0FB6C9   	movzbl %cl,%ecx
 821 030c 6633044E 	xorw (%esi,%ecx,2),%ax
 822              	.LBE44:
 823              	.LBE43:
 824              	.loc 1 160 0
 825 0310 66034302 	addw 2(%ebx),%ax
 826 0314 66894302 	movw %ax,2(%ebx)
 827              	.LBB45:
 828              	.loc 1 158 0
 829 0318 668B4D04 	movw 4(%ebp),%cx
 830 031c 31C1     	xorl %eax,%ecx
 831              	.LBB46:
 832              	.loc 1 138 0
 833 031e 0FB6C5   	movzbl %ch,%eax
 834 0321 668B0446 	movw (%esi,%eax,2),%ax
 835              	.loc 1 133 0
 836 0325 0FB7D0   	movzwl %ax,%edx
 837 0328 C1E208   	sall $8,%edx
 838 032b 66C1E808 	shrw $8,%ax
 839 032f 09D0     	orl %edx,%eax
 840 0331 0FB6C9   	movzbl %cl,%ecx
 841 0334 6633044E 	xorw (%esi,%ecx,2),%ax
 842              	.LBE46:
 843              	.LBE45:
 844              	.loc 1 160 0
 845 0338 66034304 	addw 4(%ebx),%ax
GAS LISTING  			page 46


 846 033c 66894304 	movw %ax,4(%ebx)
 847              	.LBB47:
 848              	.loc 1 158 0
 849 0340 668B4D06 	movw 6(%ebp),%cx
 850 0344 31C1     	xorl %eax,%ecx
 851              	.LBB48:
 852              	.loc 1 138 0
 853 0346 0FB6C5   	movzbl %ch,%eax
 854 0349 668B0446 	movw (%esi,%eax,2),%ax
 855              	.loc 1 133 0
 856 034d 0FB7D0   	movzwl %ax,%edx
 857 0350 C1E208   	sall $8,%edx
 858 0353 66C1E808 	shrw $8,%ax
 859 0357 09D0     	orl %edx,%eax
 860 0359 0FB6C9   	movzbl %cl,%ecx
 861 035c 6633044E 	xorw (%esi,%ecx,2),%ax
 862              	.LBE48:
 863              	.LBE47:
 864              	.loc 1 160 0
 865 0360 66034306 	addw 6(%ebx),%ax
 866 0364 66894306 	movw %ax,6(%ebx)
 867              	.LBB49:
 868              	.loc 1 158 0
 869 0368 668B4D08 	movw 8(%ebp),%cx
 870 036c 31C1     	xorl %eax,%ecx
 871              	.LBB50:
 872              	.loc 1 138 0
 873 036e 0FB6C5   	movzbl %ch,%eax
 874 0371 668B0446 	movw (%esi,%eax,2),%ax
 875              	.loc 1 133 0
 876 0375 0FB7D0   	movzwl %ax,%edx
 877 0378 C1E208   	sall $8,%edx
 878 037b 66C1E808 	shrw $8,%ax
 879 037f 09D0     	orl %edx,%eax
 880 0381 0FB6C9   	movzbl %cl,%ecx
 881 0384 6633044E 	xorw (%esi,%ecx,2),%ax
 882              	.LBE50:
 883              	.LBE49:
 884              	.loc 1 160 0
 885 0388 66034308 	addw 8(%ebx),%ax
 886 038c 66894308 	movw %ax,8(%ebx)
 887              	.LBB51:
 888              	.loc 1 158 0
 889 0390 668B4D0A 	movw 10(%ebp),%cx
 890 0394 31C1     	xorl %eax,%ecx
 891              	.LBB52:
 892              	.loc 1 138 0
 893 0396 0FB6C5   	movzbl %ch,%eax
 894 0399 668B0446 	movw (%esi,%eax,2),%ax
 895              	.loc 1 133 0
 896 039d 0FB7D0   	movzwl %ax,%edx
 897 03a0 C1E208   	sall $8,%edx
 898 03a3 66C1E808 	shrw $8,%ax
 899 03a7 09D0     	orl %edx,%eax
 900 03a9 0FB6C9   	movzbl %cl,%ecx
 901 03ac 6633044E 	xorw (%esi,%ecx,2),%ax
 902              	.LBE52:
GAS LISTING  			page 47


 903              	.LBE51:
 904              	.loc 1 160 0
 905 03b0 6603430A 	addw 10(%ebx),%ax
 906 03b4 6689430A 	movw %ax,10(%ebx)
 907              	.LBB53:
 908              	.loc 1 158 0
 909 03b8 6633450C 	xorw 12(%ebp),%ax
 910              	.LBB54:
 911              	.loc 1 129 0
 912 03bc 89C2     	movl %eax,%edx
 913 03be 0FB7C0   	movzwl %ax,%eax
 914 03c1 C1E00F   	sall $15,%eax
 915 03c4 66D1EA   	shrw %dx
 916 03c7 09C2     	orl %eax,%edx
 917              	.LBE54:
 918              	.LBE53:
 919              	.loc 1 160 0
 920 03c9 66035704 	addw 4(%edi),%dx
 921 03cd 66895704 	movw %dx,4(%edi)
 922              	.LBB55:
 923              	.loc 1 158 0
 924 03d1 6633550E 	xorw 14(%ebp),%dx
 925              	.LBB56:
 926              	.loc 1 129 0
 927 03d5 89D0     	movl %edx,%eax
 928 03d7 0FB7D2   	movzwl %dx,%edx
 929 03da C1E20F   	sall $15,%edx
 930 03dd 66D1E8   	shrw %ax
 931 03e0 09D0     	orl %edx,%eax
 932              	.LBE56:
 933              	.LBE55:
 934              	.loc 1 160 0
 935 03e2 66034302 	addw 2(%ebx),%ax
 936 03e6 66894302 	movw %ax,2(%ebx)
 937              	.LBB57:
 938              	.LBB58:
 939              	.loc 1 129 0
 940 03ea 89C2     	movl %eax,%edx
 941 03ec 0FB7C0   	movzwl %ax,%eax
 942 03ef C1E00F   	sall $15,%eax
 943 03f2 66D1EA   	shrw %dx
 944 03f5 09C2     	orl %eax,%edx
 945              	.LBE58:
 946              	.LBE57:
 947              	.loc 1 128 0
 948 03f7 66035304 	addw 4(%ebx),%dx
 949 03fb 66895304 	movw %dx,4(%ebx)
 950              	.LBB59:
 951              	.LBB60:
 952              	.loc 1 129 0
 953 03ff 89D0     	movl %edx,%eax
 954 0401 0FB7D2   	movzwl %dx,%edx
 955 0404 C1E20F   	sall $15,%edx
 956 0407 66D1E8   	shrw %ax
 957 040a 09D0     	orl %edx,%eax
 958              	.LBE60:
 959              	.LBE59:
GAS LISTING  			page 48


 960              	.loc 1 128 0
 961 040c 66034306 	addw 6(%ebx),%ax
 962 0410 66894306 	movw %ax,6(%ebx)
 963              	.LBB61:
 964              	.LBB62:
 965              	.loc 1 129 0
 966 0414 89C2     	movl %eax,%edx
 967 0416 0FB7C0   	movzwl %ax,%eax
 968 0419 C1E00F   	sall $15,%eax
 969 041c 66D1EA   	shrw %dx
 970 041f 09C2     	orl %eax,%edx
 971              	.LBE62:
 972              	.LBE61:
 973              	.loc 1 128 0
 974 0421 66035308 	addw 8(%ebx),%dx
 975 0425 66895308 	movw %dx,8(%ebx)
 976              	.LBB63:
 977              	.LBB64:
 978              	.loc 1 129 0
 979 0429 89D0     	movl %edx,%eax
 980 042b 0FB7D2   	movzwl %dx,%edx
 981 042e C1E20F   	sall $15,%edx
 982 0431 66D1E8   	shrw %ax
 983 0434 09D0     	orl %edx,%eax
 984              	.LBE64:
 985              	.LBE63:
 986              	.loc 1 128 0
 987 0436 6601430A 	addw %ax,10(%ebx)
 988              	.LBB65:
 989              	.LBB66:
 990              	.loc 1 139 0
 991 043a 8B542420 	movl 32(%esp),%edx
 992 043e 0FB6C6   	movzbl %dh,%eax
 993              	.LBE66:
 994              	.LBE65:
 995              	.loc 1 138 0
 996 0441 8807     	movb %al,(%edi)
 997 0443 83C820   	orl $32,%eax
 998 0446 83E07F   	andl $127,%eax
 999 0449 884701   	movb %al,1(%edi)
 1000              	.loc 1 133 0
 1001 044c 885702   	movb %dl,2(%edi)
 1002              	.LBB67:
 1003              	.loc 1 158 0
 1004 044f 668B430A 	movw 10(%ebx),%ax
 1005 0453 66334500 	xorw (%ebp),%ax
 1006 0457 66D1E8   	shrw %ax
 1007              	.LBE67:
 1008              	.loc 1 160 0
 1009 045a 884703   	movb %al,3(%edi)
 1010 045d 5B       	popl %ebx
 1011 045e 5E       	popl %esi
 1012 045f 5F       	popl %edi
 1013 0460 5D       	popl %ebp
 1014 0461 C3       	ret
 1015              	.LFE700:
 1018              	ieee80211_tkip_hdr:
GAS LISTING  			page 49


 1019              	.LFB701:
 241:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 242:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	/* Step 2 - 96-bit bijective mixing using S-box */
 243:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[0] += _S_(PPK[5] ^ Mk16_le((u16 *) & TK[0]));
 244:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[1] += _S_(PPK[0] ^ Mk16_le((u16 *) & TK[2]));
 245:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[2] += _S_(PPK[1] ^ Mk16_le((u16 *) & TK[4]));
 246:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[3] += _S_(PPK[2] ^ Mk16_le((u16 *) & TK[6]));
 247:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[4] += _S_(PPK[3] ^ Mk16_le((u16 *) & TK[8]));
 248:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[5] += _S_(PPK[4] ^ Mk16_le((u16 *) & TK[10]));
 249:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 250:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[0] += RotR1(PPK[5] ^ Mk16_le((u16 *) & TK[12]));
 251:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[1] += RotR1(PPK[0] ^ Mk16_le((u16 *) & TK[14]));
 252:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[2] += RotR1(PPK[1]);
 253:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[3] += RotR1(PPK[2]);
 254:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[4] += RotR1(PPK[3]);
 255:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	PPK[5] += RotR1(PPK[4]);
 256:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 257:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	/* Step 3 - bring in last of TK bits, assign 24-bit WEP IV value
 258:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	 * WEPSeed[0..2] is transmitted as WEP IV */
 259:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	WEPSeed[0] = Hi8(IV16);
 260:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	WEPSeed[1] = (Hi8(IV16) | 0x20) & 0x7F;
 261:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	WEPSeed[2] = Lo8(IV16);
 262:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	WEPSeed[3] = Lo8((PPK[5] ^ Mk16_le((u16 *) & TK[0])) >> 1);
 263:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 264:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #ifdef __BIG_ENDIAN
 265:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	{
 266:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		int i;
 267:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		for (i = 0; i < 6; i++)
 268:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			PPK[i] = (PPK[i] << 8) | (PPK[i] >> 8);
 269:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 270:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #endif
 271:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 272:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 273:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static int ieee80211_tkip_hdr(struct sk_buff *skb, int hdr_len,
 274:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			      u8 * rc4key, int keylen, void *priv)
 275:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 1020              	.loc 1 275 0
 1021 0462 55       	pushl %ebp
 1022              	.LCFI43:
 1023 0463 57       	pushl %edi
 1024              	.LCFI44:
 1025 0464 56       	pushl %esi
 1026              	.LCFI45:
 1027 0465 53       	pushl %ebx
 1028              	.LCFI46:
 1029              	.loc 1 275 0
 1030 0466 8B5C2414 	movl 20(%esp),%ebx
 276:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_tkip_data *tkey = priv;
 277:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	int len;
 278:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u8 *pos;
 279:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_hdr_4addr *hdr;
 280:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 281:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	hdr = (struct ieee80211_hdr_4addr *)skb->data;
 1031              	.loc 1 281 0
 1032 046a 8B93A800 	movl 168(%ebx),%edx
 1032      0000
 1033              	.LBB68:
GAS LISTING  			page 50


 1034              	.LBB69:
 1035              	.file 5 "include/linux/skbuff.h"
   1:include/linux/skbuff.h **** /*
   2:include/linux/skbuff.h ****  *	Definitions for the 'struct sk_buff' memory handlers.
   3:include/linux/skbuff.h ****  *
   4:include/linux/skbuff.h ****  *	Authors:
   5:include/linux/skbuff.h ****  *		Alan Cox, <gw4pts@gw4pts.ampr.org>
   6:include/linux/skbuff.h ****  *		Florian La Roche, <rzsfl@rz.uni-sb.de>
   7:include/linux/skbuff.h ****  *
   8:include/linux/skbuff.h ****  *	This program is free software; you can redistribute it and/or
   9:include/linux/skbuff.h ****  *	modify it under the terms of the GNU General Public License
  10:include/linux/skbuff.h ****  *	as published by the Free Software Foundation; either version
  11:include/linux/skbuff.h ****  *	2 of the License, or (at your option) any later version.
  12:include/linux/skbuff.h ****  */
  13:include/linux/skbuff.h **** 
  14:include/linux/skbuff.h **** #ifndef _LINUX_SKBUFF_H
  15:include/linux/skbuff.h **** #define _LINUX_SKBUFF_H
  16:include/linux/skbuff.h **** 
  17:include/linux/skbuff.h **** #include <linux/config.h>
  18:include/linux/skbuff.h **** #include <linux/kernel.h>
  19:include/linux/skbuff.h **** #include <linux/compiler.h>
  20:include/linux/skbuff.h **** #include <linux/time.h>
  21:include/linux/skbuff.h **** #include <linux/cache.h>
  22:include/linux/skbuff.h **** 
  23:include/linux/skbuff.h **** #include <asm/atomic.h>
  24:include/linux/skbuff.h **** #include <asm/types.h>
  25:include/linux/skbuff.h **** #include <linux/spinlock.h>
  26:include/linux/skbuff.h **** #include <linux/mm.h>
  27:include/linux/skbuff.h **** #include <linux/highmem.h>
  28:include/linux/skbuff.h **** #include <linux/poll.h>
  29:include/linux/skbuff.h **** #include <linux/net.h>
  30:include/linux/skbuff.h **** #include <net/checksum.h>
  31:include/linux/skbuff.h **** 
  32:include/linux/skbuff.h **** #define HAVE_ALLOC_SKB		/* For the drivers to know */
  33:include/linux/skbuff.h **** #define HAVE_ALIGNABLE_SKB	/* Ditto 8)		   */
  34:include/linux/skbuff.h **** #define SLAB_SKB 		/* Slabified skbuffs 	   */
  35:include/linux/skbuff.h **** 
  36:include/linux/skbuff.h **** #define CHECKSUM_NONE 0
  37:include/linux/skbuff.h **** #define CHECKSUM_HW 1
  38:include/linux/skbuff.h **** #define CHECKSUM_UNNECESSARY 2
  39:include/linux/skbuff.h **** 
  40:include/linux/skbuff.h **** #define SKB_DATA_ALIGN(X)	(((X) + (SMP_CACHE_BYTES - 1)) & \
  41:include/linux/skbuff.h **** 				 ~(SMP_CACHE_BYTES - 1))
  42:include/linux/skbuff.h **** #define SKB_MAX_ORDER(X, ORDER)	(((PAGE_SIZE << (ORDER)) - (X) - \
  43:include/linux/skbuff.h **** 				  sizeof(struct skb_shared_info)) & \
  44:include/linux/skbuff.h **** 				  ~(SMP_CACHE_BYTES - 1))
  45:include/linux/skbuff.h **** #define SKB_MAX_HEAD(X)		(SKB_MAX_ORDER((X), 0))
  46:include/linux/skbuff.h **** #define SKB_MAX_ALLOC		(SKB_MAX_ORDER(0, 2))
  47:include/linux/skbuff.h **** 
  48:include/linux/skbuff.h **** /* A. Checksumming of received packets by device.
  49:include/linux/skbuff.h ****  *
  50:include/linux/skbuff.h ****  *	NONE: device failed to checksum this packet.
  51:include/linux/skbuff.h ****  *		skb->csum is undefined.
  52:include/linux/skbuff.h ****  *
  53:include/linux/skbuff.h ****  *	UNNECESSARY: device parsed packet and wouldbe verified checksum.
  54:include/linux/skbuff.h ****  *		skb->csum is undefined.
  55:include/linux/skbuff.h ****  *	      It is bad option, but, unfortunately, many of vendors do this.
GAS LISTING  			page 51


  56:include/linux/skbuff.h ****  *	      Apparently with secret goal to sell you new device, when you
  57:include/linux/skbuff.h ****  *	      will add new protocol to your host. F.e. IPv6. 8)
  58:include/linux/skbuff.h ****  *
  59:include/linux/skbuff.h ****  *	HW: the most generic way. Device supplied checksum of _all_
  60:include/linux/skbuff.h ****  *	    the packet as seen by netif_rx in skb->csum.
  61:include/linux/skbuff.h ****  *	    NOTE: Even if device supports only some protocols, but
  62:include/linux/skbuff.h ****  *	    is able to produce some skb->csum, it MUST use HW,
  63:include/linux/skbuff.h ****  *	    not UNNECESSARY.
  64:include/linux/skbuff.h ****  *
  65:include/linux/skbuff.h ****  * B. Checksumming on output.
  66:include/linux/skbuff.h ****  *
  67:include/linux/skbuff.h ****  *	NONE: skb is checksummed by protocol or csum is not required.
  68:include/linux/skbuff.h ****  *
  69:include/linux/skbuff.h ****  *	HW: device is required to csum packet as seen by hard_start_xmit
  70:include/linux/skbuff.h ****  *	from skb->h.raw to the end and to record the checksum
  71:include/linux/skbuff.h ****  *	at skb->h.raw+skb->csum.
  72:include/linux/skbuff.h ****  *
  73:include/linux/skbuff.h ****  *	Device must show its capabilities in dev->features, set
  74:include/linux/skbuff.h ****  *	at device setup time.
  75:include/linux/skbuff.h ****  *	NETIF_F_HW_CSUM	- it is clever device, it is able to checksum
  76:include/linux/skbuff.h ****  *			  everything.
  77:include/linux/skbuff.h ****  *	NETIF_F_NO_CSUM - loopback or reliable single hop media.
  78:include/linux/skbuff.h ****  *	NETIF_F_IP_CSUM - device is dumb. It is able to csum only
  79:include/linux/skbuff.h ****  *			  TCP/UDP over IPv4. Sigh. Vendors like this
  80:include/linux/skbuff.h ****  *			  way by an unknown reason. Though, see comment above
  81:include/linux/skbuff.h ****  *			  about CHECKSUM_UNNECESSARY. 8)
  82:include/linux/skbuff.h ****  *
  83:include/linux/skbuff.h ****  *	Any questions? No questions, good. 		--ANK
  84:include/linux/skbuff.h ****  */
  85:include/linux/skbuff.h **** 
  86:include/linux/skbuff.h **** struct net_device;
  87:include/linux/skbuff.h **** 
  88:include/linux/skbuff.h **** #ifdef CONFIG_NETFILTER
  89:include/linux/skbuff.h **** struct nf_conntrack {
  90:include/linux/skbuff.h **** 	atomic_t use;
  91:include/linux/skbuff.h **** 	void (*destroy)(struct nf_conntrack *);
  92:include/linux/skbuff.h **** };
  93:include/linux/skbuff.h **** 
  94:include/linux/skbuff.h **** #ifdef CONFIG_BRIDGE_NETFILTER
  95:include/linux/skbuff.h **** struct nf_bridge_info {
  96:include/linux/skbuff.h **** 	atomic_t use;
  97:include/linux/skbuff.h **** 	struct net_device *physindev;
  98:include/linux/skbuff.h **** 	struct net_device *physoutdev;
  99:include/linux/skbuff.h **** #if defined(CONFIG_VLAN_8021Q) || defined(CONFIG_VLAN_8021Q_MODULE)
 100:include/linux/skbuff.h **** 	struct net_device *netoutdev;
 101:include/linux/skbuff.h **** #endif
 102:include/linux/skbuff.h **** 	unsigned int mask;
 103:include/linux/skbuff.h **** 	unsigned long data[32 / sizeof(unsigned long)];
 104:include/linux/skbuff.h **** };
 105:include/linux/skbuff.h **** #endif
 106:include/linux/skbuff.h **** 
 107:include/linux/skbuff.h **** #endif
 108:include/linux/skbuff.h **** 
 109:include/linux/skbuff.h **** struct sk_buff_head {
 110:include/linux/skbuff.h **** 	/* These two members must be first. */
 111:include/linux/skbuff.h **** 	struct sk_buff	*next;
 112:include/linux/skbuff.h **** 	struct sk_buff	*prev;
GAS LISTING  			page 52


 113:include/linux/skbuff.h **** 
 114:include/linux/skbuff.h **** 	__u32		qlen;
 115:include/linux/skbuff.h **** 	spinlock_t	lock;
 116:include/linux/skbuff.h **** };
 117:include/linux/skbuff.h **** 
 118:include/linux/skbuff.h **** struct sk_buff;
 119:include/linux/skbuff.h **** 
 120:include/linux/skbuff.h **** /* To allow 64K frame to be packed as single skb without frag_list */
 121:include/linux/skbuff.h **** #define MAX_SKB_FRAGS (65536/PAGE_SIZE + 2)
 122:include/linux/skbuff.h **** 
 123:include/linux/skbuff.h **** typedef struct skb_frag_struct skb_frag_t;
 124:include/linux/skbuff.h **** 
 125:include/linux/skbuff.h **** struct skb_frag_struct {
 126:include/linux/skbuff.h **** 	struct page *page;
 127:include/linux/skbuff.h **** 	__u16 page_offset;
 128:include/linux/skbuff.h **** 	__u16 size;
 129:include/linux/skbuff.h **** };
 130:include/linux/skbuff.h **** 
 131:include/linux/skbuff.h **** /* This data is invariant across clones and lives at
 132:include/linux/skbuff.h ****  * the end of the header data, ie. at skb->end.
 133:include/linux/skbuff.h ****  */
 134:include/linux/skbuff.h **** struct skb_shared_info {
 135:include/linux/skbuff.h **** 	atomic_t	dataref;
 136:include/linux/skbuff.h **** 	unsigned int	nr_frags;
 137:include/linux/skbuff.h **** 	unsigned short	tso_size;
 138:include/linux/skbuff.h **** 	unsigned short	tso_segs;
 139:include/linux/skbuff.h **** 	struct sk_buff	*frag_list;
 140:include/linux/skbuff.h **** 	skb_frag_t	frags[MAX_SKB_FRAGS];
 141:include/linux/skbuff.h **** };
 142:include/linux/skbuff.h **** 
 143:include/linux/skbuff.h **** /* We divide dataref into two halves.  The higher 16 bits hold references
 144:include/linux/skbuff.h ****  * to the payload part of skb->data.  The lower 16 bits hold references to
 145:include/linux/skbuff.h ****  * the entire skb->data.  It is up to the users of the skb to agree on
 146:include/linux/skbuff.h ****  * where the payload starts.
 147:include/linux/skbuff.h ****  *
 148:include/linux/skbuff.h ****  * All users must obey the rule that the skb->data reference count must be
 149:include/linux/skbuff.h ****  * greater than or equal to the payload reference count.
 150:include/linux/skbuff.h ****  *
 151:include/linux/skbuff.h ****  * Holding a reference to the payload part means that the user does not
 152:include/linux/skbuff.h ****  * care about modifications to the header part of skb->data.
 153:include/linux/skbuff.h ****  */
 154:include/linux/skbuff.h **** #define SKB_DATAREF_SHIFT 16
 155:include/linux/skbuff.h **** #define SKB_DATAREF_MASK ((1 << SKB_DATAREF_SHIFT) - 1)
 156:include/linux/skbuff.h **** 
 157:include/linux/skbuff.h **** /** 
 158:include/linux/skbuff.h ****  *	struct sk_buff - socket buffer
 159:include/linux/skbuff.h ****  *	@next: Next buffer in list
 160:include/linux/skbuff.h ****  *	@prev: Previous buffer in list
 161:include/linux/skbuff.h ****  *	@list: List we are on
 162:include/linux/skbuff.h ****  *	@sk: Socket we are owned by
 163:include/linux/skbuff.h ****  *	@stamp: Time we arrived
 164:include/linux/skbuff.h ****  *	@dev: Device we arrived on/are leaving by
 165:include/linux/skbuff.h ****  *	@input_dev: Device we arrived on
 166:include/linux/skbuff.h ****  *      @real_dev: The real device we are using
 167:include/linux/skbuff.h ****  *	@h: Transport layer header
 168:include/linux/skbuff.h ****  *	@nh: Network layer header
 169:include/linux/skbuff.h ****  *	@mac: Link layer header
GAS LISTING  			page 53


 170:include/linux/skbuff.h ****  *	@dst: destination entry
 171:include/linux/skbuff.h ****  *	@sp: the security path, used for xfrm
 172:include/linux/skbuff.h ****  *	@cb: Control buffer. Free for use by every layer. Put private vars here
 173:include/linux/skbuff.h ****  *	@len: Length of actual data
 174:include/linux/skbuff.h ****  *	@data_len: Data length
 175:include/linux/skbuff.h ****  *	@mac_len: Length of link layer header
 176:include/linux/skbuff.h ****  *	@csum: Checksum
 177:include/linux/skbuff.h ****  *	@local_df: allow local fragmentation
 178:include/linux/skbuff.h ****  *	@cloned: Head may be cloned (check refcnt to be sure)
 179:include/linux/skbuff.h ****  *	@nohdr: Payload reference only, must not modify header
 180:include/linux/skbuff.h ****  *	@pkt_type: Packet class
 181:include/linux/skbuff.h ****  *	@ip_summed: Driver fed us an IP checksum
 182:include/linux/skbuff.h ****  *	@priority: Packet queueing priority
 183:include/linux/skbuff.h ****  *	@users: User count - see {datagram,tcp}.c
 184:include/linux/skbuff.h ****  *	@protocol: Packet protocol from driver
 185:include/linux/skbuff.h ****  *	@security: Security level of packet
 186:include/linux/skbuff.h ****  *	@truesize: Buffer size 
 187:include/linux/skbuff.h ****  *	@head: Head of buffer
 188:include/linux/skbuff.h ****  *	@data: Data head pointer
 189:include/linux/skbuff.h ****  *	@tail: Tail pointer
 190:include/linux/skbuff.h ****  *	@end: End pointer
 191:include/linux/skbuff.h ****  *	@destructor: Destruct function
 192:include/linux/skbuff.h ****  *	@nfmark: Can be used for communication between hooks
 193:include/linux/skbuff.h ****  *	@nfcache: Cache info
 194:include/linux/skbuff.h ****  *	@nfct: Associated connection, if any
 195:include/linux/skbuff.h ****  *	@nfctinfo: Relationship of this skb to the connection
 196:include/linux/skbuff.h ****  *	@nf_debug: Netfilter debugging
 197:include/linux/skbuff.h ****  *	@nf_bridge: Saved data about a bridged frame - see br_netfilter.c
 198:include/linux/skbuff.h ****  *      @private: Data which is private to the HIPPI implementation
 199:include/linux/skbuff.h ****  *	@tc_index: Traffic control index
 200:include/linux/skbuff.h ****  *	@tc_verd: traffic control verdict
 201:include/linux/skbuff.h ****  *	@tc_classid: traffic control classid
 202:include/linux/skbuff.h ****  */
 203:include/linux/skbuff.h **** 
 204:include/linux/skbuff.h **** struct sk_buff {
 205:include/linux/skbuff.h **** 	/* These two members must be first. */
 206:include/linux/skbuff.h **** 	struct sk_buff		*next;
 207:include/linux/skbuff.h **** 	struct sk_buff		*prev;
 208:include/linux/skbuff.h **** 
 209:include/linux/skbuff.h **** 	struct sk_buff_head	*list;
 210:include/linux/skbuff.h **** 	struct sock		*sk;
 211:include/linux/skbuff.h **** 	struct timeval		stamp;
 212:include/linux/skbuff.h **** 	struct net_device	*dev;
 213:include/linux/skbuff.h **** 	struct net_device	*input_dev;
 214:include/linux/skbuff.h **** 	struct net_device	*real_dev;
 215:include/linux/skbuff.h **** 
 216:include/linux/skbuff.h **** 	union {
 217:include/linux/skbuff.h **** 		struct tcphdr	*th;
 218:include/linux/skbuff.h **** 		struct udphdr	*uh;
 219:include/linux/skbuff.h **** 		struct icmphdr	*icmph;
 220:include/linux/skbuff.h **** 		struct igmphdr	*igmph;
 221:include/linux/skbuff.h **** 		struct iphdr	*ipiph;
 222:include/linux/skbuff.h **** 		struct ipv6hdr	*ipv6h;
 223:include/linux/skbuff.h **** 		unsigned char	*raw;
 224:include/linux/skbuff.h **** 	} h;
 225:include/linux/skbuff.h **** 
 226:include/linux/skbuff.h **** 	union {
GAS LISTING  			page 54


 227:include/linux/skbuff.h **** 		struct iphdr	*iph;
 228:include/linux/skbuff.h **** 		struct ipv6hdr	*ipv6h;
 229:include/linux/skbuff.h **** 		struct arphdr	*arph;
 230:include/linux/skbuff.h **** 		unsigned char	*raw;
 231:include/linux/skbuff.h **** 	} nh;
 232:include/linux/skbuff.h **** 
 233:include/linux/skbuff.h **** 	union {
 234:include/linux/skbuff.h **** 	  	unsigned char 	*raw;
 235:include/linux/skbuff.h **** 	} mac;
 236:include/linux/skbuff.h **** 
 237:include/linux/skbuff.h **** 	struct  dst_entry	*dst;
 238:include/linux/skbuff.h **** 	struct	sec_path	*sp;
 239:include/linux/skbuff.h **** 
 240:include/linux/skbuff.h **** 	/*
 241:include/linux/skbuff.h **** 	 * This is the control buffer. It is free to use for every
 242:include/linux/skbuff.h **** 	 * layer. Please put your private variables there. If you
 243:include/linux/skbuff.h **** 	 * want to keep them across layers you have to do a skb_clone()
 244:include/linux/skbuff.h **** 	 * first. This is owned by whoever has the skb queued ATM.
 245:include/linux/skbuff.h **** 	 */
 246:include/linux/skbuff.h **** 	char			cb[40];
 247:include/linux/skbuff.h **** 
 248:include/linux/skbuff.h **** 	unsigned int		len,
 249:include/linux/skbuff.h **** 				data_len,
 250:include/linux/skbuff.h **** 				mac_len,
 251:include/linux/skbuff.h **** 				csum;
 252:include/linux/skbuff.h **** 	unsigned char		local_df,
 253:include/linux/skbuff.h **** 				cloned:1,
 254:include/linux/skbuff.h **** 				nohdr:1,
 255:include/linux/skbuff.h **** 				pkt_type,
 256:include/linux/skbuff.h **** 				ip_summed;
 257:include/linux/skbuff.h **** 	__u32			priority;
 258:include/linux/skbuff.h **** 	unsigned short		protocol,
 259:include/linux/skbuff.h **** 				security;
 260:include/linux/skbuff.h **** 
 261:include/linux/skbuff.h **** 	void			(*destructor)(struct sk_buff *skb);
 262:include/linux/skbuff.h **** #ifdef CONFIG_NETFILTER
 263:include/linux/skbuff.h ****         unsigned long		nfmark;
 264:include/linux/skbuff.h **** 	__u32			nfcache;
 265:include/linux/skbuff.h **** 	__u32			nfctinfo;
 266:include/linux/skbuff.h **** 	struct nf_conntrack	*nfct;
 267:include/linux/skbuff.h **** #ifdef CONFIG_NETFILTER_DEBUG
 268:include/linux/skbuff.h ****         unsigned int		nf_debug;
 269:include/linux/skbuff.h **** #endif
 270:include/linux/skbuff.h **** #ifdef CONFIG_BRIDGE_NETFILTER
 271:include/linux/skbuff.h **** 	struct nf_bridge_info	*nf_bridge;
 272:include/linux/skbuff.h **** #endif
 273:include/linux/skbuff.h **** #endif /* CONFIG_NETFILTER */
 274:include/linux/skbuff.h **** #if defined(CONFIG_HIPPI)
 275:include/linux/skbuff.h **** 	union {
 276:include/linux/skbuff.h **** 		__u32		ifield;
 277:include/linux/skbuff.h **** 	} private;
 278:include/linux/skbuff.h **** #endif
 279:include/linux/skbuff.h **** #ifdef CONFIG_NET_SCHED
 280:include/linux/skbuff.h ****        __u32			tc_index;        /* traffic control index */
 281:include/linux/skbuff.h **** #ifdef CONFIG_NET_CLS_ACT
 282:include/linux/skbuff.h **** 	__u32           tc_verd;               /* traffic control verdict */
 283:include/linux/skbuff.h **** 	__u32           tc_classid;            /* traffic control classid */
GAS LISTING  			page 55


 284:include/linux/skbuff.h **** #endif
 285:include/linux/skbuff.h **** 
 286:include/linux/skbuff.h **** #endif
 287:include/linux/skbuff.h **** 
 288:include/linux/skbuff.h **** 
 289:include/linux/skbuff.h **** 	/* These elements must be at the end, see alloc_skb() for details.  */
 290:include/linux/skbuff.h **** 	unsigned int		truesize;
 291:include/linux/skbuff.h **** 	atomic_t		users;
 292:include/linux/skbuff.h **** 	unsigned char		*head,
 293:include/linux/skbuff.h **** 				*data,
 294:include/linux/skbuff.h **** 				*tail,
 295:include/linux/skbuff.h **** 				*end;
 296:include/linux/skbuff.h **** };
 297:include/linux/skbuff.h **** 
 298:include/linux/skbuff.h **** #ifdef __KERNEL__
 299:include/linux/skbuff.h **** /*
 300:include/linux/skbuff.h ****  *	Handling routines are only of interest to the kernel
 301:include/linux/skbuff.h ****  */
 302:include/linux/skbuff.h **** #include <linux/slab.h>
 303:include/linux/skbuff.h **** 
 304:include/linux/skbuff.h **** #include <asm/system.h>
 305:include/linux/skbuff.h **** 
 306:include/linux/skbuff.h **** extern void	       __kfree_skb(struct sk_buff *skb);
 307:include/linux/skbuff.h **** extern struct sk_buff *alloc_skb(unsigned int size, int priority);
 308:include/linux/skbuff.h **** extern struct sk_buff *alloc_skb_from_cache(kmem_cache_t *cp,
 309:include/linux/skbuff.h **** 					    unsigned int size, int priority);
 310:include/linux/skbuff.h **** extern void	       kfree_skbmem(struct sk_buff *skb);
 311:include/linux/skbuff.h **** extern struct sk_buff *skb_clone(struct sk_buff *skb, int priority);
 312:include/linux/skbuff.h **** extern struct sk_buff *skb_copy(const struct sk_buff *skb, int priority);
 313:include/linux/skbuff.h **** extern struct sk_buff *pskb_copy(struct sk_buff *skb, int gfp_mask);
 314:include/linux/skbuff.h **** extern int	       pskb_expand_head(struct sk_buff *skb,
 315:include/linux/skbuff.h **** 					int nhead, int ntail, int gfp_mask);
 316:include/linux/skbuff.h **** extern struct sk_buff *skb_realloc_headroom(struct sk_buff *skb,
 317:include/linux/skbuff.h **** 					    unsigned int headroom);
 318:include/linux/skbuff.h **** extern struct sk_buff *skb_copy_expand(const struct sk_buff *skb,
 319:include/linux/skbuff.h **** 				       int newheadroom, int newtailroom,
 320:include/linux/skbuff.h **** 				       int priority);
 321:include/linux/skbuff.h **** extern struct sk_buff *		skb_pad(struct sk_buff *skb, int pad);
 322:include/linux/skbuff.h **** #define dev_kfree_skb(a)	kfree_skb(a)
 323:include/linux/skbuff.h **** extern void	      skb_over_panic(struct sk_buff *skb, int len,
 324:include/linux/skbuff.h **** 				     void *here);
 325:include/linux/skbuff.h **** extern void	      skb_under_panic(struct sk_buff *skb, int len,
 326:include/linux/skbuff.h **** 				      void *here);
 327:include/linux/skbuff.h **** 
 328:include/linux/skbuff.h **** /* Internal */
 329:include/linux/skbuff.h **** #define skb_shinfo(SKB)		((struct skb_shared_info *)((SKB)->end))
 330:include/linux/skbuff.h **** 
 331:include/linux/skbuff.h **** /**
 332:include/linux/skbuff.h ****  *	skb_queue_empty - check if a queue is empty
 333:include/linux/skbuff.h ****  *	@list: queue head
 334:include/linux/skbuff.h ****  *
 335:include/linux/skbuff.h ****  *	Returns true if the queue is empty, false otherwise.
 336:include/linux/skbuff.h ****  */
 337:include/linux/skbuff.h **** static inline int skb_queue_empty(const struct sk_buff_head *list)
 338:include/linux/skbuff.h **** {
 339:include/linux/skbuff.h **** 	return list->next == (struct sk_buff *)list;
 340:include/linux/skbuff.h **** }
GAS LISTING  			page 56


 341:include/linux/skbuff.h **** 
 342:include/linux/skbuff.h **** /**
 343:include/linux/skbuff.h ****  *	skb_get - reference buffer
 344:include/linux/skbuff.h ****  *	@skb: buffer to reference
 345:include/linux/skbuff.h ****  *
 346:include/linux/skbuff.h ****  *	Makes another reference to a socket buffer and returns a pointer
 347:include/linux/skbuff.h ****  *	to the buffer.
 348:include/linux/skbuff.h ****  */
 349:include/linux/skbuff.h **** static inline struct sk_buff *skb_get(struct sk_buff *skb)
 350:include/linux/skbuff.h **** {
 351:include/linux/skbuff.h **** 	atomic_inc(&skb->users);
 352:include/linux/skbuff.h **** 	return skb;
 353:include/linux/skbuff.h **** }
 354:include/linux/skbuff.h **** 
 355:include/linux/skbuff.h **** /*
 356:include/linux/skbuff.h ****  * If users == 1, we are the only owner and are can avoid redundant
 357:include/linux/skbuff.h ****  * atomic change.
 358:include/linux/skbuff.h ****  */
 359:include/linux/skbuff.h **** 
 360:include/linux/skbuff.h **** /**
 361:include/linux/skbuff.h ****  *	kfree_skb - free an sk_buff
 362:include/linux/skbuff.h ****  *	@skb: buffer to free
 363:include/linux/skbuff.h ****  *
 364:include/linux/skbuff.h ****  *	Drop a reference to the buffer and free it if the usage count has
 365:include/linux/skbuff.h ****  *	hit zero.
 366:include/linux/skbuff.h ****  */
 367:include/linux/skbuff.h **** static inline void kfree_skb(struct sk_buff *skb)
 368:include/linux/skbuff.h **** {
 369:include/linux/skbuff.h **** 	if (likely(atomic_read(&skb->users) == 1))
 370:include/linux/skbuff.h **** 		smp_rmb();
 371:include/linux/skbuff.h **** 	else if (likely(!atomic_dec_and_test(&skb->users)))
 372:include/linux/skbuff.h **** 		return;
 373:include/linux/skbuff.h **** 	__kfree_skb(skb);
 374:include/linux/skbuff.h **** }
 375:include/linux/skbuff.h **** 
 376:include/linux/skbuff.h **** /**
 377:include/linux/skbuff.h ****  *	skb_cloned - is the buffer a clone
 378:include/linux/skbuff.h ****  *	@skb: buffer to check
 379:include/linux/skbuff.h ****  *
 380:include/linux/skbuff.h ****  *	Returns true if the buffer was generated with skb_clone() and is
 381:include/linux/skbuff.h ****  *	one of multiple shared copies of the buffer. Cloned buffers are
 382:include/linux/skbuff.h ****  *	shared data so must not be written to under normal circumstances.
 383:include/linux/skbuff.h ****  */
 384:include/linux/skbuff.h **** static inline int skb_cloned(const struct sk_buff *skb)
 385:include/linux/skbuff.h **** {
 386:include/linux/skbuff.h **** 	return skb->cloned &&
 387:include/linux/skbuff.h **** 	       (atomic_read(&skb_shinfo(skb)->dataref) & SKB_DATAREF_MASK) != 1;
 388:include/linux/skbuff.h **** }
 389:include/linux/skbuff.h **** 
 390:include/linux/skbuff.h **** /**
 391:include/linux/skbuff.h ****  *	skb_header_cloned - is the header a clone
 392:include/linux/skbuff.h ****  *	@skb: buffer to check
 393:include/linux/skbuff.h ****  *
 394:include/linux/skbuff.h ****  *	Returns true if modifying the header part of the buffer requires
 395:include/linux/skbuff.h ****  *	the data to be copied.
 396:include/linux/skbuff.h ****  */
 397:include/linux/skbuff.h **** static inline int skb_header_cloned(const struct sk_buff *skb)
GAS LISTING  			page 57


 398:include/linux/skbuff.h **** {
 399:include/linux/skbuff.h **** 	int dataref;
 400:include/linux/skbuff.h **** 
 401:include/linux/skbuff.h **** 	if (!skb->cloned)
 402:include/linux/skbuff.h **** 		return 0;
 403:include/linux/skbuff.h **** 
 404:include/linux/skbuff.h **** 	dataref = atomic_read(&skb_shinfo(skb)->dataref);
 405:include/linux/skbuff.h **** 	dataref = (dataref & SKB_DATAREF_MASK) - (dataref >> SKB_DATAREF_SHIFT);
 406:include/linux/skbuff.h **** 	return dataref != 1;
 407:include/linux/skbuff.h **** }
 408:include/linux/skbuff.h **** 
 409:include/linux/skbuff.h **** /**
 410:include/linux/skbuff.h ****  *	skb_header_release - release reference to header
 411:include/linux/skbuff.h ****  *	@skb: buffer to operate on
 412:include/linux/skbuff.h ****  *
 413:include/linux/skbuff.h ****  *	Drop a reference to the header part of the buffer.  This is done
 414:include/linux/skbuff.h ****  *	by acquiring a payload reference.  You must not read from the header
 415:include/linux/skbuff.h ****  *	part of skb->data after this.
 416:include/linux/skbuff.h ****  */
 417:include/linux/skbuff.h **** static inline void skb_header_release(struct sk_buff *skb)
 418:include/linux/skbuff.h **** {
 419:include/linux/skbuff.h **** 	BUG_ON(skb->nohdr);
 420:include/linux/skbuff.h **** 	skb->nohdr = 1;
 421:include/linux/skbuff.h **** 	atomic_add(1 << SKB_DATAREF_SHIFT, &skb_shinfo(skb)->dataref);
 422:include/linux/skbuff.h **** }
 423:include/linux/skbuff.h **** 
 424:include/linux/skbuff.h **** /**
 425:include/linux/skbuff.h ****  *	skb_shared - is the buffer shared
 426:include/linux/skbuff.h ****  *	@skb: buffer to check
 427:include/linux/skbuff.h ****  *
 428:include/linux/skbuff.h ****  *	Returns true if more than one person has a reference to this
 429:include/linux/skbuff.h ****  *	buffer.
 430:include/linux/skbuff.h ****  */
 431:include/linux/skbuff.h **** static inline int skb_shared(const struct sk_buff *skb)
 432:include/linux/skbuff.h **** {
 433:include/linux/skbuff.h **** 	return atomic_read(&skb->users) != 1;
 434:include/linux/skbuff.h **** }
 435:include/linux/skbuff.h **** 
 436:include/linux/skbuff.h **** /**
 437:include/linux/skbuff.h ****  *	skb_share_check - check if buffer is shared and if so clone it
 438:include/linux/skbuff.h ****  *	@skb: buffer to check
 439:include/linux/skbuff.h ****  *	@pri: priority for memory allocation
 440:include/linux/skbuff.h ****  *
 441:include/linux/skbuff.h ****  *	If the buffer is shared the buffer is cloned and the old copy
 442:include/linux/skbuff.h ****  *	drops a reference. A new clone with a single reference is returned.
 443:include/linux/skbuff.h ****  *	If the buffer is not shared the original buffer is returned. When
 444:include/linux/skbuff.h ****  *	being called from interrupt status or with spinlocks held pri must
 445:include/linux/skbuff.h ****  *	be GFP_ATOMIC.
 446:include/linux/skbuff.h ****  *
 447:include/linux/skbuff.h ****  *	NULL is returned on a memory allocation failure.
 448:include/linux/skbuff.h ****  */
 449:include/linux/skbuff.h **** static inline struct sk_buff *skb_share_check(struct sk_buff *skb, int pri)
 450:include/linux/skbuff.h **** {
 451:include/linux/skbuff.h **** 	might_sleep_if(pri & __GFP_WAIT);
 452:include/linux/skbuff.h **** 	if (skb_shared(skb)) {
 453:include/linux/skbuff.h **** 		struct sk_buff *nskb = skb_clone(skb, pri);
 454:include/linux/skbuff.h **** 		kfree_skb(skb);
GAS LISTING  			page 58


 455:include/linux/skbuff.h **** 		skb = nskb;
 456:include/linux/skbuff.h **** 	}
 457:include/linux/skbuff.h **** 	return skb;
 458:include/linux/skbuff.h **** }
 459:include/linux/skbuff.h **** 
 460:include/linux/skbuff.h **** /*
 461:include/linux/skbuff.h ****  *	Copy shared buffers into a new sk_buff. We effectively do COW on
 462:include/linux/skbuff.h ****  *	packets to handle cases where we have a local reader and forward
 463:include/linux/skbuff.h ****  *	and a couple of other messy ones. The normal one is tcpdumping
 464:include/linux/skbuff.h ****  *	a packet thats being forwarded.
 465:include/linux/skbuff.h ****  */
 466:include/linux/skbuff.h **** 
 467:include/linux/skbuff.h **** /**
 468:include/linux/skbuff.h ****  *	skb_unshare - make a copy of a shared buffer
 469:include/linux/skbuff.h ****  *	@skb: buffer to check
 470:include/linux/skbuff.h ****  *	@pri: priority for memory allocation
 471:include/linux/skbuff.h ****  *
 472:include/linux/skbuff.h ****  *	If the socket buffer is a clone then this function creates a new
 473:include/linux/skbuff.h ****  *	copy of the data, drops a reference count on the old copy and returns
 474:include/linux/skbuff.h ****  *	the new copy with the reference count at 1. If the buffer is not a clone
 475:include/linux/skbuff.h ****  *	the original buffer is returned. When called with a spinlock held or
 476:include/linux/skbuff.h ****  *	from interrupt state @pri must be %GFP_ATOMIC
 477:include/linux/skbuff.h ****  *
 478:include/linux/skbuff.h ****  *	%NULL is returned on a memory allocation failure.
 479:include/linux/skbuff.h ****  */
 480:include/linux/skbuff.h **** static inline struct sk_buff *skb_unshare(struct sk_buff *skb, int pri)
 481:include/linux/skbuff.h **** {
 482:include/linux/skbuff.h **** 	might_sleep_if(pri & __GFP_WAIT);
 483:include/linux/skbuff.h **** 	if (skb_cloned(skb)) {
 484:include/linux/skbuff.h **** 		struct sk_buff *nskb = skb_copy(skb, pri);
 485:include/linux/skbuff.h **** 		kfree_skb(skb);	/* Free our shared copy */
 486:include/linux/skbuff.h **** 		skb = nskb;
 487:include/linux/skbuff.h **** 	}
 488:include/linux/skbuff.h **** 	return skb;
 489:include/linux/skbuff.h **** }
 490:include/linux/skbuff.h **** 
 491:include/linux/skbuff.h **** /**
 492:include/linux/skbuff.h ****  *	skb_peek
 493:include/linux/skbuff.h ****  *	@list_: list to peek at
 494:include/linux/skbuff.h ****  *
 495:include/linux/skbuff.h ****  *	Peek an &sk_buff. Unlike most other operations you _MUST_
 496:include/linux/skbuff.h ****  *	be careful with this one. A peek leaves the buffer on the
 497:include/linux/skbuff.h ****  *	list and someone else may run off with it. You must hold
 498:include/linux/skbuff.h ****  *	the appropriate locks or have a private queue to do this.
 499:include/linux/skbuff.h ****  *
 500:include/linux/skbuff.h ****  *	Returns %NULL for an empty list or a pointer to the head element.
 501:include/linux/skbuff.h ****  *	The reference count is not incremented and the reference is therefore
 502:include/linux/skbuff.h ****  *	volatile. Use with caution.
 503:include/linux/skbuff.h ****  */
 504:include/linux/skbuff.h **** static inline struct sk_buff *skb_peek(struct sk_buff_head *list_)
 505:include/linux/skbuff.h **** {
 506:include/linux/skbuff.h **** 	struct sk_buff *list = ((struct sk_buff *)list_)->next;
 507:include/linux/skbuff.h **** 	if (list == (struct sk_buff *)list_)
 508:include/linux/skbuff.h **** 		list = NULL;
 509:include/linux/skbuff.h **** 	return list;
 510:include/linux/skbuff.h **** }
 511:include/linux/skbuff.h **** 
GAS LISTING  			page 59


 512:include/linux/skbuff.h **** /**
 513:include/linux/skbuff.h ****  *	skb_peek_tail
 514:include/linux/skbuff.h ****  *	@list_: list to peek at
 515:include/linux/skbuff.h ****  *
 516:include/linux/skbuff.h ****  *	Peek an &sk_buff. Unlike most other operations you _MUST_
 517:include/linux/skbuff.h ****  *	be careful with this one. A peek leaves the buffer on the
 518:include/linux/skbuff.h ****  *	list and someone else may run off with it. You must hold
 519:include/linux/skbuff.h ****  *	the appropriate locks or have a private queue to do this.
 520:include/linux/skbuff.h ****  *
 521:include/linux/skbuff.h ****  *	Returns %NULL for an empty list or a pointer to the tail element.
 522:include/linux/skbuff.h ****  *	The reference count is not incremented and the reference is therefore
 523:include/linux/skbuff.h ****  *	volatile. Use with caution.
 524:include/linux/skbuff.h ****  */
 525:include/linux/skbuff.h **** static inline struct sk_buff *skb_peek_tail(struct sk_buff_head *list_)
 526:include/linux/skbuff.h **** {
 527:include/linux/skbuff.h **** 	struct sk_buff *list = ((struct sk_buff *)list_)->prev;
 528:include/linux/skbuff.h **** 	if (list == (struct sk_buff *)list_)
 529:include/linux/skbuff.h **** 		list = NULL;
 530:include/linux/skbuff.h **** 	return list;
 531:include/linux/skbuff.h **** }
 532:include/linux/skbuff.h **** 
 533:include/linux/skbuff.h **** /**
 534:include/linux/skbuff.h ****  *	skb_queue_len	- get queue length
 535:include/linux/skbuff.h ****  *	@list_: list to measure
 536:include/linux/skbuff.h ****  *
 537:include/linux/skbuff.h ****  *	Return the length of an &sk_buff queue.
 538:include/linux/skbuff.h ****  */
 539:include/linux/skbuff.h **** static inline __u32 skb_queue_len(const struct sk_buff_head *list_)
 540:include/linux/skbuff.h **** {
 541:include/linux/skbuff.h **** 	return list_->qlen;
 542:include/linux/skbuff.h **** }
 543:include/linux/skbuff.h **** 
 544:include/linux/skbuff.h **** static inline void skb_queue_head_init(struct sk_buff_head *list)
 545:include/linux/skbuff.h **** {
 546:include/linux/skbuff.h **** 	spin_lock_init(&list->lock);
 547:include/linux/skbuff.h **** 	list->prev = list->next = (struct sk_buff *)list;
 548:include/linux/skbuff.h **** 	list->qlen = 0;
 549:include/linux/skbuff.h **** }
 550:include/linux/skbuff.h **** 
 551:include/linux/skbuff.h **** /*
 552:include/linux/skbuff.h ****  *	Insert an sk_buff at the start of a list.
 553:include/linux/skbuff.h ****  *
 554:include/linux/skbuff.h ****  *	The "__skb_xxxx()" functions are the non-atomic ones that
 555:include/linux/skbuff.h ****  *	can only be called with interrupts disabled.
 556:include/linux/skbuff.h ****  */
 557:include/linux/skbuff.h **** 
 558:include/linux/skbuff.h **** /**
 559:include/linux/skbuff.h ****  *	__skb_queue_head - queue a buffer at the list head
 560:include/linux/skbuff.h ****  *	@list: list to use
 561:include/linux/skbuff.h ****  *	@newsk: buffer to queue
 562:include/linux/skbuff.h ****  *
 563:include/linux/skbuff.h ****  *	Queue a buffer at the start of a list. This function takes no locks
 564:include/linux/skbuff.h ****  *	and you must therefore hold required locks before calling it.
 565:include/linux/skbuff.h ****  *
 566:include/linux/skbuff.h ****  *	A buffer cannot be placed on two lists at the same time.
 567:include/linux/skbuff.h ****  */
 568:include/linux/skbuff.h **** extern void skb_queue_head(struct sk_buff_head *list, struct sk_buff *newsk);
GAS LISTING  			page 60


 569:include/linux/skbuff.h **** static inline void __skb_queue_head(struct sk_buff_head *list,
 570:include/linux/skbuff.h **** 				    struct sk_buff *newsk)
 571:include/linux/skbuff.h **** {
 572:include/linux/skbuff.h **** 	struct sk_buff *prev, *next;
 573:include/linux/skbuff.h **** 
 574:include/linux/skbuff.h **** 	newsk->list = list;
 575:include/linux/skbuff.h **** 	list->qlen++;
 576:include/linux/skbuff.h **** 	prev = (struct sk_buff *)list;
 577:include/linux/skbuff.h **** 	next = prev->next;
 578:include/linux/skbuff.h **** 	newsk->next = next;
 579:include/linux/skbuff.h **** 	newsk->prev = prev;
 580:include/linux/skbuff.h **** 	next->prev  = prev->next = newsk;
 581:include/linux/skbuff.h **** }
 582:include/linux/skbuff.h **** 
 583:include/linux/skbuff.h **** /**
 584:include/linux/skbuff.h ****  *	__skb_queue_tail - queue a buffer at the list tail
 585:include/linux/skbuff.h ****  *	@list: list to use
 586:include/linux/skbuff.h ****  *	@newsk: buffer to queue
 587:include/linux/skbuff.h ****  *
 588:include/linux/skbuff.h ****  *	Queue a buffer at the end of a list. This function takes no locks
 589:include/linux/skbuff.h ****  *	and you must therefore hold required locks before calling it.
 590:include/linux/skbuff.h ****  *
 591:include/linux/skbuff.h ****  *	A buffer cannot be placed on two lists at the same time.
 592:include/linux/skbuff.h ****  */
 593:include/linux/skbuff.h **** extern void skb_queue_tail(struct sk_buff_head *list, struct sk_buff *newsk);
 594:include/linux/skbuff.h **** static inline void __skb_queue_tail(struct sk_buff_head *list,
 595:include/linux/skbuff.h **** 				   struct sk_buff *newsk)
 596:include/linux/skbuff.h **** {
 597:include/linux/skbuff.h **** 	struct sk_buff *prev, *next;
 598:include/linux/skbuff.h **** 
 599:include/linux/skbuff.h **** 	newsk->list = list;
 600:include/linux/skbuff.h **** 	list->qlen++;
 601:include/linux/skbuff.h **** 	next = (struct sk_buff *)list;
 602:include/linux/skbuff.h **** 	prev = next->prev;
 603:include/linux/skbuff.h **** 	newsk->next = next;
 604:include/linux/skbuff.h **** 	newsk->prev = prev;
 605:include/linux/skbuff.h **** 	next->prev  = prev->next = newsk;
 606:include/linux/skbuff.h **** }
 607:include/linux/skbuff.h **** 
 608:include/linux/skbuff.h **** 
 609:include/linux/skbuff.h **** /**
 610:include/linux/skbuff.h ****  *	__skb_dequeue - remove from the head of the queue
 611:include/linux/skbuff.h ****  *	@list: list to dequeue from
 612:include/linux/skbuff.h ****  *
 613:include/linux/skbuff.h ****  *	Remove the head of the list. This function does not take any locks
 614:include/linux/skbuff.h ****  *	so must be used with appropriate locks held only. The head item is
 615:include/linux/skbuff.h ****  *	returned or %NULL if the list is empty.
 616:include/linux/skbuff.h ****  */
 617:include/linux/skbuff.h **** extern struct sk_buff *skb_dequeue(struct sk_buff_head *list);
 618:include/linux/skbuff.h **** static inline struct sk_buff *__skb_dequeue(struct sk_buff_head *list)
 619:include/linux/skbuff.h **** {
 620:include/linux/skbuff.h **** 	struct sk_buff *next, *prev, *result;
 621:include/linux/skbuff.h **** 
 622:include/linux/skbuff.h **** 	prev = (struct sk_buff *) list;
 623:include/linux/skbuff.h **** 	next = prev->next;
 624:include/linux/skbuff.h **** 	result = NULL;
 625:include/linux/skbuff.h **** 	if (next != prev) {
GAS LISTING  			page 61


 626:include/linux/skbuff.h **** 		result	     = next;
 627:include/linux/skbuff.h **** 		next	     = next->next;
 628:include/linux/skbuff.h **** 		list->qlen--;
 629:include/linux/skbuff.h **** 		next->prev   = prev;
 630:include/linux/skbuff.h **** 		prev->next   = next;
 631:include/linux/skbuff.h **** 		result->next = result->prev = NULL;
 632:include/linux/skbuff.h **** 		result->list = NULL;
 633:include/linux/skbuff.h **** 	}
 634:include/linux/skbuff.h **** 	return result;
 635:include/linux/skbuff.h **** }
 636:include/linux/skbuff.h **** 
 637:include/linux/skbuff.h **** 
 638:include/linux/skbuff.h **** /*
 639:include/linux/skbuff.h ****  *	Insert a packet on a list.
 640:include/linux/skbuff.h ****  */
 641:include/linux/skbuff.h **** extern void        skb_insert(struct sk_buff *old, struct sk_buff *newsk);
 642:include/linux/skbuff.h **** static inline void __skb_insert(struct sk_buff *newsk,
 643:include/linux/skbuff.h **** 				struct sk_buff *prev, struct sk_buff *next,
 644:include/linux/skbuff.h **** 				struct sk_buff_head *list)
 645:include/linux/skbuff.h **** {
 646:include/linux/skbuff.h **** 	newsk->next = next;
 647:include/linux/skbuff.h **** 	newsk->prev = prev;
 648:include/linux/skbuff.h **** 	next->prev  = prev->next = newsk;
 649:include/linux/skbuff.h **** 	newsk->list = list;
 650:include/linux/skbuff.h **** 	list->qlen++;
 651:include/linux/skbuff.h **** }
 652:include/linux/skbuff.h **** 
 653:include/linux/skbuff.h **** /*
 654:include/linux/skbuff.h ****  *	Place a packet after a given packet in a list.
 655:include/linux/skbuff.h ****  */
 656:include/linux/skbuff.h **** extern void	   skb_append(struct sk_buff *old, struct sk_buff *newsk);
 657:include/linux/skbuff.h **** static inline void __skb_append(struct sk_buff *old, struct sk_buff *newsk)
 658:include/linux/skbuff.h **** {
 659:include/linux/skbuff.h **** 	__skb_insert(newsk, old, old->next, old->list);
 660:include/linux/skbuff.h **** }
 661:include/linux/skbuff.h **** 
 662:include/linux/skbuff.h **** /*
 663:include/linux/skbuff.h ****  * remove sk_buff from list. _Must_ be called atomically, and with
 664:include/linux/skbuff.h ****  * the list known..
 665:include/linux/skbuff.h ****  */
 666:include/linux/skbuff.h **** extern void	   skb_unlink(struct sk_buff *skb);
 667:include/linux/skbuff.h **** static inline void __skb_unlink(struct sk_buff *skb, struct sk_buff_head *list)
 668:include/linux/skbuff.h **** {
 669:include/linux/skbuff.h **** 	struct sk_buff *next, *prev;
 670:include/linux/skbuff.h **** 
 671:include/linux/skbuff.h **** 	list->qlen--;
 672:include/linux/skbuff.h **** 	next	   = skb->next;
 673:include/linux/skbuff.h **** 	prev	   = skb->prev;
 674:include/linux/skbuff.h **** 	skb->next  = skb->prev = NULL;
 675:include/linux/skbuff.h **** 	skb->list  = NULL;
 676:include/linux/skbuff.h **** 	next->prev = prev;
 677:include/linux/skbuff.h **** 	prev->next = next;
 678:include/linux/skbuff.h **** }
 679:include/linux/skbuff.h **** 
 680:include/linux/skbuff.h **** 
 681:include/linux/skbuff.h **** /* XXX: more streamlined implementation */
 682:include/linux/skbuff.h **** 
GAS LISTING  			page 62


 683:include/linux/skbuff.h **** /**
 684:include/linux/skbuff.h ****  *	__skb_dequeue_tail - remove from the tail of the queue
 685:include/linux/skbuff.h ****  *	@list: list to dequeue from
 686:include/linux/skbuff.h ****  *
 687:include/linux/skbuff.h ****  *	Remove the tail of the list. This function does not take any locks
 688:include/linux/skbuff.h ****  *	so must be used with appropriate locks held only. The tail item is
 689:include/linux/skbuff.h ****  *	returned or %NULL if the list is empty.
 690:include/linux/skbuff.h ****  */
 691:include/linux/skbuff.h **** extern struct sk_buff *skb_dequeue_tail(struct sk_buff_head *list);
 692:include/linux/skbuff.h **** static inline struct sk_buff *__skb_dequeue_tail(struct sk_buff_head *list)
 693:include/linux/skbuff.h **** {
 694:include/linux/skbuff.h **** 	struct sk_buff *skb = skb_peek_tail(list);
 695:include/linux/skbuff.h **** 	if (skb)
 696:include/linux/skbuff.h **** 		__skb_unlink(skb, list);
 697:include/linux/skbuff.h **** 	return skb;
 698:include/linux/skbuff.h **** }
 699:include/linux/skbuff.h **** 
 700:include/linux/skbuff.h **** 
 701:include/linux/skbuff.h **** static inline int skb_is_nonlinear(const struct sk_buff *skb)
 702:include/linux/skbuff.h **** {
 703:include/linux/skbuff.h **** 	return skb->data_len;
 704:include/linux/skbuff.h **** }
 705:include/linux/skbuff.h **** 
 706:include/linux/skbuff.h **** static inline unsigned int skb_headlen(const struct sk_buff *skb)
 707:include/linux/skbuff.h **** {
 708:include/linux/skbuff.h **** 	return skb->len - skb->data_len;
 709:include/linux/skbuff.h **** }
 710:include/linux/skbuff.h **** 
 711:include/linux/skbuff.h **** static inline int skb_pagelen(const struct sk_buff *skb)
 712:include/linux/skbuff.h **** {
 713:include/linux/skbuff.h **** 	int i, len = 0;
 714:include/linux/skbuff.h **** 
 715:include/linux/skbuff.h **** 	for (i = (int)skb_shinfo(skb)->nr_frags - 1; i >= 0; i--)
 716:include/linux/skbuff.h **** 		len += skb_shinfo(skb)->frags[i].size;
 717:include/linux/skbuff.h **** 	return len + skb_headlen(skb);
 718:include/linux/skbuff.h **** }
 719:include/linux/skbuff.h **** 
 720:include/linux/skbuff.h **** static inline void skb_fill_page_desc(struct sk_buff *skb, int i,
 721:include/linux/skbuff.h **** 				      struct page *page, int off, int size)
 722:include/linux/skbuff.h **** {
 723:include/linux/skbuff.h **** 	skb_frag_t *frag = &skb_shinfo(skb)->frags[i];
 724:include/linux/skbuff.h **** 
 725:include/linux/skbuff.h **** 	frag->page		  = page;
 726:include/linux/skbuff.h **** 	frag->page_offset	  = off;
 727:include/linux/skbuff.h **** 	frag->size		  = size;
 728:include/linux/skbuff.h **** 	skb_shinfo(skb)->nr_frags = i + 1;
 729:include/linux/skbuff.h **** }
 730:include/linux/skbuff.h **** 
 731:include/linux/skbuff.h **** #define SKB_PAGE_ASSERT(skb) 	BUG_ON(skb_shinfo(skb)->nr_frags)
 732:include/linux/skbuff.h **** #define SKB_FRAG_ASSERT(skb) 	BUG_ON(skb_shinfo(skb)->frag_list)
 733:include/linux/skbuff.h **** #define SKB_LINEAR_ASSERT(skb)  BUG_ON(skb_is_nonlinear(skb))
 734:include/linux/skbuff.h **** 
 735:include/linux/skbuff.h **** /*
 736:include/linux/skbuff.h ****  *	Add data to an sk_buff
 737:include/linux/skbuff.h ****  */
 738:include/linux/skbuff.h **** static inline unsigned char *__skb_put(struct sk_buff *skb, unsigned int len)
 739:include/linux/skbuff.h **** {
GAS LISTING  			page 63


 740:include/linux/skbuff.h **** 	unsigned char *tmp = skb->tail;
 741:include/linux/skbuff.h **** 	SKB_LINEAR_ASSERT(skb);
 742:include/linux/skbuff.h **** 	skb->tail += len;
 743:include/linux/skbuff.h **** 	skb->len  += len;
 744:include/linux/skbuff.h **** 	return tmp;
 745:include/linux/skbuff.h **** }
 746:include/linux/skbuff.h **** 
 747:include/linux/skbuff.h **** /**
 748:include/linux/skbuff.h ****  *	skb_put - add data to a buffer
 749:include/linux/skbuff.h ****  *	@skb: buffer to use
 750:include/linux/skbuff.h ****  *	@len: amount of data to add
 751:include/linux/skbuff.h ****  *
 752:include/linux/skbuff.h ****  *	This function extends the used data area of the buffer. If this would
 753:include/linux/skbuff.h ****  *	exceed the total buffer size the kernel will panic. A pointer to the
 754:include/linux/skbuff.h ****  *	first byte of the extra data is returned.
 755:include/linux/skbuff.h ****  */
 756:include/linux/skbuff.h **** static inline unsigned char *skb_put(struct sk_buff *skb, unsigned int len)
 757:include/linux/skbuff.h **** {
 758:include/linux/skbuff.h **** 	unsigned char *tmp = skb->tail;
 759:include/linux/skbuff.h **** 	SKB_LINEAR_ASSERT(skb);
 760:include/linux/skbuff.h **** 	skb->tail += len;
 761:include/linux/skbuff.h **** 	skb->len  += len;
 762:include/linux/skbuff.h **** 	if (unlikely(skb->tail>skb->end))
 763:include/linux/skbuff.h **** 		skb_over_panic(skb, len, current_text_addr());
 764:include/linux/skbuff.h **** 	return tmp;
 765:include/linux/skbuff.h **** }
 766:include/linux/skbuff.h **** 
 767:include/linux/skbuff.h **** static inline unsigned char *__skb_push(struct sk_buff *skb, unsigned int len)
 768:include/linux/skbuff.h **** {
 769:include/linux/skbuff.h **** 	skb->data -= len;
 770:include/linux/skbuff.h **** 	skb->len  += len;
 771:include/linux/skbuff.h **** 	return skb->data;
 772:include/linux/skbuff.h **** }
 773:include/linux/skbuff.h **** 
 774:include/linux/skbuff.h **** /**
 775:include/linux/skbuff.h ****  *	skb_push - add data to the start of a buffer
 776:include/linux/skbuff.h ****  *	@skb: buffer to use
 777:include/linux/skbuff.h ****  *	@len: amount of data to add
 778:include/linux/skbuff.h ****  *
 779:include/linux/skbuff.h ****  *	This function extends the used data area of the buffer at the buffer
 780:include/linux/skbuff.h ****  *	start. If this would exceed the total buffer headroom the kernel will
 781:include/linux/skbuff.h ****  *	panic. A pointer to the first byte of the extra data is returned.
 782:include/linux/skbuff.h ****  */
 783:include/linux/skbuff.h **** static inline unsigned char *skb_push(struct sk_buff *skb, unsigned int len)
 784:include/linux/skbuff.h **** {
 785:include/linux/skbuff.h **** 	skb->data -= len;
 786:include/linux/skbuff.h **** 	skb->len  += len;
 787:include/linux/skbuff.h **** 	if (unlikely(skb->data<skb->head))
 788:include/linux/skbuff.h **** 		skb_under_panic(skb, len, current_text_addr());
 789:include/linux/skbuff.h **** 	return skb->data;
 790:include/linux/skbuff.h **** }
 791:include/linux/skbuff.h **** 
 792:include/linux/skbuff.h **** static inline unsigned char *__skb_pull(struct sk_buff *skb, unsigned int len)
 793:include/linux/skbuff.h **** {
 794:include/linux/skbuff.h **** 	skb->len -= len;
 795:include/linux/skbuff.h **** 	BUG_ON(skb->len < skb->data_len);
 796:include/linux/skbuff.h **** 	return skb->data += len;
GAS LISTING  			page 64


 797:include/linux/skbuff.h **** }
 798:include/linux/skbuff.h **** 
 799:include/linux/skbuff.h **** /**
 800:include/linux/skbuff.h ****  *	skb_pull - remove data from the start of a buffer
 801:include/linux/skbuff.h ****  *	@skb: buffer to use
 802:include/linux/skbuff.h ****  *	@len: amount of data to remove
 803:include/linux/skbuff.h ****  *
 804:include/linux/skbuff.h ****  *	This function removes data from the start of a buffer, returning
 805:include/linux/skbuff.h ****  *	the memory to the headroom. A pointer to the next data in the buffer
 806:include/linux/skbuff.h ****  *	is returned. Once the data has been pulled future pushes will overwrite
 807:include/linux/skbuff.h ****  *	the old data.
 808:include/linux/skbuff.h ****  */
 809:include/linux/skbuff.h **** static inline unsigned char *skb_pull(struct sk_buff *skb, unsigned int len)
 810:include/linux/skbuff.h **** {
 811:include/linux/skbuff.h **** 	return unlikely(len > skb->len) ? NULL : __skb_pull(skb, len);
 812:include/linux/skbuff.h **** }
 813:include/linux/skbuff.h **** 
 814:include/linux/skbuff.h **** extern unsigned char *__pskb_pull_tail(struct sk_buff *skb, int delta);
 815:include/linux/skbuff.h **** 
 816:include/linux/skbuff.h **** static inline unsigned char *__pskb_pull(struct sk_buff *skb, unsigned int len)
 817:include/linux/skbuff.h **** {
 818:include/linux/skbuff.h **** 	if (len > skb_headlen(skb) &&
 819:include/linux/skbuff.h **** 	    !__pskb_pull_tail(skb, len-skb_headlen(skb)))
 820:include/linux/skbuff.h **** 		return NULL;
 821:include/linux/skbuff.h **** 	skb->len -= len;
 822:include/linux/skbuff.h **** 	return skb->data += len;
 823:include/linux/skbuff.h **** }
 824:include/linux/skbuff.h **** 
 825:include/linux/skbuff.h **** static inline unsigned char *pskb_pull(struct sk_buff *skb, unsigned int len)
 826:include/linux/skbuff.h **** {
 827:include/linux/skbuff.h **** 	return unlikely(len > skb->len) ? NULL : __pskb_pull(skb, len);
 828:include/linux/skbuff.h **** }
 829:include/linux/skbuff.h **** 
 830:include/linux/skbuff.h **** static inline int pskb_may_pull(struct sk_buff *skb, unsigned int len)
 831:include/linux/skbuff.h **** {
 832:include/linux/skbuff.h **** 	if (likely(len <= skb_headlen(skb)))
 833:include/linux/skbuff.h **** 		return 1;
 834:include/linux/skbuff.h **** 	if (unlikely(len > skb->len))
 835:include/linux/skbuff.h **** 		return 0;
 836:include/linux/skbuff.h **** 	return __pskb_pull_tail(skb, len-skb_headlen(skb)) != NULL;
 837:include/linux/skbuff.h **** }
 838:include/linux/skbuff.h **** 
 839:include/linux/skbuff.h **** /**
 840:include/linux/skbuff.h ****  *	skb_headroom - bytes at buffer head
 841:include/linux/skbuff.h ****  *	@skb: buffer to check
 842:include/linux/skbuff.h ****  *
 843:include/linux/skbuff.h ****  *	Return the number of bytes of free space at the head of an &sk_buff.
 844:include/linux/skbuff.h ****  */
 845:include/linux/skbuff.h **** static inline int skb_headroom(const struct sk_buff *skb)
 846:include/linux/skbuff.h **** {
 847:include/linux/skbuff.h **** 	return skb->data - skb->head;
 1036              	.loc 5 847 0
 1037 0470 89D0     	movl %edx,%eax
 1038 0472 2B83A400 	subl 164(%ebx),%eax
 1038      0000
 1039              	.LBE69:
 1040              	.LBE68:
GAS LISTING  			page 65


 1041              	.loc 5 846 0
 1042 0478 83F807   	cmpl $7,%eax
 1043              	.loc 1 275 0
 1044 047b 8B6C2418 	movl 24(%esp),%ebp
 1045 047f 8B7C241C 	movl 28(%esp),%edi
 1046 0483 8B742424 	movl 36(%esp),%esi
 1047              	.loc 5 846 0
 1048 0487 7E10     	jle .L139
 1049 0489 396B60   	cmpl %ebp,96(%ebx)
 1050 048c 720B     	jb .L139
 282:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 283:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (skb_headroom(skb) < 8 || skb->len < hdr_len)
 284:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 285:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 286:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (rc4key == NULL || keylen < 16)
 1051              	.loc 1 286 0
 1052 048e 85FF     	testl %edi,%edi
 1053 0490 7407     	je .L139
 1054 0492 837C2420 	cmpl $15,32(%esp)
 1054      0F
 1055 0497 7F08     	jg .L138
 1056              	.L139:
 287:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 1057              	.loc 1 287 0
 1058 0499 83C8FF   	orl $-1,%eax
 1059 049c E9CC0000 	jmp .L134
 1059      00
 1060              	.L138:
 288:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 289:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (!tkey->tx_phase1_done) {
 1061              	.loc 1 289 0
 1062 04a1 837E3400 	cmpl $0,52(%esi)
 1063 04a5 751B     	jne .L140
 290:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		tkip_mixing_phase1(tkey->tx_ttak, tkey->key, hdr->addr2,
 1064              	.loc 1 290 0
 1065 04a7 FF7624   	pushl 36(%esi)
 1066              	.LCFI47:
 1067 04aa 8D420A   	leal 10(%edx),%eax
 1068 04ad 50       	pushl %eax
 1069              	.LCFI48:
 1070 04ae 56       	pushl %esi
 1071              	.LCFI49:
 1072 04af 8D462A   	leal 42(%esi),%eax
 1073 04b2 50       	pushl %eax
 1074              	.LCFI50:
 1075 04b3 E832FCFF 	call tkip_mixing_phase1
 1075      FF
 291:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 				   tkey->tx_iv32);
 292:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		tkey->tx_phase1_done = 1;
 1076              	.loc 1 292 0
 1077 04b8 83C410   	addl $16,%esp
 1078              	.LCFI51:
 1079 04bb C7463401 	movl $1,52(%esi)
 1079      000000
 1080              	.L140:
 293:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 294:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	tkip_mixing_phase2(rc4key, tkey->key, tkey->tx_ttak, tkey->tx_iv16);
GAS LISTING  			page 66


 1081              	.loc 1 294 0
 1082 04c2 0FB74628 	movzwl 40(%esi),%eax
 1083 04c6 50       	pushl %eax
 1084              	.LCFI52:
 1085 04c7 8D462A   	leal 42(%esi),%eax
 1086 04ca 50       	pushl %eax
 1087              	.LCFI53:
 1088 04cb 56       	pushl %esi
 1089              	.LCFI54:
 1090 04cc 57       	pushl %edi
 1091              	.LCFI55:
 1092 04cd E8ABFDFF 	call tkip_mixing_phase2
 1092      FF
 1093              	.LBB70:
 1094              	.LBB71:
 1095              	.loc 5 785 0
 1096 04d2 8B83A800 	movl 168(%ebx),%eax
 1096      0000
 1097 04d8 83E808   	subl $8,%eax
 1098              	.LBE71:
 1099              	.LBE70:
 1100              	.loc 5 784 0
 1101 04db 83C410   	addl $16,%esp
 1102              	.LCFI56:
 1103              	.LBB72:
 1104              	.LBB73:
 1105              	.loc 5 786 0
 1106 04de 83436008 	addl $8,96(%ebx)
 1107              	.loc 5 787 0
 1108 04e2 3B83A400 	cmpl 164(%ebx),%eax
 1108      0000
 1109              	.loc 5 785 0
 1110 04e8 8983A800 	movl %eax,168(%ebx)
 1110      0000
 1111              	.loc 5 787 0
 1112 04ee 7311     	jae .L141
 1113              	.LBB74:
 1114              	.loc 5 788 0
 1115              	
 1116 04f0 B8F50400 	movl $1f,%eax
 1116      00
 1117              	1:
 1118              	
 1119              	.LBE74:
 1120 04f5 50       	pushl %eax
 1121              	.LCFI57:
 1122 04f6 6A08     	pushl $8
 1123              	.LCFI58:
 1124 04f8 53       	pushl %ebx
 1125              	.LCFI59:
 1126 04f9 E8FCFFFF 	call skb_under_panic
 1126      FF
 1127 04fe 83C40C   	addl $12,%esp
 1128              	.LCFI60:
 1129              	.L141:
 1130 0501 8B9BA800 	movl 168(%ebx),%ebx
 1130      0000
GAS LISTING  			page 67


 1131              	.LBE73:
 1132              	.LBE72:
 295:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 296:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	len = skb->len - hdr_len;
 297:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	pos = skb_push(skb, 8);
 298:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	memmove(pos, pos + 8, hdr_len);
 1133              	.loc 1 298 0
 1134 0507 8D4308   	leal 8(%ebx),%eax
 1135 050a 55       	pushl %ebp
 1136              	.LCFI61:
 1137 050b 50       	pushl %eax
 1138              	.LCFI62:
 1139 050c 53       	pushl %ebx
 1140              	.LCFI63:
 1141 050d E8FCFFFF 	call memmove
 1141      FF
 299:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	pos += hdr_len;
 1142              	.loc 1 299 0
 1143 0512 01EB     	addl %ebp,%ebx
 300:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 301:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	*pos++ = *rc4key;
 1144              	.loc 1 301 0
 1145 0514 8A07     	movb (%edi),%al
 1146 0516 8803     	movb %al,(%ebx)
 302:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	*pos++ = *(rc4key + 1);
 1147              	.loc 1 302 0
 1148 0518 8A4701   	movb 1(%edi),%al
 1149              	.loc 1 301 0
 1150 051b 43       	incl %ebx
 1151              	.loc 1 302 0
 1152 051c 8803     	movb %al,(%ebx)
 303:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	*pos++ = *(rc4key + 2);
 1153              	.loc 1 303 0
 1154 051e 8A4702   	movb 2(%edi),%al
 1155              	.loc 1 302 0
 1156 0521 43       	incl %ebx
 1157              	.loc 1 303 0
 1158 0522 8803     	movb %al,(%ebx)
 304:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	*pos++ = (tkey->key_idx << 6) | (1 << 5) /* Ext IV included */ ;
 1159              	.loc 1 304 0
 1160 0524 8B4660   	movl 96(%esi),%eax
 1161 0527 C1E006   	sall $6,%eax
 1162              	.loc 1 303 0
 1163 052a 43       	incl %ebx
 1164              	.loc 1 304 0
 1165 052b 83C820   	orl $32,%eax
 1166 052e 8803     	movb %al,(%ebx)
 305:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	*pos++ = tkey->tx_iv32 & 0xff;
 1167              	.loc 1 305 0
 1168 0530 8B4624   	movl 36(%esi),%eax
 1169              	.loc 1 304 0
 1170 0533 43       	incl %ebx
 1171              	.loc 1 305 0
 1172 0534 8803     	movb %al,(%ebx)
 306:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	*pos++ = (tkey->tx_iv32 >> 8) & 0xff;
 1173              	.loc 1 306 0
 1174 0536 8B4624   	movl 36(%esi),%eax
GAS LISTING  			page 68


 1175              	.loc 1 305 0
 1176 0539 43       	incl %ebx
 1177              	.loc 1 306 0
 1178 053a C1E808   	shrl $8,%eax
 1179 053d 8803     	movb %al,(%ebx)
 307:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	*pos++ = (tkey->tx_iv32 >> 16) & 0xff;
 1180              	.loc 1 307 0
 1181 053f 0FB74626 	movzwl 38(%esi),%eax
 1182              	.loc 1 306 0
 1183 0543 43       	incl %ebx
 1184              	.loc 1 307 0
 1185 0544 8803     	movb %al,(%ebx)
 308:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	*pos++ = (tkey->tx_iv32 >> 24) & 0xff;
 1186              	.loc 1 308 0
 1187 0546 0FB64627 	movzbl 39(%esi),%eax
 1188 054a 884301   	movb %al,1(%ebx)
 309:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 310:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	tkey->tx_iv16++;
 1189              	.loc 1 310 0
 1190 054d 668B4628 	movw 40(%esi),%ax
 1191 0551 40       	incl %eax
 311:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (tkey->tx_iv16 == 0) {
 1192              	.loc 1 311 0
 1193 0552 83C40C   	addl $12,%esp
 1194              	.LCFI64:
 1195 0555 6685C0   	testw %ax,%ax
 1196              	.loc 1 310 0
 1197 0558 66894628 	movw %ax,40(%esi)
 1198              	.loc 1 311 0
 1199 055c 750A     	jne .L143
 312:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		tkey->tx_phase1_done = 0;
 1200              	.loc 1 312 0
 1201 055e C7463400 	movl $0,52(%esi)
 1201      000000
 313:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		tkey->tx_iv32++;
 1202              	.loc 1 313 0
 1203 0565 FF4624   	incl 36(%esi)
 1204              	.L143:
 314:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 315:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 316:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return 8;
 1205              	.loc 1 316 0
 1206 0568 B8080000 	movl $8,%eax
 1206      00
 1207              	.L134:
 317:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 1208              	.loc 1 317 0
 1209 056d 5B       	popl %ebx
 1210 056e 5E       	popl %esi
 1211 056f 5F       	popl %edi
 1212 0570 5D       	popl %ebp
 1213 0571 C3       	ret
 1214              	.LFE701:
 1216              	.section .rodata.str1.1
 1217              	.LC4:
 1218 0092 3C373E3A 	.string "<7>: TKIP countermeasures: dropped TX packet to %02x:%02x:%02x:%02x:%02x:%02x\n"
 1218      20544B49 
GAS LISTING  			page 69


 1218      5020636F 
 1218      756E7465 
 1218      726D6561 
 1219              	.text
 1221              	ieee80211_tkip_encrypt:
 1222              	.LFB702:
 318:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 319:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static int ieee80211_tkip_encrypt(struct sk_buff *skb, int hdr_len, void *priv)
 320:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 1223              	.loc 1 320 0
 1224 0572 55       	pushl %ebp
 1225              	.LCFI65:
 1226 0573 57       	pushl %edi
 1227              	.LCFI66:
 1228 0574 56       	pushl %esi
 1229              	.LCFI67:
 1230 0575 53       	pushl %ebx
 1231              	.LCFI68:
 1232 0576 83EC24   	subl $36,%esp
 1233              	.LCFI69:
 1234              	.loc 1 320 0
 1235 0579 8B6C2440 	movl 64(%esp),%ebp
 321:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_tkip_data *tkey = priv;
 322:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	int len;
 323:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u8 rc4key[16], *pos, *icv;
 324:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u32 crc;
 325:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct scatterlist sg;
 326:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 327:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (tkey->flags & IEEE80211_CRYPTO_TKIP_COUNTERMEASURES) {
 1236              	.loc 1 327 0
 1237 057d F6858C00 	testb $1,140(%ebp)
 1237      000001
 1238              	.loc 1 320 0
 1239 0584 8B5C2438 	movl 56(%esp),%ebx
 1240 0588 8B54243C 	movl 60(%esp),%edx
 1241              	.loc 1 327 0
 1242 058c 743C     	je .L145
 328:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		if (net_ratelimit()) {
 1243              	.loc 1 328 0
 1244 058e E8FCFFFF 	call net_ratelimit
 1244      FF
 1245 0593 85C0     	testl %eax,%eax
 1246 0595 7451     	je .L148
 1247              	.LBB75:
 329:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			struct ieee80211_hdr_4addr *hdr =
 1248              	.loc 1 329 0
 1249 0597 8B93A800 	movl 168(%ebx),%edx
 1249      0000
 330:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			    (struct ieee80211_hdr_4addr *)skb->data;
 331:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			printk(KERN_DEBUG ": TKIP countermeasures: dropped "
 1250              	.loc 1 331 0
 1251 059d 0FB64209 	movzbl 9(%edx),%eax
 1252 05a1 50       	pushl %eax
 1253              	.LCFI70:
 1254 05a2 0FB64208 	movzbl 8(%edx),%eax
 1255 05a6 50       	pushl %eax
 1256              	.LCFI71:
GAS LISTING  			page 70


 1257 05a7 0FB64207 	movzbl 7(%edx),%eax
 1258 05ab 50       	pushl %eax
 1259              	.LCFI72:
 1260 05ac 0FB64206 	movzbl 6(%edx),%eax
 1261 05b0 50       	pushl %eax
 1262              	.LCFI73:
 1263 05b1 0FB64205 	movzbl 5(%edx),%eax
 1264 05b5 50       	pushl %eax
 1265              	.LCFI74:
 1266 05b6 0FB64204 	movzbl 4(%edx),%eax
 1267 05ba 50       	pushl %eax
 1268              	.LCFI75:
 1269 05bb 68920000 	pushl $.LC4
 1269      00
 1270              	.LCFI76:
 1271 05c0 E8FCFFFF 	call printk
 1271      FF
 1272              	.LBE75:
 1273 05c5 83C41C   	addl $28,%esp
 1274              	.LCFI77:
 1275 05c8 EB1E     	jmp .L148
 1276              	.L145:
 1277              	.LBB76:
 1278              	.LBB77:
 1279              	.loc 5 702 0
 1280 05ca 837B6400 	cmpl $0,100(%ebx)
 1281 05ce 7518     	jne .L148
 1282 05d0 8B83B000 	movl 176(%ebx),%eax
 1282      0000
 1283 05d6 2B83AC00 	subl 172(%ebx),%eax
 1283      0000
 1284              	.LBE77:
 1285              	.LBE76:
 848:include/linux/skbuff.h **** }
 849:include/linux/skbuff.h **** 
 850:include/linux/skbuff.h **** /**
 851:include/linux/skbuff.h ****  *	skb_tailroom - bytes at buffer end
 852:include/linux/skbuff.h ****  *	@skb: buffer to check
 853:include/linux/skbuff.h ****  *
 854:include/linux/skbuff.h ****  *	Return the number of bytes of free space at the tail of an sk_buff
 855:include/linux/skbuff.h ****  */
 856:include/linux/skbuff.h **** static inline int skb_tailroom(const struct sk_buff *skb)
 857:include/linux/skbuff.h **** {
 1286              	.loc 5 857 0
 1287 05dc 83F803   	cmpl $3,%eax
 1288 05df 7E07     	jle .L148
 1289 05e1 8B4360   	movl 96(%ebx),%eax
 1290 05e4 39D0     	cmpl %edx,%eax
 1291 05e6 7308     	jae .L147
 1292              	.L148:
 332:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       "TX packet to " MAC_FMT "\n",
 333:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       MAC_ARG(hdr->addr1));
 334:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		}
 335:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 336:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 337:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 338:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (skb_tailroom(skb) < 4 || skb->len < hdr_len)
GAS LISTING  			page 71


 339:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 1293              	.loc 1 339 0
 1294 05e8 83CAFF   	orl $-1,%edx
 1295 05eb E9E60000 	jmp .L144
 1295      00
 1296              	.L147:
 340:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 341:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	len = skb->len - hdr_len;
 1297              	.loc 1 341 0
 1298 05f0 29D0     	subl %edx,%eax
 1299 05f2 890424   	movl %eax,(%esp)
 342:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	pos = skb->data + hdr_len;
 1300              	.loc 1 342 0
 1301 05f5 8BBBA800 	movl 168(%ebx),%edi
 1301      0000
 343:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 344:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if ((ieee80211_tkip_hdr(skb, hdr_len, rc4key, 16, priv)) < 0)
 1302              	.loc 1 344 0
 1303 05fb 55       	pushl %ebp
 1304              	.LCFI78:
 1305 05fc 6A10     	pushl $16
 1306              	.LCFI79:
 1307 05fe 8D44241C 	leal 28(%esp),%eax
 1308 0602 50       	pushl %eax
 1309              	.LCFI80:
 1310 0603 52       	pushl %edx
 1311              	.LCFI81:
 1312 0604 53       	pushl %ebx
 1313              	.LCFI82:
 1314              	.loc 1 342 0
 1315 0605 01D7     	addl %edx,%edi
 1316              	.loc 1 344 0
 1317 0607 E856FEFF 	call ieee80211_tkip_hdr
 1317      FF
 1318 060c 83C414   	addl $20,%esp
 1319              	.LCFI83:
 345:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 1320              	.loc 1 345 0
 1321 060f 83CAFF   	orl $-1,%edx
 1322              	.loc 1 344 0
 1323 0612 85C0     	testl %eax,%eax
 1324 0614 0F88BC00 	js .L144
 1324      0000
 1325              	.LBB78:
 1326              	.LBB79:
 1327              	.loc 5 702 0
 1328 061a 837B6400 	cmpl $0,100(%ebx)
 1329              	.loc 5 758 0
 1330 061e 8BB3AC00 	movl 172(%ebx),%esi
 1330      0000
 1331              	.loc 5 702 0
 1332 0624 7402     	je .L154
 1333              	.loc 5 759 0
 1334              	
 1335 0626 0F0B     	ud2
 1336              	
 1337              	
GAS LISTING  			page 72


 1338              	.L154:
 1339              	.loc 5 760 0
 1340 0628 8D4604   	leal 4(%esi),%eax
 1341              	.loc 5 761 0
 1342 062b 83436004 	addl $4,96(%ebx)
 1343              	.loc 5 762 0
 1344 062f 3B83B000 	cmpl 176(%ebx),%eax
 1344      0000
 1345              	.loc 5 760 0
 1346 0635 8983AC00 	movl %eax,172(%ebx)
 1346      0000
 1347              	.loc 5 762 0
 1348 063b 7611     	jbe .L157
 1349              	.LBB80:
 1350              	.loc 5 763 0
 1351              	
 1352 063d B8420600 	movl $1f,%eax
 1352      00
 1353              	1:
 1354              	
 1355              	.LBE80:
 1356 0642 50       	pushl %eax
 1357              	.LCFI84:
 1358 0643 6A04     	pushl $4
 1359              	.LCFI85:
 1360 0645 53       	pushl %ebx
 1361              	.LCFI86:
 1362 0646 E8FCFFFF 	call skb_over_panic
 1362      FF
 1363 064b 83C40C   	addl $12,%esp
 1364              	.LCFI87:
 1365              	.L157:
 1366              	.LBE79:
 1367              	.LBE78:
 346:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 347:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	icv = skb_put(skb, 4);
 348:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 349:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	crc = ~crc32_le(~0, pos, len);
 1368              	.loc 1 349 0
 1369 064e FF3424   	pushl (%esp)
 1370              	.LCFI88:
 1371 0651 57       	pushl %edi
 1372              	.LCFI89:
 1373 0652 6AFF     	pushl $-1
 1374              	.LCFI90:
 1375 0654 E8FCFFFF 	call crc32_le
 1375      FF
 1376 0659 F7D0     	notl %eax
 350:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	icv[0] = crc;
 1377              	.loc 1 350 0
 1378 065b 8806     	movb %al,(%esi)
 351:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	icv[1] = crc >> 8;
 1379              	.loc 1 351 0
 1380 065d C1E808   	shrl $8,%eax
 1381 0660 884601   	movb %al,1(%esi)
 352:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	icv[2] = crc >> 16;
 1382              	.loc 1 352 0
GAS LISTING  			page 73


 1383 0663 C1E808   	shrl $8,%eax
 1384 0666 884602   	movb %al,2(%esi)
 353:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	icv[3] = crc >> 24;
 1385              	.loc 1 353 0
 1386 0669 C1E808   	shrl $8,%eax
 1387 066c 884603   	movb %al,3(%esi)
 1388              	.LBB81:
 1389              	.file 6 "include/linux/crypto.h"
   1:include/linux/crypto.h **** /*
   2:include/linux/crypto.h ****  * Scatterlist Cryptographic API.
   3:include/linux/crypto.h ****  *
   4:include/linux/crypto.h ****  * Copyright (c) 2002 James Morris <jmorris@intercode.com.au>
   5:include/linux/crypto.h ****  * Copyright (c) 2002 David S. Miller (davem@redhat.com)
   6:include/linux/crypto.h ****  *
   7:include/linux/crypto.h ****  * Portions derived from Cryptoapi, by Alexander Kjeldaas <astor@fast.no>
   8:include/linux/crypto.h ****  * and Nettle, by Niels Mller.
   9:include/linux/crypto.h ****  * 
  10:include/linux/crypto.h ****  * This program is free software; you can redistribute it and/or modify it
  11:include/linux/crypto.h ****  * under the terms of the GNU General Public License as published by the Free
  12:include/linux/crypto.h ****  * Software Foundation; either version 2 of the License, or (at your option) 
  13:include/linux/crypto.h ****  * any later version.
  14:include/linux/crypto.h ****  *
  15:include/linux/crypto.h ****  */
  16:include/linux/crypto.h **** #ifndef _LINUX_CRYPTO_H
  17:include/linux/crypto.h **** #define _LINUX_CRYPTO_H
  18:include/linux/crypto.h **** 
  19:include/linux/crypto.h **** #include <linux/config.h>
  20:include/linux/crypto.h **** #include <linux/module.h>
  21:include/linux/crypto.h **** #include <linux/kernel.h>
  22:include/linux/crypto.h **** #include <linux/types.h>
  23:include/linux/crypto.h **** #include <linux/list.h>
  24:include/linux/crypto.h **** #include <linux/string.h>
  25:include/linux/crypto.h **** #include <asm/page.h>
  26:include/linux/crypto.h **** 
  27:include/linux/crypto.h **** /*
  28:include/linux/crypto.h ****  * Algorithm masks and types.
  29:include/linux/crypto.h ****  */
  30:include/linux/crypto.h **** #define CRYPTO_ALG_TYPE_MASK		0x000000ff
  31:include/linux/crypto.h **** #define CRYPTO_ALG_TYPE_CIPHER		0x00000001
  32:include/linux/crypto.h **** #define CRYPTO_ALG_TYPE_DIGEST		0x00000002
  33:include/linux/crypto.h **** #define CRYPTO_ALG_TYPE_COMPRESS	0x00000004
  34:include/linux/crypto.h **** 
  35:include/linux/crypto.h **** /*
  36:include/linux/crypto.h ****  * Transform masks and values (for crt_flags).
  37:include/linux/crypto.h ****  */
  38:include/linux/crypto.h **** #define CRYPTO_TFM_MODE_MASK		0x000000ff
  39:include/linux/crypto.h **** #define CRYPTO_TFM_REQ_MASK		0x000fff00
  40:include/linux/crypto.h **** #define CRYPTO_TFM_RES_MASK		0xfff00000
  41:include/linux/crypto.h **** 
  42:include/linux/crypto.h **** #define CRYPTO_TFM_MODE_ECB		0x00000001
  43:include/linux/crypto.h **** #define CRYPTO_TFM_MODE_CBC		0x00000002
  44:include/linux/crypto.h **** #define CRYPTO_TFM_MODE_CFB		0x00000004
  45:include/linux/crypto.h **** #define CRYPTO_TFM_MODE_CTR		0x00000008
  46:include/linux/crypto.h **** 
  47:include/linux/crypto.h **** #define CRYPTO_TFM_REQ_WEAK_KEY		0x00000100
  48:include/linux/crypto.h **** #define CRYPTO_TFM_RES_WEAK_KEY		0x00100000
  49:include/linux/crypto.h **** #define CRYPTO_TFM_RES_BAD_KEY_LEN   	0x00200000
GAS LISTING  			page 74


  50:include/linux/crypto.h **** #define CRYPTO_TFM_RES_BAD_KEY_SCHED 	0x00400000
  51:include/linux/crypto.h **** #define CRYPTO_TFM_RES_BAD_BLOCK_LEN 	0x00800000
  52:include/linux/crypto.h **** #define CRYPTO_TFM_RES_BAD_FLAGS 	0x01000000
  53:include/linux/crypto.h **** 
  54:include/linux/crypto.h **** /*
  55:include/linux/crypto.h ****  * Miscellaneous stuff.
  56:include/linux/crypto.h ****  */
  57:include/linux/crypto.h **** #define CRYPTO_UNSPEC			0
  58:include/linux/crypto.h **** #define CRYPTO_MAX_ALG_NAME		64
  59:include/linux/crypto.h **** 
  60:include/linux/crypto.h **** #define CRYPTO_DIR_ENCRYPT		1
  61:include/linux/crypto.h **** #define CRYPTO_DIR_DECRYPT		0
  62:include/linux/crypto.h **** 
  63:include/linux/crypto.h **** struct scatterlist;
  64:include/linux/crypto.h **** 
  65:include/linux/crypto.h **** /*
  66:include/linux/crypto.h ****  * Algorithms: modular crypto algorithm implementations, managed
  67:include/linux/crypto.h ****  * via crypto_register_alg() and crypto_unregister_alg().
  68:include/linux/crypto.h ****  */
  69:include/linux/crypto.h **** struct cipher_alg {
  70:include/linux/crypto.h **** 	unsigned int cia_min_keysize;
  71:include/linux/crypto.h **** 	unsigned int cia_max_keysize;
  72:include/linux/crypto.h **** 	int (*cia_setkey)(void *ctx, const u8 *key,
  73:include/linux/crypto.h **** 	                  unsigned int keylen, u32 *flags);
  74:include/linux/crypto.h **** 	void (*cia_encrypt)(void *ctx, u8 *dst, const u8 *src);
  75:include/linux/crypto.h **** 	void (*cia_decrypt)(void *ctx, u8 *dst, const u8 *src);
  76:include/linux/crypto.h **** };
  77:include/linux/crypto.h **** 
  78:include/linux/crypto.h **** struct digest_alg {
  79:include/linux/crypto.h **** 	unsigned int dia_digestsize;
  80:include/linux/crypto.h **** 	void (*dia_init)(void *ctx);
  81:include/linux/crypto.h **** 	void (*dia_update)(void *ctx, const u8 *data, unsigned int len);
  82:include/linux/crypto.h **** 	void (*dia_final)(void *ctx, u8 *out);
  83:include/linux/crypto.h **** 	int (*dia_setkey)(void *ctx, const u8 *key,
  84:include/linux/crypto.h **** 	                  unsigned int keylen, u32 *flags);
  85:include/linux/crypto.h **** };
  86:include/linux/crypto.h **** 
  87:include/linux/crypto.h **** struct compress_alg {
  88:include/linux/crypto.h **** 	int (*coa_init)(void *ctx);
  89:include/linux/crypto.h **** 	void (*coa_exit)(void *ctx);
  90:include/linux/crypto.h **** 	int (*coa_compress)(void *ctx, const u8 *src, unsigned int slen,
  91:include/linux/crypto.h **** 	                    u8 *dst, unsigned int *dlen);
  92:include/linux/crypto.h **** 	int (*coa_decompress)(void *ctx, const u8 *src, unsigned int slen,
  93:include/linux/crypto.h **** 	                      u8 *dst, unsigned int *dlen);
  94:include/linux/crypto.h **** };
  95:include/linux/crypto.h **** 
  96:include/linux/crypto.h **** #define cra_cipher	cra_u.cipher
  97:include/linux/crypto.h **** #define cra_digest	cra_u.digest
  98:include/linux/crypto.h **** #define cra_compress	cra_u.compress
  99:include/linux/crypto.h **** 
 100:include/linux/crypto.h **** struct crypto_alg {
 101:include/linux/crypto.h **** 	struct list_head cra_list;
 102:include/linux/crypto.h **** 	u32 cra_flags;
 103:include/linux/crypto.h **** 	unsigned int cra_blocksize;
 104:include/linux/crypto.h **** 	unsigned int cra_ctxsize;
 105:include/linux/crypto.h **** 	const char cra_name[CRYPTO_MAX_ALG_NAME];
 106:include/linux/crypto.h **** 
GAS LISTING  			page 75


 107:include/linux/crypto.h **** 	union {
 108:include/linux/crypto.h **** 		struct cipher_alg cipher;
 109:include/linux/crypto.h **** 		struct digest_alg digest;
 110:include/linux/crypto.h **** 		struct compress_alg compress;
 111:include/linux/crypto.h **** 	} cra_u;
 112:include/linux/crypto.h **** 	
 113:include/linux/crypto.h **** 	struct module *cra_module;
 114:include/linux/crypto.h **** };
 115:include/linux/crypto.h **** 
 116:include/linux/crypto.h **** /*
 117:include/linux/crypto.h ****  * Algorithm registration interface.
 118:include/linux/crypto.h ****  */
 119:include/linux/crypto.h **** int crypto_register_alg(struct crypto_alg *alg);
 120:include/linux/crypto.h **** int crypto_unregister_alg(struct crypto_alg *alg);
 121:include/linux/crypto.h **** 
 122:include/linux/crypto.h **** /*
 123:include/linux/crypto.h ****  * Algorithm query interface.
 124:include/linux/crypto.h ****  */
 125:include/linux/crypto.h **** #ifdef CONFIG_CRYPTO
 126:include/linux/crypto.h **** int crypto_alg_available(const char *name, u32 flags);
 127:include/linux/crypto.h **** #else
 128:include/linux/crypto.h **** static inline int crypto_alg_available(const char *name, u32 flags)
 129:include/linux/crypto.h **** {
 130:include/linux/crypto.h **** 	return 0;
 131:include/linux/crypto.h **** }
 132:include/linux/crypto.h **** #endif
 133:include/linux/crypto.h **** 
 134:include/linux/crypto.h **** /*
 135:include/linux/crypto.h ****  * Transforms: user-instantiated objects which encapsulate algorithms
 136:include/linux/crypto.h ****  * and core processing logic.  Managed via crypto_alloc_tfm() and
 137:include/linux/crypto.h ****  * crypto_free_tfm(), as well as the various helpers below.
 138:include/linux/crypto.h ****  */
 139:include/linux/crypto.h **** struct crypto_tfm;
 140:include/linux/crypto.h **** 
 141:include/linux/crypto.h **** struct cipher_tfm {
 142:include/linux/crypto.h **** 	void *cit_iv;
 143:include/linux/crypto.h **** 	unsigned int cit_ivsize;
 144:include/linux/crypto.h **** 	u32 cit_mode;
 145:include/linux/crypto.h **** 	int (*cit_setkey)(struct crypto_tfm *tfm,
 146:include/linux/crypto.h **** 	                  const u8 *key, unsigned int keylen);
 147:include/linux/crypto.h **** 	int (*cit_encrypt)(struct crypto_tfm *tfm,
 148:include/linux/crypto.h **** 			   struct scatterlist *dst,
 149:include/linux/crypto.h **** 			   struct scatterlist *src,
 150:include/linux/crypto.h **** 			   unsigned int nbytes);
 151:include/linux/crypto.h **** 	int (*cit_encrypt_iv)(struct crypto_tfm *tfm,
 152:include/linux/crypto.h **** 	                      struct scatterlist *dst,
 153:include/linux/crypto.h **** 	                      struct scatterlist *src,
 154:include/linux/crypto.h **** 	                      unsigned int nbytes, u8 *iv);
 155:include/linux/crypto.h **** 	int (*cit_decrypt)(struct crypto_tfm *tfm,
 156:include/linux/crypto.h **** 			   struct scatterlist *dst,
 157:include/linux/crypto.h **** 			   struct scatterlist *src,
 158:include/linux/crypto.h **** 			   unsigned int nbytes);
 159:include/linux/crypto.h **** 	int (*cit_decrypt_iv)(struct crypto_tfm *tfm,
 160:include/linux/crypto.h **** 			   struct scatterlist *dst,
 161:include/linux/crypto.h **** 			   struct scatterlist *src,
 162:include/linux/crypto.h **** 			   unsigned int nbytes, u8 *iv);
 163:include/linux/crypto.h **** 	void (*cit_xor_block)(u8 *dst, const u8 *src);
GAS LISTING  			page 76


 164:include/linux/crypto.h **** };
 165:include/linux/crypto.h **** 
 166:include/linux/crypto.h **** struct digest_tfm {
 167:include/linux/crypto.h **** 	void (*dit_init)(struct crypto_tfm *tfm);
 168:include/linux/crypto.h **** 	void (*dit_update)(struct crypto_tfm *tfm,
 169:include/linux/crypto.h **** 	                   struct scatterlist *sg, unsigned int nsg);
 170:include/linux/crypto.h **** 	void (*dit_final)(struct crypto_tfm *tfm, u8 *out);
 171:include/linux/crypto.h **** 	void (*dit_digest)(struct crypto_tfm *tfm, struct scatterlist *sg,
 172:include/linux/crypto.h **** 	                   unsigned int nsg, u8 *out);
 173:include/linux/crypto.h **** 	int (*dit_setkey)(struct crypto_tfm *tfm,
 174:include/linux/crypto.h **** 	                  const u8 *key, unsigned int keylen);
 175:include/linux/crypto.h **** #ifdef CONFIG_CRYPTO_HMAC
 176:include/linux/crypto.h **** 	void *dit_hmac_block;
 177:include/linux/crypto.h **** #endif
 178:include/linux/crypto.h **** };
 179:include/linux/crypto.h **** 
 180:include/linux/crypto.h **** struct compress_tfm {
 181:include/linux/crypto.h **** 	int (*cot_compress)(struct crypto_tfm *tfm,
 182:include/linux/crypto.h **** 	                    const u8 *src, unsigned int slen,
 183:include/linux/crypto.h **** 	                    u8 *dst, unsigned int *dlen);
 184:include/linux/crypto.h **** 	int (*cot_decompress)(struct crypto_tfm *tfm,
 185:include/linux/crypto.h **** 	                      const u8 *src, unsigned int slen,
 186:include/linux/crypto.h **** 	                      u8 *dst, unsigned int *dlen);
 187:include/linux/crypto.h **** };
 188:include/linux/crypto.h **** 
 189:include/linux/crypto.h **** #define crt_cipher	crt_u.cipher
 190:include/linux/crypto.h **** #define crt_digest	crt_u.digest
 191:include/linux/crypto.h **** #define crt_compress	crt_u.compress
 192:include/linux/crypto.h **** 
 193:include/linux/crypto.h **** struct crypto_tfm {
 194:include/linux/crypto.h **** 
 195:include/linux/crypto.h **** 	u32 crt_flags;
 196:include/linux/crypto.h **** 	
 197:include/linux/crypto.h **** 	union {
 198:include/linux/crypto.h **** 		struct cipher_tfm cipher;
 199:include/linux/crypto.h **** 		struct digest_tfm digest;
 200:include/linux/crypto.h **** 		struct compress_tfm compress;
 201:include/linux/crypto.h **** 	} crt_u;
 202:include/linux/crypto.h **** 	
 203:include/linux/crypto.h **** 	struct crypto_alg *__crt_alg;
 204:include/linux/crypto.h **** };
 205:include/linux/crypto.h **** 
 206:include/linux/crypto.h **** /* 
 207:include/linux/crypto.h ****  * Transform user interface.
 208:include/linux/crypto.h ****  */
 209:include/linux/crypto.h ****  
 210:include/linux/crypto.h **** /*
 211:include/linux/crypto.h ****  * crypto_alloc_tfm() will first attempt to locate an already loaded algorithm.
 212:include/linux/crypto.h ****  * If that fails and the kernel supports dynamically loadable modules, it
 213:include/linux/crypto.h ****  * will then attempt to load a module of the same name or alias.  A refcount
 214:include/linux/crypto.h ****  * is grabbed on the algorithm which is then associated with the new transform.
 215:include/linux/crypto.h ****  *
 216:include/linux/crypto.h ****  * crypto_free_tfm() frees up the transform and any associated resources,
 217:include/linux/crypto.h ****  * then drops the refcount on the associated algorithm.
 218:include/linux/crypto.h ****  */
 219:include/linux/crypto.h **** struct crypto_tfm *crypto_alloc_tfm(const char *alg_name, u32 tfm_flags);
 220:include/linux/crypto.h **** void crypto_free_tfm(struct crypto_tfm *tfm);
GAS LISTING  			page 77


 221:include/linux/crypto.h **** 
 222:include/linux/crypto.h **** /*
 223:include/linux/crypto.h ****  * Transform helpers which query the underlying algorithm.
 224:include/linux/crypto.h ****  */
 225:include/linux/crypto.h **** static inline const char *crypto_tfm_alg_name(struct crypto_tfm *tfm)
 226:include/linux/crypto.h **** {
 227:include/linux/crypto.h **** 	return tfm->__crt_alg->cra_name;
 228:include/linux/crypto.h **** }
 229:include/linux/crypto.h **** 
 230:include/linux/crypto.h **** static inline const char *crypto_tfm_alg_modname(struct crypto_tfm *tfm)
 231:include/linux/crypto.h **** {
 232:include/linux/crypto.h **** 	return module_name(tfm->__crt_alg->cra_module);
 233:include/linux/crypto.h **** }
 234:include/linux/crypto.h **** 
 235:include/linux/crypto.h **** static inline u32 crypto_tfm_alg_type(struct crypto_tfm *tfm)
 236:include/linux/crypto.h **** {
 237:include/linux/crypto.h **** 	return tfm->__crt_alg->cra_flags & CRYPTO_ALG_TYPE_MASK;
 238:include/linux/crypto.h **** }
 239:include/linux/crypto.h **** 
 240:include/linux/crypto.h **** static inline unsigned int crypto_tfm_alg_min_keysize(struct crypto_tfm *tfm)
 241:include/linux/crypto.h **** {
 242:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_CIPHER);
 243:include/linux/crypto.h **** 	return tfm->__crt_alg->cra_cipher.cia_min_keysize;
 244:include/linux/crypto.h **** }
 245:include/linux/crypto.h **** 
 246:include/linux/crypto.h **** static inline unsigned int crypto_tfm_alg_max_keysize(struct crypto_tfm *tfm)
 247:include/linux/crypto.h **** {
 248:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_CIPHER);
 249:include/linux/crypto.h **** 	return tfm->__crt_alg->cra_cipher.cia_max_keysize;
 250:include/linux/crypto.h **** }
 251:include/linux/crypto.h **** 
 252:include/linux/crypto.h **** static inline unsigned int crypto_tfm_alg_ivsize(struct crypto_tfm *tfm)
 253:include/linux/crypto.h **** {
 254:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_CIPHER);
 255:include/linux/crypto.h **** 	return tfm->crt_cipher.cit_ivsize;
 256:include/linux/crypto.h **** }
 257:include/linux/crypto.h **** 
 258:include/linux/crypto.h **** static inline unsigned int crypto_tfm_alg_blocksize(struct crypto_tfm *tfm)
 259:include/linux/crypto.h **** {
 260:include/linux/crypto.h **** 	return tfm->__crt_alg->cra_blocksize;
 261:include/linux/crypto.h **** }
 262:include/linux/crypto.h **** 
 263:include/linux/crypto.h **** static inline unsigned int crypto_tfm_alg_digestsize(struct crypto_tfm *tfm)
 264:include/linux/crypto.h **** {
 265:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_DIGEST);
 266:include/linux/crypto.h **** 	return tfm->__crt_alg->cra_digest.dia_digestsize;
 267:include/linux/crypto.h **** }
 268:include/linux/crypto.h **** 
 269:include/linux/crypto.h **** /*
 270:include/linux/crypto.h ****  * API wrappers.
 271:include/linux/crypto.h ****  */
 272:include/linux/crypto.h **** static inline void crypto_digest_init(struct crypto_tfm *tfm)
 273:include/linux/crypto.h **** {
 274:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_DIGEST);
 275:include/linux/crypto.h **** 	tfm->crt_digest.dit_init(tfm);
 276:include/linux/crypto.h **** }
 277:include/linux/crypto.h **** 
GAS LISTING  			page 78


 278:include/linux/crypto.h **** static inline void crypto_digest_update(struct crypto_tfm *tfm,
 279:include/linux/crypto.h ****                                         struct scatterlist *sg,
 280:include/linux/crypto.h ****                                         unsigned int nsg)
 281:include/linux/crypto.h **** {
 282:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_DIGEST);
 283:include/linux/crypto.h **** 	tfm->crt_digest.dit_update(tfm, sg, nsg);
 284:include/linux/crypto.h **** }
 285:include/linux/crypto.h **** 
 286:include/linux/crypto.h **** static inline void crypto_digest_final(struct crypto_tfm *tfm, u8 *out)
 287:include/linux/crypto.h **** {
 288:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_DIGEST);
 289:include/linux/crypto.h **** 	tfm->crt_digest.dit_final(tfm, out);
 290:include/linux/crypto.h **** }
 291:include/linux/crypto.h **** 
 292:include/linux/crypto.h **** static inline void crypto_digest_digest(struct crypto_tfm *tfm,
 293:include/linux/crypto.h ****                                         struct scatterlist *sg,
 294:include/linux/crypto.h ****                                         unsigned int nsg, u8 *out)
 295:include/linux/crypto.h **** {
 296:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_DIGEST);
 297:include/linux/crypto.h **** 	tfm->crt_digest.dit_digest(tfm, sg, nsg, out);
 298:include/linux/crypto.h **** }
 299:include/linux/crypto.h **** 
 300:include/linux/crypto.h **** static inline int crypto_digest_setkey(struct crypto_tfm *tfm,
 301:include/linux/crypto.h ****                                        const u8 *key, unsigned int keylen)
 302:include/linux/crypto.h **** {
 303:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_DIGEST);
 304:include/linux/crypto.h **** 	if (tfm->crt_digest.dit_setkey == NULL)
 305:include/linux/crypto.h **** 		return -ENOSYS;
 306:include/linux/crypto.h **** 	return tfm->crt_digest.dit_setkey(tfm, key, keylen);
 307:include/linux/crypto.h **** }
 308:include/linux/crypto.h **** 
 309:include/linux/crypto.h **** static inline int crypto_cipher_setkey(struct crypto_tfm *tfm,
 310:include/linux/crypto.h ****                                        const u8 *key, unsigned int keylen)
 311:include/linux/crypto.h **** {
 1390              	.loc 6 311 0
 1391 066f 8B5564   	movl 100(%ebp),%edx
 1392              	.LBB82:
 1393              	.LBB83:
 1394              	.LBB84:
 1395              	.loc 6 237 0
 1396 0672 8B4228   	movl 40(%edx),%eax
 1397              	.LBE84:
 1398              	.LBE83:
 1399              	.LBE82:
 1400              	.LBE81:
 1401              	.loc 6 311 0
 1402 0675 83C40C   	addl $12,%esp
 1403              	.LCFI91:
 1404              	.LBB85:
 1405              	.LBB86:
 1406              	.loc 6 236 0
 1407 0678 80780801 	cmpb $1,8(%eax)
 1408 067c 7402     	je .L159
 312:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_CIPHER);
 1409              	.loc 6 312 0
 1410              	
 1411 067e 0F0B     	ud2
GAS LISTING  			page 79


 1412              	
 1413              	
 1414              	.L159:
 1415 0680 6A10     	pushl $16
 1416              	.LCFI92:
 1417 0682 8D442418 	leal 24(%esp),%eax
 1418 0686 50       	pushl %eax
 1419              	.LCFI93:
 1420 0687 52       	pushl %edx
 1421              	.LCFI94:
 1422 0688 FF5210   	call *16(%edx)
 1423              	.LBE86:
 1424              	.LBE85:
 354:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 355:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	crypto_cipher_setkey(tkey->tfm_arc4, rc4key, 16);
 356:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sg.page = virt_to_page(pos);
 1425              	.loc 1 356 0
 1426 068b 8D870000 	leal 1073741824(%edi),%eax
 1426      0040
 1427              	.LBB87:
 1428              	.LBB88:
 1429              	.loc 6 312 0
 1430 0691 83C40C   	addl $12,%esp
 1431              	.LCFI95:
 1432              	.LBE88:
 1433              	.LBE87:
 1434              	.loc 1 356 0
 1435 0694 C1E80C   	shrl $12,%eax
 1436 0697 C1E005   	sall $5,%eax
 357:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sg.offset = offset_in_page(pos);
 358:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sg.length = len + 4;
 1437              	.loc 1 358 0
 1438 069a 8B0C24   	movl (%esp),%ecx
 1439              	.loc 1 356 0
 1440 069d 03050000 	addl mem_map,%eax
 1440      0000
 1441              	.loc 1 357 0
 1442 06a3 81E7FF0F 	andl $4095,%edi
 1442      0000
 1443              	.loc 1 358 0
 1444 06a9 83C104   	addl $4,%ecx
 1445              	.loc 1 356 0
 1446 06ac 89442404 	movl %eax,4(%esp)
 1447              	.loc 1 357 0
 1448 06b0 897C2408 	movl %edi,8(%esp)
 1449              	.loc 1 358 0
 1450 06b4 894C2410 	movl %ecx,16(%esp)
 1451              	.LBB89:
 313:include/linux/crypto.h **** 	return tfm->crt_cipher.cit_setkey(tfm, key, keylen);
 314:include/linux/crypto.h **** }
 315:include/linux/crypto.h **** 
 316:include/linux/crypto.h **** static inline int crypto_cipher_encrypt(struct crypto_tfm *tfm,
 317:include/linux/crypto.h ****                                         struct scatterlist *dst,
 318:include/linux/crypto.h ****                                         struct scatterlist *src,
 319:include/linux/crypto.h ****                                         unsigned int nbytes)
 320:include/linux/crypto.h **** {
 1452              	.loc 6 320 0
GAS LISTING  			page 80


 1453 06b8 8B5564   	movl 100(%ebp),%edx
 1454              	.LBB90:
 1455              	.LBB91:
 1456              	.LBB92:
 1457              	.loc 6 237 0
 1458 06bb 8B4228   	movl 40(%edx),%eax
 1459              	.LBE92:
 1460              	.LBE91:
 1461              	.loc 6 236 0
 1462 06be 80780801 	cmpb $1,8(%eax)
 1463              	.LBE90:
 1464              	.loc 6 320 0
 1465 06c2 8D5C2404 	leal 4(%esp),%ebx
 1466              	.LBB93:
 1467              	.loc 6 236 0
 1468 06c6 7402     	je .L163
 321:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_CIPHER);
 1469              	.loc 6 321 0
 1470              	
 1471 06c8 0F0B     	ud2
 1472              	
 1473              	
 1474              	.L163:
 1475 06ca 51       	pushl %ecx
 1476              	.LCFI96:
 1477 06cb 53       	pushl %ebx
 1478              	.LCFI97:
 1479 06cc 53       	pushl %ebx
 1480              	.LCFI98:
 1481 06cd 52       	pushl %edx
 1482              	.LCFI99:
 1483 06ce FF5214   	call *20(%edx)
 1484 06d1 83C410   	addl $16,%esp
 1485              	.LCFI100:
 1486              	.LBE93:
 1487              	.LBE89:
 359:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	crypto_cipher_encrypt(tkey->tfm_arc4, &sg, &sg, len + 4);
 360:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 361:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return 0;
 1488              	.loc 1 361 0
 1489 06d4 31D2     	xorl %edx,%edx
 1490              	.L144:
 362:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 1491              	.loc 1 362 0
 1492 06d6 83C424   	addl $36,%esp
 1493 06d9 5B       	popl %ebx
 1494 06da 5E       	popl %esi
 1495 06db 5F       	popl %edi
 1496 06dc 89D0     	movl %edx,%eax
 1497 06de 5D       	popl %ebp
 1498 06df C3       	ret
 1499              	.LFE702:
 1501              	.section .rodata.str1.1
 1502              	.LC5:
 1503 00e1 3C373E3A 	.string "<7>: TKIP countermeasures: dropped received packet from %02x:%02x:%02x:%02x:%02x:%02x\n"
 1503      20544B49 
 1503      5020636F 
GAS LISTING  			page 81


 1503      756E7465 
 1503      726D6561 
 1504              	.LC6:
 1505 0138 3C373E54 	.string "<7>TKIP: received packet without ExtIV flag from %02x:%02x:%02x:%02x:%02x:%02x\n"
 1505      4B49503A 
 1505      20726563 
 1505      65697665 
 1505      64207061 
 1506              	.LC7:
 1507 0188 3C373E54 	.string "<7>TKIP: RX tkey->key_idx=%d frame keyidx=%d priv=%p\n"
 1507      4B49503A 
 1507      20525820 
 1507      746B6579 
 1507      2D3E6B65 
 1508              	.LC8:
 1509 01be 3C373E54 	.string "<7>TKIP: received packet from %02x:%02x:%02x:%02x:%02x:%02x with keyid=%d that does not have a configured key\n"
 1509      4B49503A 
 1509      20726563 
 1509      65697665 
 1509      64207061 
 1510              	.LC9:
 1511 022d 3C373E54 	.string "<7>TKIP: replay detected: STA=%02x:%02x:%02x:%02x:%02x:%02x previous TSC %08x%04x received TSC %08x%04x\n"
 1511      4B49503A 
 1511      20726570 
 1511      6C617920 
 1511      64657465 
 1512              	.LC10:
 1513 0296 3C373E54 	.string "<7>TKIP: ICV error detected: STA=%02x:%02x:%02x:%02x:%02x:%02x\n"
 1513      4B49503A 
 1513      20494356 
 1513      20657272 
 1513      6F722064 
 1514              	.text
 1516              	ieee80211_tkip_decrypt:
 1517              	.LFB703:
 363:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 364:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static int ieee80211_tkip_decrypt(struct sk_buff *skb, int hdr_len, void *priv)
 365:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 1518              	.loc 1 365 0
 1519 06e0 55       	pushl %ebp
 1520              	.LCFI101:
 1521 06e1 57       	pushl %edi
 1522              	.LCFI102:
 1523 06e2 56       	pushl %esi
 1524              	.LCFI103:
 1525 06e3 53       	pushl %ebx
 1526              	.LCFI104:
 1527 06e4 83EC2C   	subl $44,%esp
 1528              	.LCFI105:
 366:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_tkip_data *tkey = priv;
 367:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u8 rc4key[16];
 368:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u8 keyidx, *pos;
 369:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u32 iv32;
 370:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u16 iv16;
 371:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_hdr_4addr *hdr;
 372:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u8 icv[4];
 373:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u32 crc;
GAS LISTING  			page 82


 374:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct scatterlist sg;
 375:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	int plen;
 376:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 377:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	hdr = (struct ieee80211_hdr_4addr *)skb->data;
 378:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 379:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (tkey->flags & IEEE80211_CRYPTO_TKIP_COUNTERMEASURES) {
 1529              	.loc 1 379 0
 1530 06e7 8B542448 	movl 72(%esp),%edx
 1531              	.loc 1 377 0
 1532 06eb 8B442440 	movl 64(%esp),%eax
 1533              	.loc 1 379 0
 1534 06ef F6828C00 	testb $1,140(%edx)
 1534      000001
 1535              	.loc 1 377 0
 1536 06f6 8B98A800 	movl 168(%eax),%ebx
 1536      0000
 1537              	.loc 1 379 0
 1538 06fc 743C     	je .L169
 380:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		if (net_ratelimit()) {
 1539              	.loc 1 380 0
 1540 06fe E8FCFFFF 	call net_ratelimit
 1540      FF
 1541 0703 85C0     	testl %eax,%eax
 1542 0705 742B     	je .L170
 381:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			printk(KERN_DEBUG ": TKIP countermeasures: dropped "
 1543              	.loc 1 381 0
 1544 0707 0FB6430F 	movzbl 15(%ebx),%eax
 1545 070b 50       	pushl %eax
 1546              	.LCFI106:
 1547 070c 0FB6430E 	movzbl 14(%ebx),%eax
 1548 0710 50       	pushl %eax
 1549              	.LCFI107:
 1550 0711 0FB6430D 	movzbl 13(%ebx),%eax
 1551 0715 50       	pushl %eax
 1552              	.LCFI108:
 1553 0716 0FB6430C 	movzbl 12(%ebx),%eax
 1554 071a 50       	pushl %eax
 1555              	.LCFI109:
 1556 071b 0FB6430B 	movzbl 11(%ebx),%eax
 1557 071f 50       	pushl %eax
 1558              	.LCFI110:
 1559 0720 0FB6430A 	movzbl 10(%ebx),%eax
 1560 0724 50       	pushl %eax
 1561              	.LCFI111:
 1562 0725 68E10000 	pushl $.LC5
 1562      00
 1563              	.LCFI112:
 1564 072a E8FCFFFF 	call printk
 1564      FF
 1565 072f 83C41C   	addl $28,%esp
 1566              	.LCFI113:
 1567              	.L170:
 382:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       "received packet from " MAC_FMT "\n",
 383:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       MAC_ARG(hdr->addr2));
 384:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		}
 385:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 1568              	.loc 1 385 0
GAS LISTING  			page 83


 1569 0732 83CAFF   	orl $-1,%edx
 1570 0735 E9700300 	jmp .L168
 1570      00
 1571              	.L169:
 386:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 387:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 388:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (skb->len < hdr_len + 8 + 4)
 1572              	.loc 1 388 0
 1573 073a 8B442444 	movl 68(%esp),%eax
 1574 073e 83C00C   	addl $12,%eax
 1575 0741 8B4C2440 	movl 64(%esp),%ecx
 389:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 1576              	.loc 1 389 0
 1577 0745 83CAFF   	orl $-1,%edx
 1578              	.loc 1 388 0
 1579 0748 394160   	cmpl %eax,96(%ecx)
 1580 074b 0F825903 	jb .L168
 1580      0000
 390:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 391:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	pos = skb->data + hdr_len;
 1581              	.loc 1 391 0
 1582 0751 8B442444 	movl 68(%esp),%eax
 1583 0755 8D3C03   	leal (%ebx,%eax),%edi
 392:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	keyidx = pos[3];
 1584              	.loc 1 392 0
 1585 0758 8A5703   	movb 3(%edi),%dl
 1586 075b 88542407 	movb %dl,7(%esp)
 393:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (!(keyidx & (1 << 5))) {
 1587              	.loc 1 393 0
 1588 075f 80E220   	andb $32,%dl
 1589 0762 753E     	jne .L172
 394:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		if (net_ratelimit()) {
 1590              	.loc 1 394 0
 1591 0764 E8FCFFFF 	call net_ratelimit
 1591      FF
 1592 0769 85C0     	testl %eax,%eax
 1593 076b 742B     	je .L173
 395:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			printk(KERN_DEBUG "TKIP: received packet without ExtIV"
 1594              	.loc 1 395 0
 1595 076d 0FB6430F 	movzbl 15(%ebx),%eax
 1596 0771 50       	pushl %eax
 1597              	.LCFI114:
 1598 0772 0FB6430E 	movzbl 14(%ebx),%eax
 1599 0776 50       	pushl %eax
 1600              	.LCFI115:
 1601 0777 0FB6430D 	movzbl 13(%ebx),%eax
 1602 077b 50       	pushl %eax
 1603              	.LCFI116:
 1604 077c 0FB6430C 	movzbl 12(%ebx),%eax
 1605 0780 50       	pushl %eax
 1606              	.LCFI117:
 1607 0781 0FB6430B 	movzbl 11(%ebx),%eax
 1608 0785 50       	pushl %eax
 1609              	.LCFI118:
 1610 0786 0FB6430A 	movzbl 10(%ebx),%eax
 1611 078a 50       	pushl %eax
 1612              	.LCFI119:
GAS LISTING  			page 84


 1613 078b 68380100 	pushl $.LC6
 1613      00
 1614              	.LCFI120:
 1615 0790 E8FCFFFF 	call printk
 1615      FF
 1616 0795 83C41C   	addl $28,%esp
 1617              	.LCFI121:
 1618              	.L173:
 396:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       " flag from " MAC_FMT "\n", MAC_ARG(hdr->addr2));
 397:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		}
 398:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -2;
 1619              	.loc 1 398 0
 1620 0798 BAFEFFFF 	movl $-2,%edx
 1620      FF
 1621 079d E9080300 	jmp .L168
 1621      00
 1622              	.L172:
 399:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 400:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	keyidx >>= 6;
 1623              	.loc 1 400 0
 1624 07a2 C06C2407 	shrb $6,7(%esp)
 1624      06
 401:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (tkey->key_idx != keyidx) {
 1625              	.loc 1 401 0
 1626 07a7 8B4C2448 	movl 72(%esp),%ecx
 1627 07ab 0FB64424 	movzbl 7(%esp),%eax
 1627      07
 1628 07b0 8B7160   	movl 96(%ecx),%esi
 1629 07b3 39C6     	cmpl %eax,%esi
 1630 07b5 741A     	je .L174
 402:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		printk(KERN_DEBUG "TKIP: RX tkey->key_idx=%d frame "
 1631              	.loc 1 402 0
 1632 07b7 51       	pushl %ecx
 1633              	.LCFI122:
 1634 07b8 50       	pushl %eax
 1635              	.LCFI123:
 1636 07b9 56       	pushl %esi
 1637              	.LCFI124:
 1638 07ba 68880100 	pushl $.LC7
 1638      00
 1639              	.LCFI125:
 1640 07bf E8FCFFFF 	call printk
 1640      FF
 403:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		       "keyidx=%d priv=%p\n", tkey->key_idx, keyidx, priv);
 404:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -6;
 1641              	.loc 1 404 0
 1642 07c4 83C410   	addl $16,%esp
 1643              	.LCFI126:
 1644 07c7 BAFAFFFF 	movl $-6,%edx
 1644      FF
 1645 07cc E9D90200 	jmp .L168
 1645      00
 1646              	.L174:
 405:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 406:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (!tkey->key_set) {
 1647              	.loc 1 406 0
 1648 07d1 8B442448 	movl 72(%esp),%eax
GAS LISTING  			page 85


 1649 07d5 83782000 	cmpl $0,32(%eax)
 1650 07d9 753F     	jne .L175
 407:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		if (net_ratelimit()) {
 1651              	.loc 1 407 0
 1652 07db E8FCFFFF 	call net_ratelimit
 1652      FF
 1653 07e0 85C0     	testl %eax,%eax
 1654 07e2 742C     	je .L176
 408:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			printk(KERN_DEBUG "TKIP: received packet from " MAC_FMT
 1655              	.loc 1 408 0
 1656 07e4 56       	pushl %esi
 1657              	.LCFI127:
 1658 07e5 0FB6430F 	movzbl 15(%ebx),%eax
 1659 07e9 50       	pushl %eax
 1660              	.LCFI128:
 1661 07ea 0FB6430E 	movzbl 14(%ebx),%eax
 1662 07ee 50       	pushl %eax
 1663              	.LCFI129:
 1664 07ef 0FB6430D 	movzbl 13(%ebx),%eax
 1665 07f3 50       	pushl %eax
 1666              	.LCFI130:
 1667 07f4 0FB6430C 	movzbl 12(%ebx),%eax
 1668 07f8 50       	pushl %eax
 1669              	.LCFI131:
 1670 07f9 0FB6430B 	movzbl 11(%ebx),%eax
 1671 07fd 50       	pushl %eax
 1672              	.LCFI132:
 1673 07fe 0FB6430A 	movzbl 10(%ebx),%eax
 1674 0802 50       	pushl %eax
 1675              	.LCFI133:
 1676 0803 68BE0100 	pushl $.LC8
 1676      00
 1677              	.LCFI134:
 1678 0808 E8FCFFFF 	call printk
 1678      FF
 1679 080d 83C420   	addl $32,%esp
 1680              	.LCFI135:
 1681              	.L176:
 409:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       " with keyid=%d that does not have a configured"
 410:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       " key\n", MAC_ARG(hdr->addr2), keyidx);
 411:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		}
 412:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -3;
 1682              	.loc 1 412 0
 1683 0810 BAFDFFFF 	movl $-3,%edx
 1683      FF
 1684 0815 E9900200 	jmp .L168
 1684      00
 1685              	.L175:
 413:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 414:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	iv16 = (pos[0] << 8) | pos[2];
 1686              	.loc 1 414 0
 1687 081a 0FB607   	movzbl (%edi),%eax
 1688 081d 660FB657 	movzbw 2(%edi),%dx
 1688      02
 1689 0822 66895424 	movw %dx,4(%esp)
 1689      04
 1690 0827 C1E008   	sall $8,%eax
GAS LISTING  			page 86


 1691 082a 66094424 	orw %ax,4(%esp)
 1691      04
 415:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	iv32 = pos[4] | (pos[5] << 8) | (pos[6] << 16) | (pos[7] << 24);
 1692              	.loc 1 415 0
 1693 082f 0FB64705 	movzbl 5(%edi),%eax
 1694 0833 C1E008   	sall $8,%eax
 1695 0836 0FB66F04 	movzbl 4(%edi),%ebp
 1696 083a 09C5     	orl %eax,%ebp
 1697 083c 0FB64706 	movzbl 6(%edi),%eax
 1698 0840 C1E010   	sall $16,%eax
 1699 0843 09C5     	orl %eax,%ebp
 1700 0845 0FB64707 	movzbl 7(%edi),%eax
 1701 0849 C1E018   	sall $24,%eax
 1702 084c 09C5     	orl %eax,%ebp
 416:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	pos += 8;
 417:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 418:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (iv32 < tkey->rx_iv32 ||
 1703              	.loc 1 418 0
 1704 084e 8B4C2448 	movl 72(%esp),%ecx
 1705              	.loc 1 416 0
 1706 0852 83C708   	addl $8,%edi
 1707              	.loc 1 418 0
 1708 0855 3B6938   	cmpl 56(%ecx),%ebp
 1709 0858 720C     	jb .L178
 1710 085a 756C     	jne .L181
 1711 085c 8B442404 	movl 4(%esp),%eax
 1712 0860 663B413C 	cmpw 60(%ecx),%ax
 1713 0864 7758     	ja .L177
 1714              	.L178:
 419:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	    (iv32 == tkey->rx_iv32 && iv16 <= tkey->rx_iv16)) {
 420:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		if (net_ratelimit()) {
 1715              	.loc 1 420 0
 1716 0866 E8FCFFFF 	call net_ratelimit
 1716      FF
 1717 086b 85C0     	testl %eax,%eax
 1718 086d 743E     	je .L179
 421:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			printk(KERN_DEBUG "TKIP: replay detected: STA=" MAC_FMT
 1719              	.loc 1 421 0
 1720 086f 0FB74424 	movzwl 4(%esp),%eax
 1720      04
 1721 0874 50       	pushl %eax
 1722              	.LCFI136:
 1723 0875 55       	pushl %ebp
 1724              	.LCFI137:
 1725 0876 8B542450 	movl 80(%esp),%edx
 1726 087a 0FB7423C 	movzwl 60(%edx),%eax
 1727 087e 50       	pushl %eax
 1728              	.LCFI138:
 1729 087f FF7238   	pushl 56(%edx)
 1730              	.LCFI139:
 1731 0882 0FB6430F 	movzbl 15(%ebx),%eax
 1732 0886 50       	pushl %eax
 1733              	.LCFI140:
 1734 0887 0FB6430E 	movzbl 14(%ebx),%eax
 1735 088b 50       	pushl %eax
 1736              	.LCFI141:
 1737 088c 0FB6430D 	movzbl 13(%ebx),%eax
GAS LISTING  			page 87


 1738 0890 50       	pushl %eax
 1739              	.LCFI142:
 1740 0891 0FB6430C 	movzbl 12(%ebx),%eax
 1741 0895 50       	pushl %eax
 1742              	.LCFI143:
 1743 0896 0FB6430B 	movzbl 11(%ebx),%eax
 1744 089a 50       	pushl %eax
 1745              	.LCFI144:
 1746 089b 0FB6430A 	movzbl 10(%ebx),%eax
 1747 089f 50       	pushl %eax
 1748              	.LCFI145:
 1749 08a0 682D0200 	pushl $.LC9
 1749      00
 1750              	.LCFI146:
 1751 08a5 E8FCFFFF 	call printk
 1751      FF
 1752 08aa 83C42C   	addl $44,%esp
 1753              	.LCFI147:
 1754              	.L179:
 422:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       " previous TSC %08x%04x received TSC "
 423:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       "%08x%04x\n", MAC_ARG(hdr->addr2),
 424:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       tkey->rx_iv32, tkey->rx_iv16, iv32, iv16);
 425:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		}
 426:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		tkey->dot11RSNAStatsTKIPReplays++;
 1755              	.loc 1 426 0
 1756 08ad 8B4C2448 	movl 72(%esp),%ecx
 1757 08b1 FF4154   	incl 84(%ecx)
 427:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -4;
 1758              	.loc 1 427 0
 1759 08b4 BAFCFFFF 	movl $-4,%edx
 1759      FF
 1760 08b9 E9EC0100 	jmp .L168
 1760      00
 1761              	.L177:
 428:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 429:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 430:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (iv32 != tkey->rx_iv32 || !tkey->rx_phase1_done) {
 1762              	.loc 1 430 0
 1763 08be 8B442448 	movl 72(%esp),%eax
 1764 08c2 83784800 	cmpl $0,72(%eax)
 1765 08c6 7524     	jne .L180
 1766              	.L181:
 431:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		tkip_mixing_phase1(tkey->rx_ttak, tkey->key, hdr->addr2, iv32);
 1767              	.loc 1 431 0
 1768 08c8 55       	pushl %ebp
 1769              	.LCFI148:
 1770 08c9 8D430A   	leal 10(%ebx),%eax
 1771 08cc 50       	pushl %eax
 1772              	.LCFI149:
 1773 08cd FF742450 	pushl 80(%esp)
 1774              	.LCFI150:
 1775 08d1 8B442454 	movl 84(%esp),%eax
 1776 08d5 83C03E   	addl $62,%eax
 1777 08d8 50       	pushl %eax
 1778              	.LCFI151:
 1779 08d9 E80CF8FF 	call tkip_mixing_phase1
 1779      FF
GAS LISTING  			page 88


 432:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		tkey->rx_phase1_done = 1;
 1780              	.loc 1 432 0
 1781 08de 8B542458 	movl 88(%esp),%edx
 1782 08e2 C7424801 	movl $1,72(%edx)
 1782      000000
 1783 08e9 83C410   	addl $16,%esp
 1784              	.LCFI152:
 1785              	.L180:
 433:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 434:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	tkip_mixing_phase2(rc4key, tkey->key, tkey->rx_ttak, iv16);
 1786              	.loc 1 434 0
 1787 08ec 0FB74424 	movzwl 4(%esp),%eax
 1787      04
 1788 08f1 50       	pushl %eax
 1789              	.LCFI153:
 1790 08f2 8B44244C 	movl 76(%esp),%eax
 1791 08f6 83C03E   	addl $62,%eax
 1792 08f9 50       	pushl %eax
 1793              	.LCFI154:
 1794 08fa FF742450 	pushl 80(%esp)
 1795              	.LCFI155:
 1796 08fe 8D4C2428 	leal 40(%esp),%ecx
 1797 0902 51       	pushl %ecx
 1798              	.LCFI156:
 1799 0903 E875F9FF 	call tkip_mixing_phase2
 1799      FF
 435:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 436:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	plen = skb->len - hdr_len - 12;
 1800              	.loc 1 436 0
 1801 0908 8B442450 	movl 80(%esp),%eax
 1802 090c 8B7060   	movl 96(%eax),%esi
 1803 090f 2B742454 	subl 84(%esp),%esi
 1804 0913 8D56F4   	leal -12(%esi),%edx
 1805 0916 89542410 	movl %edx,16(%esp)
 1806              	.loc 6 311 0
 1807 091a 83C410   	addl $16,%esp
 1808              	.LCFI157:
 1809              	.LBB94:
 1810 091d 8B4C2448 	movl 72(%esp),%ecx
 1811 0921 8B5164   	movl 100(%ecx),%edx
 1812              	.LBB95:
 1813              	.LBB96:
 1814              	.LBB97:
 1815              	.loc 6 237 0
 1816 0924 8B4228   	movl 40(%edx),%eax
 1817              	.LBE97:
 1818              	.LBE96:
 1819              	.loc 6 236 0
 1820 0927 80780801 	cmpb $1,8(%eax)
 1821 092b 7402     	je .L182
 1822              	.loc 6 312 0
 1823              	
 1824 092d 0F0B     	ud2
 1825              	
 1826              	
 1827              	.L182:
 1828 092f 6A10     	pushl $16
GAS LISTING  			page 89


 1829              	.LCFI158:
 1830 0931 8D442420 	leal 32(%esp),%eax
 1831 0935 50       	pushl %eax
 1832              	.LCFI159:
 1833 0936 52       	pushl %edx
 1834              	.LCFI160:
 1835 0937 FF5210   	call *16(%edx)
 1836              	.LBE95:
 1837              	.LBE94:
 437:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 438:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	crypto_cipher_setkey(tkey->tfm_arc4, rc4key, 16);
 439:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sg.page = virt_to_page(pos);
 1838              	.loc 1 439 0
 1839 093a 8D870000 	leal 1073741824(%edi),%eax
 1839      0040
 1840 0940 C1E80C   	shrl $12,%eax
 1841 0943 C1E005   	sall $5,%eax
 1842              	.LBB98:
 1843              	.LBB99:
 1844              	.loc 6 312 0
 1845 0946 83C40C   	addl $12,%esp
 1846              	.LCFI161:
 1847              	.LBE99:
 1848              	.LBE98:
 1849              	.loc 1 439 0
 1850 0949 03050000 	addl mem_map,%eax
 1850      0000
 1851 094f 8944240C 	movl %eax,12(%esp)
 440:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sg.offset = offset_in_page(pos);
 1852              	.loc 1 440 0
 1853 0953 89F8     	movl %edi,%eax
 1854 0955 25FF0F00 	andl $4095,%eax
 1854      00
 441:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sg.length = plen + 4;
 1855              	.loc 1 441 0
 1856 095a 8D4EF8   	leal -8(%esi),%ecx
 1857              	.loc 1 440 0
 1858 095d 89442410 	movl %eax,16(%esp)
 1859              	.loc 1 441 0
 1860 0961 894C2418 	movl %ecx,24(%esp)
 1861              	.LBB100:
 322:include/linux/crypto.h **** 	return tfm->crt_cipher.cit_encrypt(tfm, dst, src, nbytes);
 323:include/linux/crypto.h **** }                                        
 324:include/linux/crypto.h **** 
 325:include/linux/crypto.h **** static inline int crypto_cipher_encrypt_iv(struct crypto_tfm *tfm,
 326:include/linux/crypto.h ****                                            struct scatterlist *dst,
 327:include/linux/crypto.h ****                                            struct scatterlist *src,
 328:include/linux/crypto.h ****                                            unsigned int nbytes, u8 *iv)
 329:include/linux/crypto.h **** {
 330:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_CIPHER);
 331:include/linux/crypto.h **** 	BUG_ON(tfm->crt_cipher.cit_mode == CRYPTO_TFM_MODE_ECB);
 332:include/linux/crypto.h **** 	return tfm->crt_cipher.cit_encrypt_iv(tfm, dst, src, nbytes, iv);
 333:include/linux/crypto.h **** }                                        
 334:include/linux/crypto.h **** 
 335:include/linux/crypto.h **** static inline int crypto_cipher_decrypt(struct crypto_tfm *tfm,
 336:include/linux/crypto.h ****                                         struct scatterlist *dst,
 337:include/linux/crypto.h ****                                         struct scatterlist *src,
GAS LISTING  			page 90


 338:include/linux/crypto.h ****                                         unsigned int nbytes)
 339:include/linux/crypto.h **** {
 1862              	.loc 6 339 0
 1863 0965 8B442448 	movl 72(%esp),%eax
 1864 0969 8B5064   	movl 100(%eax),%edx
 1865              	.LBB101:
 1866              	.LBB102:
 1867              	.LBB103:
 1868              	.loc 6 237 0
 1869 096c 8B4228   	movl 40(%edx),%eax
 1870              	.LBE103:
 1871              	.LBE102:
 1872              	.loc 6 236 0
 1873 096f 80780801 	cmpb $1,8(%eax)
 1874              	.LBE101:
 1875              	.loc 6 339 0
 1876 0973 8D74240C 	leal 12(%esp),%esi
 1877              	.LBB104:
 1878              	.loc 6 236 0
 1879 0977 7402     	je .L186
 340:include/linux/crypto.h **** 	BUG_ON(crypto_tfm_alg_type(tfm) != CRYPTO_ALG_TYPE_CIPHER);
 1880              	.loc 6 340 0
 1881              	
 1882 0979 0F0B     	ud2
 1883              	
 1884              	
 1885              	.L186:
 1886 097b 51       	pushl %ecx
 1887              	.LCFI162:
 1888 097c 56       	pushl %esi
 1889              	.LCFI163:
 1890 097d 56       	pushl %esi
 1891              	.LCFI164:
 1892 097e 52       	pushl %edx
 1893              	.LCFI165:
 1894 097f FF521C   	call *28(%edx)
 1895 0982 83C410   	addl $16,%esp
 1896              	.LCFI166:
 1897              	.LBE104:
 1898              	.LBE100:
 442:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	crypto_cipher_decrypt(tkey->tfm_arc4, &sg, &sg, plen + 4);
 443:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 444:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	crc = ~crc32_le(~0, pos, plen);
 1899              	.loc 1 444 0
 1900 0985 FF3424   	pushl (%esp)
 1901              	.LCFI167:
 1902 0988 57       	pushl %edi
 1903              	.LCFI168:
 1904 0989 6AFF     	pushl $-1
 1905              	.LCFI169:
 1906 098b E8FCFFFF 	call crc32_le
 1906      FF
 1907 0990 F7D0     	notl %eax
 445:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	icv[0] = crc;
 1908              	.loc 1 445 0
 1909 0992 88442414 	movb %al,20(%esp)
 446:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	icv[1] = crc >> 8;
GAS LISTING  			page 91


 1910              	.loc 1 446 0
 1911 0996 C1E808   	shrl $8,%eax
 1912 0999 88442415 	movb %al,21(%esp)
 447:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	icv[2] = crc >> 16;
 1913              	.loc 1 447 0
 1914 099d C1E808   	shrl $8,%eax
 1915 09a0 88442416 	movb %al,22(%esp)
 448:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	icv[3] = crc >> 24;
 1916              	.loc 1 448 0
 1917 09a4 C1E808   	shrl $8,%eax
 1918 09a7 88442417 	movb %al,23(%esp)
 449:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (memcmp(icv, pos + plen, 4) != 0) {
 1919              	.loc 1 449 0
 1920 09ab 89F8     	movl %edi,%eax
 1921 09ad 0344240C 	addl 12(%esp),%eax
 1922 09b1 6A04     	pushl $4
 1923              	.LCFI170:
 1924 09b3 50       	pushl %eax
 1925              	.LCFI171:
 1926 09b4 8D44241C 	leal 28(%esp),%eax
 1927 09b8 50       	pushl %eax
 1928              	.LCFI172:
 1929              	.LCFI173:
 1930 09b9 E8FCFFFF 	call memcmp
 1930      FF
 1931 09be 83C418   	addl $24,%esp
 1932              	.LCFI174:
 1933 09c1 85C0     	testl %eax,%eax
 1934 09c3 7455     	je .L190
 450:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		if (iv32 != tkey->rx_iv32) {
 1935              	.loc 1 450 0
 1936 09c5 8B542448 	movl 72(%esp),%edx
 1937 09c9 3B6A38   	cmpl 56(%edx),%ebp
 1938 09cc 7407     	je .L191
 451:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			/* Previously cached Phase1 result was already lost, so
 452:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			 * it needs to be recalculated for the next packet. */
 453:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			tkey->rx_phase1_done = 0;
 1939              	.loc 1 453 0
 1940 09ce C7424800 	movl $0,72(%edx)
 1940      000000
 1941              	.L191:
 454:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		}
 455:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		if (net_ratelimit()) {
 1942              	.loc 1 455 0
 1943 09d5 E8FCFFFF 	call net_ratelimit
 1943      FF
 1944 09da 85C0     	testl %eax,%eax
 1945 09dc 742B     	je .L192
 456:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			printk(KERN_DEBUG "TKIP: ICV error detected: STA="
 1946              	.loc 1 456 0
 1947 09de 0FB6430F 	movzbl 15(%ebx),%eax
 1948 09e2 50       	pushl %eax
 1949              	.LCFI175:
 1950 09e3 0FB6430E 	movzbl 14(%ebx),%eax
 1951 09e7 50       	pushl %eax
 1952              	.LCFI176:
 1953 09e8 0FB6430D 	movzbl 13(%ebx),%eax
GAS LISTING  			page 92


 1954 09ec 50       	pushl %eax
 1955              	.LCFI177:
 1956 09ed 0FB6430C 	movzbl 12(%ebx),%eax
 1957 09f1 50       	pushl %eax
 1958              	.LCFI178:
 1959 09f2 0FB6430B 	movzbl 11(%ebx),%eax
 1960 09f6 50       	pushl %eax
 1961              	.LCFI179:
 1962 09f7 0FB6430A 	movzbl 10(%ebx),%eax
 1963 09fb 50       	pushl %eax
 1964              	.LCFI180:
 1965 09fc 68960200 	pushl $.LC10
 1965      00
 1966              	.LCFI181:
 1967 0a01 E8FCFFFF 	call printk
 1967      FF
 1968 0a06 83C41C   	addl $28,%esp
 1969              	.LCFI182:
 1970              	.L192:
 457:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			       MAC_FMT "\n", MAC_ARG(hdr->addr2));
 458:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		}
 459:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		tkey->dot11RSNAStatsTKIPICVErrors++;
 1971              	.loc 1 459 0
 1972 0a09 8B4C2448 	movl 72(%esp),%ecx
 1973 0a0d FF4158   	incl 88(%ecx)
 460:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -5;
 1974              	.loc 1 460 0
 1975 0a10 BAFBFFFF 	movl $-5,%edx
 1975      FF
 1976 0a15 E9900000 	jmp .L168
 1976      00
 1977              	.L190:
 461:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 462:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 463:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	/* Update real counters only after Michael MIC verification has
 464:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	 * completed */
 465:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	tkey->rx_iv32_new = iv32;
 1978              	.loc 1 465 0
 1979 0a1a 8B442448 	movl 72(%esp),%eax
 1980 0a1e 89684C   	movl %ebp,76(%eax)
 466:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	tkey->rx_iv16_new = iv16;
 1981              	.loc 1 466 0
 1982 0a21 8B542404 	movl 4(%esp),%edx
 1983 0a25 66895050 	movw %dx,80(%eax)
 467:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 468:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	/* Remove IV and ICV */
 469:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	memmove(skb->data + 8, skb->data, hdr_len);
 1984              	.loc 1 469 0
 1985 0a29 FF742444 	pushl 68(%esp)
 1986              	.LCFI183:
 1987 0a2d 8B4C2444 	movl 68(%esp),%ecx
 1988 0a31 FFB1A800 	pushl 168(%ecx)
 1988      0000
 1989              	.LCFI184:
 1990 0a37 8B81A800 	movl 168(%ecx),%eax
 1990      0000
 1991 0a3d 83C008   	addl $8,%eax
GAS LISTING  			page 93


 1992 0a40 50       	pushl %eax
 1993              	.LCFI185:
 1994 0a41 E8FCFFFF 	call memmove
 1994      FF
 1995              	.loc 5 810 0
 1996 0a46 83C40C   	addl $12,%esp
 1997              	.LCFI186:
 1998              	.LBB105:
 1999              	.LBB106:
 2000              	.loc 5 811 0
 2001 0a49 8B542440 	movl 64(%esp),%edx
 2002 0a4d 8B4260   	movl 96(%edx),%eax
 2003 0a50 83F807   	cmpl $7,%eax
 2004 0a53 7618     	jbe .L198
 2005              	.LBB107:
 2006              	.LBB108:
 2007              	.loc 5 794 0
 2008 0a55 83E808   	subl $8,%eax
 2009              	.loc 5 795 0
 2010 0a58 3B4264   	cmpl 100(%edx),%eax
 2011              	.loc 5 794 0
 2012 0a5b 894260   	movl %eax,96(%edx)
 2013              	.loc 5 795 0
 2014 0a5e 7302     	jae .L195
 2015              	
 2016 0a60 0F0B     	ud2
 2017              	
 2018              	
 2019              	.L195:
 2020 0a62 8B4C2440 	movl 64(%esp),%ecx
 2021 0a66 8381A800 	addl $8,168(%ecx)
 2021      000008
 2022              	.L198:
 2023              	.LBE108:
 2024              	.LBE107:
 2025              	.LBE106:
 2026              	.LBE105:
 2027              	.LBB109:
 858:include/linux/skbuff.h **** 	return skb_is_nonlinear(skb) ? 0 : skb->end - skb->tail;
 859:include/linux/skbuff.h **** }
 860:include/linux/skbuff.h **** 
 861:include/linux/skbuff.h **** /**
 862:include/linux/skbuff.h ****  *	skb_reserve - adjust headroom
 863:include/linux/skbuff.h ****  *	@skb: buffer to alter
 864:include/linux/skbuff.h ****  *	@len: bytes to move
 865:include/linux/skbuff.h ****  *
 866:include/linux/skbuff.h ****  *	Increase the headroom of an empty &sk_buff by reducing the tail
 867:include/linux/skbuff.h ****  *	room. This is only allowed for an empty buffer.
 868:include/linux/skbuff.h ****  */
 869:include/linux/skbuff.h **** static inline void skb_reserve(struct sk_buff *skb, unsigned int len)
 870:include/linux/skbuff.h **** {
 871:include/linux/skbuff.h **** 	skb->data += len;
 872:include/linux/skbuff.h **** 	skb->tail += len;
 873:include/linux/skbuff.h **** }
 874:include/linux/skbuff.h **** 
 875:include/linux/skbuff.h **** /*
 876:include/linux/skbuff.h ****  * CPUs often take a performance hit when accessing unaligned memory
GAS LISTING  			page 94


 877:include/linux/skbuff.h ****  * locations. The actual performance hit varies, it can be small if the
 878:include/linux/skbuff.h ****  * hardware handles it or large if we have to take an exception and fix it
 879:include/linux/skbuff.h ****  * in software.
 880:include/linux/skbuff.h ****  *
 881:include/linux/skbuff.h ****  * Since an ethernet header is 14 bytes network drivers often end up with
 882:include/linux/skbuff.h ****  * the IP header at an unaligned offset. The IP header can be aligned by
 883:include/linux/skbuff.h ****  * shifting the start of the packet by 2 bytes. Drivers should do this
 884:include/linux/skbuff.h ****  * with:
 885:include/linux/skbuff.h ****  *
 886:include/linux/skbuff.h ****  * skb_reserve(NET_IP_ALIGN);
 887:include/linux/skbuff.h ****  *
 888:include/linux/skbuff.h ****  * The downside to this alignment of the IP header is that the DMA is now
 889:include/linux/skbuff.h ****  * unaligned. On some architectures the cost of an unaligned DMA is high
 890:include/linux/skbuff.h ****  * and this cost outweighs the gains made by aligning the IP header.
 891:include/linux/skbuff.h ****  * 
 892:include/linux/skbuff.h ****  * Since this trade off varies between architectures, we allow NET_IP_ALIGN
 893:include/linux/skbuff.h ****  * to be overridden.
 894:include/linux/skbuff.h ****  */
 895:include/linux/skbuff.h **** #ifndef NET_IP_ALIGN
 896:include/linux/skbuff.h **** #define NET_IP_ALIGN	2
 897:include/linux/skbuff.h **** #endif
 898:include/linux/skbuff.h **** 
 899:include/linux/skbuff.h **** extern int ___pskb_trim(struct sk_buff *skb, unsigned int len, int realloc);
 900:include/linux/skbuff.h **** 
 901:include/linux/skbuff.h **** static inline void __skb_trim(struct sk_buff *skb, unsigned int len)
 902:include/linux/skbuff.h **** {
 903:include/linux/skbuff.h **** 	if (!skb->data_len) {
 904:include/linux/skbuff.h **** 		skb->len  = len;
 905:include/linux/skbuff.h **** 		skb->tail = skb->data + len;
 906:include/linux/skbuff.h **** 	} else
 907:include/linux/skbuff.h **** 		___pskb_trim(skb, len, 0);
 908:include/linux/skbuff.h **** }
 909:include/linux/skbuff.h **** 
 910:include/linux/skbuff.h **** /**
 911:include/linux/skbuff.h ****  *	skb_trim - remove end from a buffer
 912:include/linux/skbuff.h ****  *	@skb: buffer to alter
 913:include/linux/skbuff.h ****  *	@len: new length
 914:include/linux/skbuff.h ****  *
 915:include/linux/skbuff.h ****  *	Cut the length of a buffer down by removing data from the tail. If
 916:include/linux/skbuff.h ****  *	the buffer is already under the length specified it is not modified.
 917:include/linux/skbuff.h ****  */
 918:include/linux/skbuff.h **** static inline void skb_trim(struct sk_buff *skb, unsigned int len)
 919:include/linux/skbuff.h **** {
 2028              	.loc 5 919 0
 2029 0a6d 8B542440 	movl 64(%esp),%edx
 2030 0a71 8B4260   	movl 96(%edx),%eax
 2031 0a74 8D50FC   	leal -4(%eax),%edx
 2032              	.LBB110:
 920:include/linux/skbuff.h **** 	if (skb->len > len)
 2033              	.loc 5 920 0
 2034 0a77 39D0     	cmpl %edx,%eax
 2035 0a79 762A     	jbe .L203
 2036              	.LBB111:
 2037              	.LBB112:
 2038              	.loc 5 903 0
 2039 0a7b 8B4C2440 	movl 64(%esp),%ecx
 2040 0a7f 83796400 	cmpl $0,100(%ecx)
GAS LISTING  			page 95


 2041 0a83 7511     	jne .L200
 2042              	.loc 5 904 0
 2043 0a85 895160   	movl %edx,96(%ecx)
 2044              	.loc 5 905 0
 2045 0a88 0391A800 	addl 168(%ecx),%edx
 2045      0000
 2046 0a8e 8991AC00 	movl %edx,172(%ecx)
 2046      0000
 2047 0a94 EB0F     	jmp .L203
 2048              	.L200:
 2049              	.loc 5 907 0
 2050 0a96 6A00     	pushl $0
 2051              	.LCFI187:
 2052 0a98 52       	pushl %edx
 2053              	.LCFI188:
 2054 0a99 FF742448 	pushl 72(%esp)
 2055              	.LCFI189:
 2056 0a9d E8FCFFFF 	call ___pskb_trim
 2056      FF
 2057 0aa2 83C40C   	addl $12,%esp
 2058              	.LCFI190:
 2059              	.L203:
 2060              	.LBE112:
 2061              	.LBE111:
 2062              	.LBE110:
 2063              	.LBE109:
 470:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	skb_pull(skb, 8);
 471:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	skb_trim(skb, skb->len - 4);
 472:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 473:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return keyidx;
 2064              	.loc 1 473 0
 2065 0aa5 0FB65424 	movzbl 7(%esp),%edx
 2065      07
 2066              	.L168:
 474:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 2067              	.loc 1 474 0
 2068 0aaa 83C42C   	addl $44,%esp
 2069 0aad 5B       	popl %ebx
 2070 0aae 5E       	popl %esi
 2071 0aaf 5F       	popl %edi
 2072 0ab0 89D0     	movl %edx,%eax
 2073 0ab2 5D       	popl %ebp
 2074 0ab3 C3       	ret
 2075              	.LFE703:
 2077              	.section .rodata.str1.1
 2078              	.LC11:
 2079 02d6 3C343E6D 	.string "<4>michael_mic: tfm_michael == NULL\n"
 2079      69636861 
 2079      656C5F6D 
 2079      69633A20 
 2079      74666D5F 
 2080              	.text
 2082              	michael_mic:
 2083              	.LFB704:
 475:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 476:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static int michael_mic(struct ieee80211_tkip_data *tkey, u8 * key, u8 * hdr,
 477:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		       u8 * data, size_t data_len, u8 * mic)
GAS LISTING  			page 96


 478:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 2084              	.loc 1 478 0
 2085 0ab4 57       	pushl %edi
 2086              	.LCFI191:
 2087 0ab5 56       	pushl %esi
 2088              	.LCFI192:
 2089 0ab6 53       	pushl %ebx
 2090              	.LCFI193:
 2091 0ab7 83EC20   	subl $32,%esp
 2092              	.LCFI194:
 2093              	.loc 1 478 0
 2094 0aba 8B7C2430 	movl 48(%esp),%edi
 479:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct scatterlist sg[2];
 480:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 481:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (tkey->tfm_michael == NULL) {
 2095              	.loc 1 481 0
 2096 0abe 8B7768   	movl 104(%edi),%esi
 2097 0ac1 85F6     	testl %esi,%esi
 2098              	.loc 1 478 0
 2099 0ac3 8B4C2438 	movl 56(%esp),%ecx
 2100 0ac7 8B5C243C 	movl 60(%esp),%ebx
 2101              	.loc 1 481 0
 2102 0acb 7513     	jne .L205
 482:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		printk(KERN_WARNING "michael_mic: tfm_michael == NULL\n");
 2103              	.loc 1 482 0
 2104 0acd 68D60200 	pushl $.LC11
 2104      00
 2105              	.LCFI195:
 2106 0ad2 E8FCFFFF 	call printk
 2106      FF
 483:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 2107              	.loc 1 483 0
 2108 0ad7 5B       	popl %ebx
 2109              	.LCFI196:
 2110 0ad8 83C8FF   	orl $-1,%eax
 2111 0adb E9B30000 	jmp .L204
 2111      00
 2112              	.L205:
 484:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 485:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sg[0].page = virt_to_page(hdr);
 2113              	.loc 1 485 0
 2114 0ae0 8D810000 	leal 1073741824(%ecx),%eax
 2114      0040
 2115 0ae6 C1E80C   	shrl $12,%eax
 2116 0ae9 C1E005   	sall $5,%eax
 2117 0aec 8B150000 	movl mem_map,%edx
 2117      0000
 2118 0af2 8D0402   	leal (%edx,%eax),%eax
 2119 0af5 890424   	movl %eax,(%esp)
 486:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sg[0].offset = offset_in_page(hdr);
 487:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sg[0].length = 16;
 488:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 489:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sg[1].page = virt_to_page(data);
 2120              	.loc 1 489 0
 2121 0af8 8D830000 	leal 1073741824(%ebx),%eax
 2121      0040
 2122 0afe C1E80C   	shrl $12,%eax
GAS LISTING  			page 97


 2123 0b01 C1E005   	sall $5,%eax
 2124 0b04 01C2     	addl %eax,%edx
 2125              	.loc 1 486 0
 2126 0b06 81E1FF0F 	andl $4095,%ecx
 2126      0000
 490:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sg[1].offset = offset_in_page(data);
 2127              	.loc 1 490 0
 2128 0b0c 81E3FF0F 	andl $4095,%ebx
 2128      0000
 491:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sg[1].length = data_len;
 2129              	.loc 1 491 0
 2130 0b12 8B442440 	movl 64(%esp),%eax
 2131              	.loc 1 486 0
 2132 0b16 894C2404 	movl %ecx,4(%esp)
 2133              	.loc 1 487 0
 2134 0b1a C744240C 	movl $16,12(%esp)
 2134      10000000 
 2135              	.loc 1 489 0
 2136 0b22 89542410 	movl %edx,16(%esp)
 2137              	.loc 1 490 0
 2138 0b26 895C2414 	movl %ebx,20(%esp)
 2139              	.loc 1 491 0
 2140 0b2a 8944241C 	movl %eax,28(%esp)
 2141              	.LBB113:
 2142              	.LBB114:
 2143              	.LBB115:
 2144              	.LBB116:
 2145              	.loc 6 237 0
 2146 0b2e 8B4628   	movl 40(%esi),%eax
 2147              	.LBE116:
 2148              	.LBE115:
 2149              	.loc 6 236 0
 2150 0b31 80780802 	cmpb $2,8(%eax)
 2151 0b35 7402     	je .L206
 2152              	.loc 6 274 0
 2153              	
 2154 0b37 0F0B     	ud2
 2155              	
 2156              	
 2157              	.L206:
 2158              	.loc 6 275 0
 2159 0b39 56       	pushl %esi
 2160              	.LCFI197:
 2161 0b3a FF5604   	call *4(%esi)
 2162              	.LBE114:
 2163              	.LBE113:
 2164              	.LBB117:
 2165              	.loc 6 302 0
 2166 0b3d 8B5768   	movl 104(%edi),%edx
 2167              	.LBB118:
 2168              	.LBB119:
 2169              	.LBB120:
 2170              	.loc 6 237 0
 2171 0b40 8B4228   	movl 40(%edx),%eax
 2172              	.LBE120:
 2173              	.LBE119:
 2174              	.loc 6 236 0
GAS LISTING  			page 98


 2175 0b43 80780802 	cmpb $2,8(%eax)
 2176              	.LBE118:
 2177              	.LBE117:
 2178              	.LBB121:
 2179              	.LBB122:
 2180              	.loc 6 275 0
 2181 0b47 59       	popl %ecx
 2182              	.LCFI198:
 2183              	.LBE122:
 2184              	.LBE121:
 2185              	.LBB123:
 2186              	.LBB124:
 2187              	.loc 6 236 0
 2188 0b48 7402     	je .L210
 2189              	.loc 6 303 0
 2190              	
 2191 0b4a 0F0B     	ud2
 2192              	
 2193              	
 2194              	.L210:
 2195              	.loc 6 304 0
 2196 0b4c 837A1400 	cmpl $0,20(%edx)
 2197 0b50 740D     	je .L214
 2198 0b52 6A08     	pushl $8
 2199              	.LCFI199:
 2200 0b54 FF742438 	pushl 56(%esp)
 2201              	.LCFI200:
 2202 0b58 52       	pushl %edx
 2203              	.LCFI201:
 2204 0b59 FF5214   	call *20(%edx)
 2205 0b5c 83C40C   	addl $12,%esp
 2206              	.LCFI202:
 2207              	.L214:
 2208              	.LBE124:
 2209              	.LBE123:
 2210              	.LBB125:
 2211              	.loc 6 281 0
 2212 0b5f 8B5768   	movl 104(%edi),%edx
 2213              	.LBB126:
 2214              	.LBB127:
 2215              	.LBB128:
 2216              	.loc 6 237 0
 2217 0b62 8B4228   	movl 40(%edx),%eax
 2218              	.LBE128:
 2219              	.LBE127:
 2220              	.loc 6 236 0
 2221 0b65 80780802 	cmpb $2,8(%eax)
 2222              	.LBE126:
 2223              	.loc 6 281 0
 2224 0b69 89E1     	movl %esp,%ecx
 2225              	.LBB129:
 2226              	.loc 6 236 0
 2227 0b6b 7402     	je .L215
 2228              	.loc 6 282 0
 2229              	
 2230 0b6d 0F0B     	ud2
 2231              	
GAS LISTING  			page 99


 2232              	
 2233              	.L215:
 2234              	.loc 6 283 0
 2235 0b6f 6A02     	pushl $2
 2236              	.LCFI203:
 2237 0b71 51       	pushl %ecx
 2238              	.LCFI204:
 2239 0b72 52       	pushl %edx
 2240              	.LCFI205:
 2241 0b73 FF5208   	call *8(%edx)
 2242              	.LBE129:
 2243              	.LBE125:
 2244              	.LBB130:
 2245              	.loc 6 287 0
 2246 0b76 8B5768   	movl 104(%edi),%edx
 2247              	.LBB131:
 2248              	.LBB132:
 2249              	.LBB133:
 2250              	.loc 6 237 0
 2251 0b79 8B4228   	movl 40(%edx),%eax
 2252              	.LBE133:
 2253              	.LBE132:
 2254              	.LBE131:
 2255              	.LBE130:
 2256              	.LBB134:
 2257              	.LBB135:
 2258              	.loc 6 283 0
 2259 0b7c 83C40C   	addl $12,%esp
 2260              	.LCFI206:
 2261              	.LBE135:
 2262              	.LBE134:
 2263              	.LBB136:
 2264              	.LBB137:
 2265              	.loc 6 236 0
 2266 0b7f 80780802 	cmpb $2,8(%eax)
 2267 0b83 7402     	je .L219
 2268              	.loc 6 288 0
 2269              	
 2270 0b85 0F0B     	ud2
 2271              	
 2272              	
 2273              	.L219:
 2274              	.loc 6 289 0
 2275 0b87 FF742444 	pushl 68(%esp)
 2276              	.LCFI207:
 2277 0b8b 52       	pushl %edx
 2278              	.LCFI208:
 2279 0b8c FF520C   	call *12(%edx)
 2280 0b8f 58       	popl %eax
 2281              	.LCFI209:
 2282 0b90 5A       	popl %edx
 2283              	.LCFI210:
 2284              	.LBE137:
 2285              	.LBE136:
 492:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 493:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	crypto_digest_init(tkey->tfm_michael);
 494:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	crypto_digest_setkey(tkey->tfm_michael, key, 8);
GAS LISTING  			page 100


 495:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	crypto_digest_update(tkey->tfm_michael, sg, 2);
 496:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	crypto_digest_final(tkey->tfm_michael, mic);
 497:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 498:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return 0;
 2286              	.loc 1 498 0
 2287 0b91 31C0     	xorl %eax,%eax
 2288              	.L204:
 499:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 2289              	.loc 1 499 0
 2290 0b93 83C420   	addl $32,%esp
 2291 0b96 5B       	popl %ebx
 2292 0b97 5E       	popl %esi
 2293 0b98 5F       	popl %edi
 2294 0b99 C3       	ret
 2295              	.LFE704:
 2298              	michael_mic_hdr:
 2299              	.LFB705:
 500:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 501:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static void michael_mic_hdr(struct sk_buff *skb, u8 * hdr)
 502:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 2300              	.loc 1 502 0
 503:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_hdr_4addr *hdr11;
 504:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 505:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	hdr11 = (struct ieee80211_hdr_4addr *)skb->data;
 2301              	.loc 1 505 0
 2302 0b9a 8B442404 	movl 4(%esp),%eax
 2303 0b9e 8B90A800 	movl 168(%eax),%edx
 2303      0000
 506:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	switch (le16_to_cpu(hdr11->frame_ctl) &
 507:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		(IEEE80211_FCTL_FROMDS | IEEE80211_FCTL_TODS)) {
 2304              	.loc 1 507 0
 2305 0ba4 0FB702   	movzwl (%edx),%eax
 2306 0ba7 25000300 	andl $768,%eax
 2306      00
 2307 0bac 3D000100 	cmpl $256,%eax
 2307      00
 2308              	.loc 1 502 0
 2309 0bb1 8B4C2408 	movl 8(%esp),%ecx
 2310              	.loc 1 507 0
 2311 0bb5 7418     	je .L225
 2312 0bb7 7F06     	jg .L405
 2313 0bb9 85C0     	testl %eax,%eax
 2314 0bbb 744F     	je .L360
 2315 0bbd EB68     	jmp .L224
 2316              	.L405:
 2317 0bbf 3D000200 	cmpl $512,%eax
 2317      00
 2318 0bc4 7414     	je .L270
 2319 0bc6 3D000300 	cmpl $768,%eax
 2319      00
 2320 0bcb 7426     	je .L315
 2321 0bcd EB58     	jmp .L224
 2322              	.L225:
 2323              	.LBB138:
 2324              	.LBB139:
 2325              	.loc 4 240 0
 2326 0bcf 8B4210   	movl 16(%edx),%eax
GAS LISTING  			page 101


 2327 0bd2 8901     	movl %eax,(%ecx)
 2328              	.loc 4 241 0
 2329 0bd4 668B4214 	movw 20(%edx),%ax
 2330 0bd8 EB3B     	jmp .L407
 2331              	.L270:
 2332              	.LBE139:
 2333              	.LBE138:
 2334              	.LBB140:
 2335              	.LBB141:
 2336              	.loc 4 240 0
 2337 0bda 8B4204   	movl 4(%edx),%eax
 2338 0bdd 8901     	movl %eax,(%ecx)
 2339              	.loc 4 241 0
 2340 0bdf 668B4208 	movw 8(%edx),%ax
 2341 0be3 66894104 	movw %ax,4(%ecx)
 2342              	.LBE141:
 2343              	.LBE140:
 2344              	.LBB142:
 2345              	.LBB143:
 2346              	.loc 4 240 0
 2347 0be7 8B4210   	movl 16(%edx),%eax
 2348 0bea 894106   	movl %eax,6(%ecx)
 2349              	.loc 4 241 0
 2350 0bed 668B4214 	movw 20(%edx),%ax
 2351 0bf1 EB30     	jmp .L406
 2352              	.L315:
 2353              	.LBE143:
 2354              	.LBE142:
 2355              	.LBB144:
 2356              	.LBB145:
 2357              	.loc 4 240 0
 2358 0bf3 8B4210   	movl 16(%edx),%eax
 2359 0bf6 8901     	movl %eax,(%ecx)
 2360              	.loc 4 241 0
 2361 0bf8 668B4214 	movw 20(%edx),%ax
 2362 0bfc 66894104 	movw %ax,4(%ecx)
 2363              	.LBE145:
 2364              	.LBE144:
 2365              	.LBB146:
 2366              	.LBB147:
 2367              	.loc 4 240 0
 2368 0c00 8B4218   	movl 24(%edx),%eax
 2369 0c03 894106   	movl %eax,6(%ecx)
 2370              	.loc 4 241 0
 2371 0c06 668B421C 	movw 28(%edx),%ax
 2372 0c0a EB17     	jmp .L406
 2373              	.L360:
 2374              	.LBE147:
 2375              	.LBE146:
 2376              	.LBB148:
 2377              	.LBB149:
 2378              	.loc 4 240 0
 2379 0c0c 8B4204   	movl 4(%edx),%eax
 2380 0c0f 8901     	movl %eax,(%ecx)
 2381              	.loc 4 241 0
 2382 0c11 668B4208 	movw 8(%edx),%ax
 2383              	.L407:
GAS LISTING  			page 102


 2384 0c15 66894104 	movw %ax,4(%ecx)
 2385              	.LBE149:
 2386              	.LBE148:
 2387              	.LBB150:
 2388              	.LBB151:
 2389              	.loc 4 240 0
 2390 0c19 8B420A   	movl 10(%edx),%eax
 2391 0c1c 894106   	movl %eax,6(%ecx)
 2392              	.loc 4 241 0
 2393 0c1f 668B420E 	movw 14(%edx),%ax
 2394              	.L406:
 2395 0c23 6689410A 	movw %ax,10(%ecx)
 2396              	.L224:
 2397              	.LBE151:
 2398              	.LBE150:
 508:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	case IEEE80211_FCTL_TODS:
 509:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		memcpy(hdr, hdr11->addr3, ETH_ALEN);	/* DA */
 510:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		memcpy(hdr + ETH_ALEN, hdr11->addr2, ETH_ALEN);	/* SA */
 511:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		break;
 512:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	case IEEE80211_FCTL_FROMDS:
 513:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		memcpy(hdr, hdr11->addr1, ETH_ALEN);	/* DA */
 514:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		memcpy(hdr + ETH_ALEN, hdr11->addr3, ETH_ALEN);	/* SA */
 515:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		break;
 516:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	case IEEE80211_FCTL_FROMDS | IEEE80211_FCTL_TODS:
 517:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		memcpy(hdr, hdr11->addr3, ETH_ALEN);	/* DA */
 518:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		memcpy(hdr + ETH_ALEN, hdr11->addr4, ETH_ALEN);	/* SA */
 519:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		break;
 520:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	case 0:
 521:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		memcpy(hdr, hdr11->addr1, ETH_ALEN);	/* DA */
 522:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		memcpy(hdr + ETH_ALEN, hdr11->addr2, ETH_ALEN);	/* SA */
 523:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		break;
 524:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 525:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 526:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	hdr[12] = 0;		/* priority */
 2399              	.loc 1 526 0
 2400 0c27 C6410C00 	movb $0,12(%ecx)
 527:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	hdr[13] = hdr[14] = hdr[15] = 0;	/* reserved */
 2401              	.loc 1 527 0
 2402 0c2b C6410F00 	movb $0,15(%ecx)
 2403 0c2f C6410E00 	movb $0,14(%ecx)
 2404 0c33 C6410D00 	movb $0,13(%ecx)
 2405 0c37 C3       	ret
 2406              	.LFE705:
 2408              	.section .rodata.str1.1
 2409              	.LC12:
 2410 02fb 3C373E49 	.string "<7>Invalid packet for Michael MIC add (tailroom=%d hdr_len=%d skb->len=%d)\n"
 2410      6E76616C 
 2410      69642070 
 2410      61636B65 
 2410      7420666F 
 2411              	.text
 2413              	ieee80211_michael_mic_add:
 2414              	.LFB706:
 528:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 529:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 530:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static int ieee80211_michael_mic_add(struct sk_buff *skb, int hdr_len,
 531:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 				     void *priv)
GAS LISTING  			page 103


 532:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 2415              	.loc 1 532 0
 2416 0c38 55       	pushl %ebp
 2417              	.LCFI211:
 2418 0c39 57       	pushl %edi
 2419              	.LCFI212:
 2420 0c3a 56       	pushl %esi
 2421              	.LCFI213:
 2422 0c3b 53       	pushl %ebx
 2423              	.LCFI214:
 2424              	.loc 1 532 0
 2425 0c3c 8B5C2414 	movl 20(%esp),%ebx
 2426              	.LBB152:
 2427              	.LBB153:
 2428              	.LBB154:
 2429              	.LBB155:
 2430              	.loc 5 703 0
 2431 0c40 8B5364   	movl 100(%ebx),%edx
 2432              	.LBE155:
 2433              	.LBE154:
 2434              	.loc 5 702 0
 2435 0c43 85D2     	testl %edx,%edx
 2436              	.LBE153:
 2437              	.LBE152:
 2438              	.loc 1 532 0
 2439 0c45 8B742418 	movl 24(%esp),%esi
 2440              	.LBB156:
 2441              	.LBB157:
 2442              	.loc 5 702 0
 2443 0c49 7528     	jne .L415
 2444 0c4b 8B83B000 	movl 176(%ebx),%eax
 2444      0000
 2445 0c51 2B83AC00 	subl 172(%ebx),%eax
 2445      0000
 2446              	.LBE157:
 2447              	.LBE156:
 2448              	.loc 5 857 0
 2449 0c57 83F807   	cmpl $7,%eax
 2450 0c5a 7E05     	jle .L410
 2451 0c5c 397360   	cmpl %esi,96(%ebx)
 2452 0c5f 732B     	jae .L409
 2453              	.L410:
 2454              	.LBB158:
 2455              	.LBB159:
 2456              	.loc 5 702 0
 2457 0c61 85D2     	testl %edx,%edx
 2458 0c63 750E     	jne .L415
 2459 0c65 8B83B000 	movl 176(%ebx),%eax
 2459      0000
 2460 0c6b 2B83AC00 	subl 172(%ebx),%eax
 2460      0000
 2461 0c71 EB02     	jmp .L416
 2462              	.L415:
 2463 0c73 31C0     	xorl %eax,%eax
 2464              	.L416:
 2465              	.LBE159:
 2466              	.LBE158:
GAS LISTING  			page 104


 2467              	.loc 5 857 0
 2468 0c75 FF7360   	pushl 96(%ebx)
 2469              	.LCFI215:
 2470 0c78 56       	pushl %esi
 2471              	.LCFI216:
 2472 0c79 50       	pushl %eax
 2473              	.LCFI217:
 2474 0c7a 68FB0200 	pushl $.LC12
 2474      00
 2475              	.LCFI218:
 2476 0c7f E8FCFFFF 	call printk
 2476      FF
 533:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_tkip_data *tkey = priv;
 534:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u8 *pos;
 535:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 536:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (skb_tailroom(skb) < 8 || skb->len < hdr_len) {
 537:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		printk(KERN_DEBUG "Invalid packet for Michael MIC add "
 538:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		       "(tailroom=%d hdr_len=%d skb->len=%d)\n",
 539:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		       skb_tailroom(skb), hdr_len, skb->len);
 540:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 2477              	.loc 1 540 0
 2478 0c84 83C410   	addl $16,%esp
 2479              	.LCFI219:
 2480 0c87 83C8FF   	orl $-1,%eax
 2481 0c8a EB71     	jmp .L408
 2482              	.L409:
 541:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 542:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 543:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	michael_mic_hdr(skb, tkey->tx_hdr);
 2483              	.loc 1 543 0
 2484 0c8c 8B6C241C 	movl 28(%esp),%ebp
 2485 0c90 83C57C   	addl $124,%ebp
 2486 0c93 55       	pushl %ebp
 2487              	.LCFI220:
 2488 0c94 53       	pushl %ebx
 2489              	.LCFI221:
 2490 0c95 E800FFFF 	call michael_mic_hdr
 2490      FF
 2491              	.loc 5 757 0
 2492 0c9a 5F       	popl %edi
 2493              	.LCFI222:
 2494              	.LBB160:
 2495              	.LBB161:
 2496              	.loc 5 702 0
 2497 0c9b 837B6400 	cmpl $0,100(%ebx)
 2498              	.LBE161:
 2499              	.LBE160:
 2500              	.loc 5 757 0
 2501 0c9f 58       	popl %eax
 2502              	.LCFI223:
 2503              	.LBB162:
 2504              	.LBB163:
 2505              	.loc 5 758 0
 2506 0ca0 8BBBAC00 	movl 172(%ebx),%edi
 2506      0000
 2507              	.loc 5 702 0
 2508 0ca6 7402     	je .L419
GAS LISTING  			page 105


 2509              	.loc 5 759 0
 2510              	
 2511 0ca8 0F0B     	ud2
 2512              	
 2513              	
 2514              	.L419:
 2515              	.loc 5 760 0
 2516 0caa 8D4708   	leal 8(%edi),%eax
 2517              	.loc 5 761 0
 2518 0cad 83436008 	addl $8,96(%ebx)
 2519              	.loc 5 762 0
 2520 0cb1 3B83B000 	cmpl 176(%ebx),%eax
 2520      0000
 2521              	.loc 5 760 0
 2522 0cb7 8983AC00 	movl %eax,172(%ebx)
 2522      0000
 2523              	.loc 5 762 0
 2524 0cbd 7611     	jbe .L422
 2525              	.LBB164:
 2526              	.loc 5 763 0
 2527              	
 2528 0cbf B8C40C00 	movl $1f,%eax
 2528      00
 2529              	1:
 2530              	
 2531              	.LBE164:
 2532 0cc4 50       	pushl %eax
 2533              	.LCFI224:
 2534 0cc5 6A08     	pushl $8
 2535              	.LCFI225:
 2536 0cc7 53       	pushl %ebx
 2537              	.LCFI226:
 2538 0cc8 E8FCFFFF 	call skb_over_panic
 2538      FF
 2539 0ccd 83C40C   	addl $12,%esp
 2540              	.LCFI227:
 2541              	.L422:
 2542              	.LBE163:
 2543              	.LBE162:
 544:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	pos = skb_put(skb, 8);
 545:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (michael_mic(tkey, &tkey->key[16], tkey->tx_hdr,
 2544              	.loc 1 545 0
 2545 0cd0 57       	pushl %edi
 2546              	.LCFI228:
 2547 0cd1 8B4360   	movl 96(%ebx),%eax
 2548 0cd4 29F0     	subl %esi,%eax
 2549 0cd6 83E808   	subl $8,%eax
 2550 0cd9 50       	pushl %eax
 2551              	.LCFI229:
 2552 0cda 03B3A800 	addl 168(%ebx),%esi
 2552      0000
 2553 0ce0 56       	pushl %esi
 2554              	.LCFI230:
 2555 0ce1 55       	pushl %ebp
 2556              	.LCFI231:
 2557 0ce2 8B44242C 	movl 44(%esp),%eax
 2558 0ce6 83C010   	addl $16,%eax
GAS LISTING  			page 106


 2559 0ce9 50       	pushl %eax
 2560              	.LCFI232:
 2561 0cea FF742430 	pushl 48(%esp)
 2562              	.LCFI233:
 2563 0cee E8C1FDFF 	call michael_mic
 2563      FF
 2564 0cf3 83C418   	addl $24,%esp
 2565              	.LCFI234:
 546:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			skb->data + hdr_len, skb->len - 8 - hdr_len, pos))
 547:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 2566              	.loc 1 547 0
 2567 0cf6 83F801   	cmpl $1,%eax
 2568 0cf9 19C0     	sbbl %eax,%eax
 2569 0cfb F7D0     	notl %eax
 2570              	.L408:
 548:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 549:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return 0;
 550:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 2571              	.loc 1 550 0
 2572 0cfd 5B       	popl %ebx
 2573 0cfe 5E       	popl %esi
 2574 0cff 5F       	popl %edi
 2575 0d00 5D       	popl %ebp
 2576 0d01 C3       	ret
 2577              	.LFE706:
 2579              	.section .rodata.str1.1
 2580              	.LC13:
 2581 0347 62726F61 	.string "broad"
 2581      6400
 2582              	.LC14:
 2583 034d 756E6900 	.string "uni"
 2584              	.LC15:
 2585 0351 4D4C4D45 	.string "MLME-MICHAELMICFAILURE.indication(keyid=%d %scast addr=%02x:%02x:%02x:%02x:%02x:%02x)"
 2585      2D4D4943 
 2585      4841454C 
 2585      4D494346 
 2585      41494C55 
 2586              	.text
 2588              	ieee80211_michael_mic_failure:
 2589              	.LFB707:
 551:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 552:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #if WIRELESS_EXT >= 18
 553:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static void ieee80211_michael_mic_failure(struct net_device *dev,
 554:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 					  struct ieee80211_hdr_4addr *hdr,
 555:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 					  int keyidx)
 556:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 557:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	union iwreq_data wrqu;
 558:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct iw_michaelmicfailure ev;
 559:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 560:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	/* TODO: needed parameters: count, keyid, key type, TSC */
 561:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	memset(&ev, 0, sizeof(ev));
 562:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	ev.flags = keyidx & IW_MICFAILURE_KEY_ID;
 563:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (hdr->addr1[0] & 0x01)
 564:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		ev.flags |= IW_MICFAILURE_GROUP;
 565:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	else
 566:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		ev.flags |= IW_MICFAILURE_PAIRWISE;
 567:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	ev.src_addr.sa_family = ARPHRD_ETHER;
GAS LISTING  			page 107


 568:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	memcpy(ev.src_addr.sa_data, hdr->addr2, ETH_ALEN);
 569:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	memset(&wrqu, 0, sizeof(wrqu));
 570:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	wrqu.data.length = sizeof(ev);
 571:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	wireless_send_event(dev, IWEVMICHAELMICFAILURE, &wrqu, (char *)&ev);
 572:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 573:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #elif WIRELESS_EXT >= 15
 574:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static void ieee80211_michael_mic_failure(struct net_device *dev,
 575:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 					  struct ieee80211_hdr_4addr *hdr,
 576:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 					  int keyidx)
 577:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 2590              	.loc 1 577 0
 2591 0d02 57       	pushl %edi
 2592              	.LCFI235:
 2593 0d03 53       	pushl %ebx
 2594              	.LCFI236:
 2595 0d04 81EC9400 	subl $148,%esp
 2595      0000
 2596              	.LCFI237:
 2597              	.loc 1 577 0
 2598 0d0a 8B9424A4 	movl 164(%esp),%edx
 2598      000000
 578:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	union iwreq_data wrqu;
 579:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	char buf[128];
 580:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 581:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	/* TODO: needed parameters: count, keyid, key type, TSC */
 582:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	sprintf(buf, "MLME-MICHAELMICFAILURE.indication(keyid=%d %scast addr="
 2599              	.loc 1 582 0
 2600 0d11 0FB6420F 	movzbl 15(%edx),%eax
 2601 0d15 50       	pushl %eax
 2602              	.LCFI238:
 2603 0d16 0FB6420E 	movzbl 14(%edx),%eax
 2604 0d1a 50       	pushl %eax
 2605              	.LCFI239:
 2606 0d1b 0FB6420D 	movzbl 13(%edx),%eax
 2607 0d1f 50       	pushl %eax
 2608              	.LCFI240:
 2609 0d20 0FB6420C 	movzbl 12(%edx),%eax
 2610 0d24 50       	pushl %eax
 2611              	.LCFI241:
 2612 0d25 0FB6420B 	movzbl 11(%edx),%eax
 2613 0d29 50       	pushl %eax
 2614              	.LCFI242:
 2615 0d2a 0FB6420A 	movzbl 10(%edx),%eax
 2616 0d2e 50       	pushl %eax
 2617              	.LCFI243:
 2618 0d2f F6420401 	testb $1,4(%edx)
 2619 0d33 B8470300 	movl $.LC13,%eax
 2619      00
 2620 0d38 7505     	jne .L428
 2621 0d3a B84D0300 	movl $.LC14,%eax
 2621      00
 2622              	.L428:
 2623 0d3f 50       	pushl %eax
 2624              	.LCFI244:
 2625 0d40 FFB424C4 	pushl 196(%esp)
 2625      000000
 2626              	.LCFI245:
GAS LISTING  			page 108


 2627 0d47 68510300 	pushl $.LC15
 2627      00
 2628              	.LCFI246:
 2629 0d4c 8D5C2428 	leal 40(%esp),%ebx
 2630 0d50 53       	pushl %ebx
 2631              	.LCFI247:
 2632 0d51 E8FCFFFF 	call sprintf
 2632      FF
 2633              	.loc 4 420 0
 2634 0d56 83C428   	addl $40,%esp
 2635              	.LCFI248:
 2636              	.LBB165:
 2637 0d59 31C0     	xorl %eax,%eax
 2638              	.LBB166:
 2639              	.LBB167:
 2640              	.loc 4 448 0
 2641 0d5b B9040000 	movl $4,%ecx
 2641      00
 2642 0d60 8DBC2484 	leal 132(%esp),%edi
 2642      000000
 2643              	
 2644 0d67 F3AB     	rep
 2645              	
 2646              	.LBE167:
 2647              	.LBE166:
 2648              	.LBE165:
 2649              	.LBB168:
 2650              	.LBB169:
 2651              	.loc 4 193 0
 2652 0d69 83C9FF   	orl $-1,%ecx
 2653 0d6c 89DF     	movl %ebx,%edi
 2654              	
 2655 0d6e F2       	repne
 2656 0d6f AE       	scasb
 2657 0d70 F7D1     	notl %ecx
 2658 0d72 49       	decl %ecx
 2659              	
 2660              	.LBE169:
 2661              	.LBE168:
 2662              	.loc 4 190 0
 2663 0d73 66898C24 	movw %cx,136(%esp)
 2663      88000000 
 583:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		MAC_FMT ")", keyidx, hdr->addr1[0] & 0x01 ? "broad" : "uni",
 584:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		MAC_ARG(hdr->addr2));
 585:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	memset(&wrqu, 0, sizeof(wrqu));
 586:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	wrqu.data.length = strlen(buf);
 587:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	wireless_send_event(dev, IWEVCUSTOM, &wrqu, buf);
 2664              	.loc 1 587 0
 2665 0d7b 53       	pushl %ebx
 2666              	.LCFI249:
 2667 0d7c 8D842488 	leal 136(%esp),%eax
 2667      000000
 2668 0d83 50       	pushl %eax
 2669              	.LCFI250:
 2670 0d84 68028C00 	pushl $35842
 2670      00
 2671              	.LCFI251:
GAS LISTING  			page 109


 2672 0d89 FFB424AC 	pushl 172(%esp)
 2672      000000
 2673              	.LCFI252:
 2674 0d90 E8FCFFFF 	call wireless_send_event
 2674      FF
 2675 0d95 81C4A400 	addl $164,%esp
 2675      0000
 2676 0d9b 5B       	popl %ebx
 2677 0d9c 5F       	popl %edi
 2678 0d9d C3       	ret
 2679              	.LCFI253:
 2680              	.LFE707:
 2682              	.section .rodata.str1.1
 2683              	.LC16:
 2684 03a7 4E2F4100 	.string "N/A"
 2685              	.LC17:
 2686 03ab 3C373E25 	.string "<7>%s: Michael MIC verification failed for MSDU from %02x:%02x:%02x:%02x:%02x:%02x keyidx=%d\n"
 2686      733A204D 
 2686      69636861 
 2686      656C204D 
 2686      49432076 
 2687              	.text
 2689              	ieee80211_michael_mic_verify:
 2690              	.LFB708:
 588:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 589:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #else	/* WIRELESS_EXT >= 15 */
 590:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static inline void ieee80211_michael_mic_failure(struct net_device *dev,
 591:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 						 struct ieee80211_hdr_4addr
 592:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 						 *hdr, int keyidx)
 593:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 594:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 595:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** #endif	/* WIRELESS_EXT >= 15 */
 596:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 597:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static int ieee80211_michael_mic_verify(struct sk_buff *skb, int keyidx,
 598:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 					int hdr_len, void *priv)
 599:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 2691              	.loc 1 599 0
 2692 0d9e 55       	pushl %ebp
 2693              	.LCFI254:
 2694 0d9f 57       	pushl %edi
 2695              	.LCFI255:
 2696 0da0 56       	pushl %esi
 2697              	.LCFI256:
 2698 0da1 53       	pushl %ebx
 2699              	.LCFI257:
 2700              	.loc 1 599 0
 2701 0da2 53       	pushl %ebx
 2702              	.LCFI258:
 2703 0da3 53       	pushl %ebx
 2704              	.LCFI259:
 2705 0da4 8B6C2428 	movl 40(%esp),%ebp
 600:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_tkip_data *tkey = priv;
 601:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	u8 mic[8];
 602:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 603:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (!tkey->key_set)
 604:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 2706              	.loc 1 604 0
GAS LISTING  			page 110


 2707 0da8 83CAFF   	orl $-1,%edx
 2708              	.loc 1 603 0
 2709 0dab 837D2000 	cmpl $0,32(%ebp)
 2710              	.loc 1 599 0
 2711 0daf 8B7C241C 	movl 28(%esp),%edi
 2712 0db3 8B742424 	movl 36(%esp),%esi
 2713              	.loc 1 603 0
 2714 0db7 0F84F000 	je .L443
 2714      0000
 605:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 606:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	michael_mic_hdr(skb, tkey->rx_hdr);
 2715              	.loc 1 606 0
 2716 0dbd 8D5D6C   	leal 108(%ebp),%ebx
 2717 0dc0 53       	pushl %ebx
 2718              	.LCFI260:
 2719 0dc1 57       	pushl %edi
 2720              	.LCFI261:
 2721              	.LCFI262:
 2722 0dc2 E8D3FDFF 	call michael_mic_hdr
 2722      FF
 607:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (michael_mic(tkey, &tkey->key[24], tkey->rx_hdr,
 2723              	.loc 1 607 0
 2724 0dc7 8D442408 	leal 8(%esp),%eax
 2725 0dcb 50       	pushl %eax
 2726              	.LCFI263:
 2727 0dcc 8B4760   	movl 96(%edi),%eax
 2728 0dcf 29F0     	subl %esi,%eax
 2729 0dd1 83E808   	subl $8,%eax
 2730 0dd4 50       	pushl %eax
 2731              	.LCFI264:
 2732 0dd5 03B7A800 	addl 168(%edi),%esi
 2732      0000
 2733 0ddb 56       	pushl %esi
 2734              	.LCFI265:
 2735 0ddc 53       	pushl %ebx
 2736              	.LCFI266:
 2737 0ddd 8D4518   	leal 24(%ebp),%eax
 2738 0de0 50       	pushl %eax
 2739              	.LCFI267:
 2740 0de1 55       	pushl %ebp
 2741              	.LCFI268:
 2742              	.LCFI269:
 2743 0de2 E8CDFCFF 	call michael_mic
 2743      FF
 2744 0de7 83C420   	addl $32,%esp
 2745              	.LCFI270:
 608:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			skb->data + hdr_len, skb->len - 8 - hdr_len, mic))
 609:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 2746              	.loc 1 609 0
 2747 0dea 83CAFF   	orl $-1,%edx
 2748              	.loc 1 607 0
 2749 0ded 85C0     	testl %eax,%eax
 2750 0def 0F85B800 	jne .L443
 2750      0000
 610:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (memcmp(mic, skb->data + skb->len - 8, 8) != 0) {
 2751              	.loc 1 610 0
 2752 0df5 8B9FA800 	movl 168(%edi),%ebx
GAS LISTING  			page 111


 2752      0000
 2753 0dfb 89D8     	movl %ebx,%eax
 2754 0dfd 034760   	addl 96(%edi),%eax
 2755 0e00 83E808   	subl $8,%eax
 2756 0e03 6A08     	pushl $8
 2757              	.LCFI271:
 2758 0e05 50       	pushl %eax
 2759              	.LCFI272:
 2760 0e06 8D442408 	leal 8(%esp),%eax
 2761 0e0a 50       	pushl %eax
 2762              	.LCFI273:
 2763              	.LCFI274:
 2764 0e0b E8FCFFFF 	call memcmp
 2764      FF
 2765 0e10 83C40C   	addl $12,%esp
 2766              	.LCFI275:
 2767 0e13 85C0     	testl %eax,%eax
 2768 0e15 7459     	je .L446
 2769              	.LBB170:
 611:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		struct ieee80211_hdr_4addr *hdr;
 612:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		hdr = (struct ieee80211_hdr_4addr *)skb->data;
 613:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		printk(KERN_DEBUG "%s: Michael MIC verification failed for "
 2770              	.loc 1 613 0
 2771 0e17 FF742420 	pushl 32(%esp)
 2772              	.LCFI276:
 2773 0e1b 0FB6430F 	movzbl 15(%ebx),%eax
 2774 0e1f 50       	pushl %eax
 2775              	.LCFI277:
 2776 0e20 0FB6430E 	movzbl 14(%ebx),%eax
 2777 0e24 50       	pushl %eax
 2778              	.LCFI278:
 2779 0e25 0FB6430D 	movzbl 13(%ebx),%eax
 2780 0e29 50       	pushl %eax
 2781              	.LCFI279:
 2782 0e2a 0FB6430C 	movzbl 12(%ebx),%eax
 2783 0e2e 50       	pushl %eax
 2784              	.LCFI280:
 2785 0e2f 0FB6430B 	movzbl 11(%ebx),%eax
 2786 0e33 50       	pushl %eax
 2787              	.LCFI281:
 2788 0e34 0FB6430A 	movzbl 10(%ebx),%eax
 2789 0e38 50       	pushl %eax
 2790              	.LCFI282:
 2791 0e39 8B4718   	movl 24(%edi),%eax
 2792 0e3c 85C0     	testl %eax,%eax
 2793 0e3e 7505     	jne .L447
 2794 0e40 B8A70300 	movl $.LC16,%eax
 2794      00
 2795              	.L447:
 2796 0e45 50       	pushl %eax
 2797              	.LCFI283:
 2798 0e46 68AB0300 	pushl $.LC17
 2798      00
 2799              	.LCFI284:
 2800              	.LCFI285:
 2801 0e4b E8FCFFFF 	call printk
 2801      FF
GAS LISTING  			page 112


 614:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		       "MSDU from " MAC_FMT " keyidx=%d\n",
 615:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		       skb->dev ? skb->dev->name : "N/A", MAC_ARG(hdr->addr2),
 616:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		       keyidx);
 617:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		if (skb->dev)
 2802              	.loc 1 617 0
 2803 0e50 8B4718   	movl 24(%edi),%eax
 2804 0e53 83C424   	addl $36,%esp
 2805              	.LCFI286:
 2806 0e56 85C0     	testl %eax,%eax
 2807 0e58 740E     	je .L448
 618:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			ieee80211_michael_mic_failure(skb->dev, hdr, keyidx);
 2808              	.loc 1 618 0
 2809 0e5a FF742420 	pushl 32(%esp)
 2810              	.LCFI287:
 2811 0e5e 53       	pushl %ebx
 2812              	.LCFI288:
 2813 0e5f 50       	pushl %eax
 2814              	.LCFI289:
 2815              	.LCFI290:
 2816 0e60 E89DFEFF 	call ieee80211_michael_mic_failure
 2816      FF
 2817 0e65 83C40C   	addl $12,%esp
 2818              	.LCFI291:
 2819              	.L448:
 619:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		tkey->dot11RSNAStatsTKIPLocalMICFailures++;
 2820              	.loc 1 619 0
 2821 0e68 FF455C   	incl 92(%ebp)
 620:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 2822              	.loc 1 620 0
 2823 0e6b 83CAFF   	orl $-1,%edx
 2824 0e6e EB3D     	jmp .L443
 2825              	.LCFI292:
 2826              	.L446:
 2827              	.LBE170:
 621:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 622:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 623:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	/* Update TSC counters for RX now that the packet verification has
 624:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	 * completed. */
 625:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	tkey->rx_iv32 = tkey->rx_iv32_new;
 2828              	.loc 1 625 0
 2829 0e70 8B454C   	movl 76(%ebp),%eax
 2830 0e73 894538   	movl %eax,56(%ebp)
 626:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	tkey->rx_iv16 = tkey->rx_iv16_new;
 2831              	.loc 1 626 0
 2832 0e76 668B4550 	movw 80(%ebp),%ax
 2833 0e7a 6689453C 	movw %ax,60(%ebp)
 2834              	.LBB171:
 2835              	.loc 5 919 0
 2836 0e7e 8B4760   	movl 96(%edi),%eax
 2837 0e81 8D50F8   	leal -8(%eax),%edx
 2838              	.LBB172:
 2839              	.loc 5 920 0
 2840 0e84 39D0     	cmpl %edx,%eax
 2841 0e86 7623     	jbe .L453
 2842              	.LBB173:
 2843              	.LBB174:
 2844              	.loc 5 903 0
GAS LISTING  			page 113


 2845 0e88 837F6400 	cmpl $0,100(%edi)
 2846 0e8c 7511     	jne .L450
 2847              	.loc 5 904 0
 2848 0e8e 895760   	movl %edx,96(%edi)
 2849              	.loc 5 905 0
 2850 0e91 0397A800 	addl 168(%edi),%edx
 2850      0000
 2851 0e97 8997AC00 	movl %edx,172(%edi)
 2851      0000
 2852 0e9d EB0C     	jmp .L453
 2853              	.L450:
 2854              	.loc 5 907 0
 2855 0e9f 6A00     	pushl $0
 2856              	.LCFI293:
 2857 0ea1 52       	pushl %edx
 2858              	.LCFI294:
 2859 0ea2 57       	pushl %edi
 2860              	.LCFI295:
 2861 0ea3 E8FCFFFF 	call ___pskb_trim
 2861      FF
 2862 0ea8 83C40C   	addl $12,%esp
 2863              	.LCFI296:
 2864              	.L453:
 2865              	.LBE174:
 2866              	.LBE173:
 2867              	.LBE172:
 2868              	.LBE171:
 627:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 628:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	skb_trim(skb, skb->len - 8);
 629:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 630:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return 0;
 2869              	.loc 1 630 0
 2870 0eab 31D2     	xorl %edx,%edx
 2871              	.L443:
 631:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 2872              	.loc 1 631 0
 2873 0ead 89D0     	movl %edx,%eax
 2874 0eaf 5A       	popl %edx
 2875              	.LCFI297:
 2876 0eb0 59       	popl %ecx
 2877              	.LCFI298:
 2878 0eb1 5B       	popl %ebx
 2879 0eb2 5E       	popl %esi
 2880 0eb3 5F       	popl %edi
 2881 0eb4 5D       	popl %ebp
 2882 0eb5 C3       	ret
 2883              	.LFE708:
 2886              	ieee80211_tkip_set_key:
 2887              	.LFB709:
 632:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 633:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static int ieee80211_tkip_set_key(void *key, int len, u8 * seq, void *priv)
 634:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 2888              	.loc 1 634 0
 2889 0eb6 55       	pushl %ebp
 2890              	.LCFI299:
 2891 0eb7 57       	pushl %edi
 2892              	.LCFI300:
GAS LISTING  			page 114


 2893 0eb8 56       	pushl %esi
 2894              	.LCFI301:
 2895 0eb9 53       	pushl %ebx
 2896              	.LCFI302:
 2897              	.loc 1 634 0
 2898 0eba 55       	pushl %ebp
 2899              	.LCFI303:
 2900 0ebb 55       	pushl %ebp
 2901              	.LCFI304:
 2902 0ebc 8B6C2428 	movl 40(%esp),%ebp
 635:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_tkip_data *tkey = priv;
 636:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	int keyidx;
 637:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct crypto_tfm *tfm = tkey->tfm_michael;
 638:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct crypto_tfm *tfm2 = tkey->tfm_arc4;
 2903              	.loc 1 638 0
 2904 0ec0 8B4564   	movl 100(%ebp),%eax
 2905              	.loc 1 637 0
 2906 0ec3 8B5D68   	movl 104(%ebp),%ebx
 2907              	.loc 1 638 0
 2908 0ec6 89442404 	movl %eax,4(%esp)
 2909              	.loc 1 634 0
 2910 0eca 8B74241C 	movl 28(%esp),%esi
 639:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 640:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	keyidx = tkey->key_idx;
 2911              	.loc 1 640 0
 2912 0ece 8B5560   	movl 96(%ebp),%edx
 2913              	.LBB175:
 2914              	.loc 4 420 0
 2915 0ed1 31C0     	xorl %eax,%eax
 2916              	.LBB176:
 2917              	.LBB177:
 2918              	.loc 4 448 0
 2919 0ed3 B9240000 	movl $36,%ecx
 2919      00
 2920 0ed8 89EF     	movl %ebp,%edi
 2921              	
 2922 0eda F3AB     	rep
 2923              	
 2924              	.LBE177:
 2925              	.LBE176:
 2926              	.LBE175:
 641:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	memset(tkey, 0, sizeof(*tkey));
 642:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	tkey->key_idx = keyidx;
 2927              	.loc 1 642 0
 2928 0edc 895560   	movl %edx,96(%ebp)
 643:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	tkey->tfm_michael = tfm;
 2929              	.loc 1 643 0
 2930 0edf 895D68   	movl %ebx,104(%ebp)
 644:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	tkey->tfm_arc4 = tfm2;
 2931              	.loc 1 644 0
 2932 0ee2 8B4C2404 	movl 4(%esp),%ecx
 2933 0ee6 894D64   	movl %ecx,100(%ebp)
 645:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (len == TKIP_KEY_LEN) {
 2934              	.loc 1 645 0
 2935 0ee9 837C2420 	cmpl $32,32(%esp)
 2935      20
 2936 0eee 755A     	jne .L468
GAS LISTING  			page 115


 2937              	.LBB178:
 2938              	.LBB179:
 2939              	.LBB180:
 2940              	.loc 4 252 0
 2941 0ef0 B9080000 	movl $8,%ecx
 2941      00
 2942 0ef5 89EF     	movl %ebp,%edi
 2943              	
 2944 0ef7 F3A5     	rep
 2945              	
 2946              	.LBE180:
 2947              	.LBE179:
 2948              	.LBE178:
 646:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		memcpy(tkey->key, key, TKIP_KEY_LEN);
 647:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		tkey->key_set = 1;
 2949              	.loc 1 647 0
 2950 0ef9 C7452001 	movl $1,32(%ebp)
 2950      000000
 648:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		tkey->tx_iv16 = 1;	/* TSC is initialized to 1 */
 2951              	.loc 1 648 0
 2952 0f00 66C74528 	movw $1,40(%ebp)
 2952      0100
 649:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		if (seq) {
 2953              	.loc 1 649 0
 2954 0f06 837C2424 	cmpl $0,36(%esp)
 2954      00
 2955 0f0b 744E     	je .L492
 650:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			tkey->rx_iv32 = (seq[5] << 24) | (seq[4] << 16) |
 2956              	.loc 1 650 0
 2957 0f0d 8B442424 	movl 36(%esp),%eax
 2958 0f11 0FB65005 	movzbl 5(%eax),%edx
 2959 0f15 0FB64004 	movzbl 4(%eax),%eax
 2960 0f19 8B4C2424 	movl 36(%esp),%ecx
 2961 0f1d C1E010   	sall $16,%eax
 2962 0f20 C1E218   	sall $24,%edx
 2963 0f23 09C2     	orl %eax,%edx
 2964 0f25 0FB64103 	movzbl 3(%ecx),%eax
 2965 0f29 C1E008   	sall $8,%eax
 2966 0f2c 09C2     	orl %eax,%edx
 2967 0f2e 0FB64102 	movzbl 2(%ecx),%eax
 2968 0f32 09C2     	orl %eax,%edx
 2969 0f34 895538   	movl %edx,56(%ebp)
 651:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			    (seq[3] << 8) | seq[2];
 652:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			tkey->rx_iv16 = (seq[1] << 8) | seq[0];
 2970              	.loc 1 652 0
 2971 0f37 0FB65101 	movzbl 1(%ecx),%edx
 2972 0f3b 660FB601 	movzbw (%ecx),%ax
 2973 0f3f C1E208   	sall $8,%edx
 2974 0f42 09D0     	orl %edx,%eax
 2975 0f44 6689453C 	movw %ax,60(%ebp)
 2976 0f48 EB11     	jmp .L492
 2977              	.LCFI305:
 2978              	.L468:
 653:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		}
 654:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	} else if (len == 0)
 655:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		tkey->key_set = 0;
 656:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	else
GAS LISTING  			page 116


 657:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 2979              	.loc 1 657 0
 2980 0f4a 83C8FF   	orl $-1,%eax
 2981              	.loc 1 654 0
 2982 0f4d 837C2420 	cmpl $0,32(%esp)
 2982      00
 2983 0f52 7509     	jne .L454
 2984              	.loc 1 655 0
 2985 0f54 C7452000 	movl $0,32(%ebp)
 2985      000000
 2986              	.L492:
 658:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 659:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return 0;
 2987              	.loc 1 659 0
 2988 0f5b 31C0     	xorl %eax,%eax
 2989              	.L454:
 660:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 2990              	.loc 1 660 0
 2991 0f5d 5E       	popl %esi
 2992              	.LCFI306:
 2993 0f5e 5F       	popl %edi
 2994              	.LCFI307:
 2995 0f5f 5B       	popl %ebx
 2996 0f60 5E       	popl %esi
 2997 0f61 5F       	popl %edi
 2998 0f62 5D       	popl %ebp
 2999 0f63 C3       	ret
 3000              	.LFE709:
 3003              	ieee80211_tkip_get_key:
 3004              	.LFB710:
 661:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 662:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static int ieee80211_tkip_get_key(void *key, int len, u8 * seq, void *priv)
 663:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 3005              	.loc 1 663 0
 3006 0f64 57       	pushl %edi
 3007              	.LCFI308:
 3008 0f65 56       	pushl %esi
 3009              	.LCFI309:
 3010 0f66 53       	pushl %ebx
 3011              	.LCFI310:
 664:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_tkip_data *tkey = priv;
 665:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 666:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (len < TKIP_KEY_LEN)
 667:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return -1;
 3012              	.loc 1 667 0
 3013 0f67 83C8FF   	orl $-1,%eax
 3014              	.loc 1 666 0
 3015 0f6a 837C2414 	cmpl $31,20(%esp)
 3015      1F
 3016              	.loc 1 663 0
 3017 0f6f 8B7C2410 	movl 16(%esp),%edi
 3018 0f73 8B5C2418 	movl 24(%esp),%ebx
 3019 0f77 8B54241C 	movl 28(%esp),%edx
 3020              	.loc 1 666 0
 3021 0f7b 7E45     	jle .L495
 668:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 669:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (!tkey->key_set)
GAS LISTING  			page 117


 670:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		return 0;
 3022              	.loc 1 670 0
 3023 0f7d 31C0     	xorl %eax,%eax
 3024              	.loc 1 669 0
 3025 0f7f 837A2000 	cmpl $0,32(%edx)
 3026 0f83 743D     	je .L495
 3027              	.LBB181:
 3028              	.LBB182:
 3029              	.LBB183:
 3030              	.loc 4 252 0
 3031 0f85 B9080000 	movl $8,%ecx
 3031      00
 3032 0f8a 89D6     	movl %edx,%esi
 3033              	
 3034 0f8c F3A5     	rep
 3035              	
 3036              	.LBE183:
 3037              	.LBE182:
 3038              	.LBE181:
 671:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	memcpy(key, tkey->key, TKIP_KEY_LEN);
 672:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 673:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	if (seq) {
 3039              	.loc 1 673 0
 3040 0f8e 85DB     	testl %ebx,%ebx
 3041 0f90 742B     	je .L520
 3042              	.LBB184:
 674:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		/* Return the sequence number of the last transmitted frame. */
 675:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		u16 iv16 = tkey->tx_iv16;
 3043              	.loc 1 675 0
 3044 0f92 668B4228 	movw 40(%edx),%ax
 676:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		u32 iv32 = tkey->tx_iv32;
 677:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		if (iv16 == 0)
 678:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 			iv32--;
 679:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		iv16--;
 680:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		seq[0] = tkey->tx_iv16;
 3045              	.loc 1 680 0
 3046 0f96 8803     	movb %al,(%ebx)
 681:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		seq[1] = tkey->tx_iv16 >> 8;
 3047              	.loc 1 681 0
 3048 0f98 660FB642 	movzbw 41(%edx),%ax
 3048      29
 3049 0f9d 884301   	movb %al,1(%ebx)
 682:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		seq[2] = tkey->tx_iv32;
 3050              	.loc 1 682 0
 3051 0fa0 8B4224   	movl 36(%edx),%eax
 3052 0fa3 884302   	movb %al,2(%ebx)
 683:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		seq[3] = tkey->tx_iv32 >> 8;
 3053              	.loc 1 683 0
 3054 0fa6 8B4224   	movl 36(%edx),%eax
 3055 0fa9 C1E808   	shrl $8,%eax
 3056 0fac 884303   	movb %al,3(%ebx)
 684:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		seq[4] = tkey->tx_iv32 >> 16;
 3057              	.loc 1 684 0
 3058 0faf 0FB74226 	movzwl 38(%edx),%eax
 3059 0fb3 884304   	movb %al,4(%ebx)
 685:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		seq[5] = tkey->tx_iv32 >> 24;
 3060              	.loc 1 685 0
GAS LISTING  			page 118


 3061 0fb6 0FB64227 	movzbl 39(%edx),%eax
 3062 0fba 884305   	movb %al,5(%ebx)
 3063              	.L520:
 3064              	.LBE184:
 686:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	}
 687:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 688:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return TKIP_KEY_LEN;
 3065              	.loc 1 688 0
 3066 0fbd B8200000 	movl $32,%eax
 3066      00
 3067              	.L495:
 689:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 3068              	.loc 1 689 0
 3069 0fc2 5B       	popl %ebx
 3070 0fc3 5E       	popl %esi
 3071 0fc4 5F       	popl %edi
 3072 0fc5 C3       	ret
 3073              	.LFE710:
 3075              	.section .rodata.str1.1
 3076              	.LC18:
 3077 0409 6B65795B 	.string "key[%d] alg=TKIP key_set=%d tx_pn=%02x%02x%02x%02x%02x%02x rx_pn=%02x%02x%02x%02x%02x%02x replays=%d icv_errors=%d local_mic_failures=%d\n"
 3077      25645D20 
 3077      616C673D 
 3077      544B4950 
 3077      206B6579 
 3078              	.text
 3080              	ieee80211_tkip_print_stats:
 3081              	.LFB711:
 690:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 691:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static char *ieee80211_tkip_print_stats(char *p, void *priv)
 692:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 3082              	.loc 1 692 0
 3083 0fc6 53       	pushl %ebx
 3084              	.LCFI311:
 3085              	.loc 1 692 0
 3086 0fc7 8B4C240C 	movl 12(%esp),%ecx
 3087 0fcb 8B5C2408 	movl 8(%esp),%ebx
 693:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	struct ieee80211_tkip_data *tkip = priv;
 694:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	p += sprintf(p, "key[%d] alg=TKIP key_set=%d "
 3088              	.loc 1 694 0
 3089 0fcf FF715C   	pushl 92(%ecx)
 3090              	.LCFI312:
 3091 0fd2 FF7158   	pushl 88(%ecx)
 3092              	.LCFI313:
 3093 0fd5 FF7154   	pushl 84(%ecx)
 3094              	.LCFI314:
 3095 0fd8 668B413C 	movw 60(%ecx),%ax
 3096 0fdc 0FB6D0   	movzbl %al,%edx
 3097 0fdf 52       	pushl %edx
 3098              	.LCFI315:
 3099 0fe0 0FB6C4   	movzbl %ah,%eax
 3100 0fe3 50       	pushl %eax
 3101              	.LCFI316:
 3102 0fe4 8B4138   	movl 56(%ecx),%eax
 3103 0fe7 0FB6D0   	movzbl %al,%edx
 3104 0fea 52       	pushl %edx
 3105              	.LCFI317:
GAS LISTING  			page 119


 3106 0feb 0FB6D4   	movzbl %ah,%edx
 3107 0fee C1E810   	shrl $16,%eax
 3108 0ff1 52       	pushl %edx
 3109              	.LCFI318:
 3110 0ff2 0FB6D0   	movzbl %al,%edx
 3111 0ff5 52       	pushl %edx
 3112              	.LCFI319:
 3113 0ff6 C1E808   	shrl $8,%eax
 3114 0ff9 50       	pushl %eax
 3115              	.LCFI320:
 3116 0ffa 668B4128 	movw 40(%ecx),%ax
 3117 0ffe 0FB6D0   	movzbl %al,%edx
 3118 1001 52       	pushl %edx
 3119              	.LCFI321:
 3120 1002 0FB6C4   	movzbl %ah,%eax
 3121 1005 50       	pushl %eax
 3122              	.LCFI322:
 3123 1006 8B4124   	movl 36(%ecx),%eax
 3124 1009 0FB6D0   	movzbl %al,%edx
 3125 100c 52       	pushl %edx
 3126              	.LCFI323:
 3127 100d 0FB6D4   	movzbl %ah,%edx
 3128 1010 C1E810   	shrl $16,%eax
 3129 1013 52       	pushl %edx
 3130              	.LCFI324:
 3131 1014 0FB6D0   	movzbl %al,%edx
 3132 1017 52       	pushl %edx
 3133              	.LCFI325:
 3134 1018 C1E808   	shrl $8,%eax
 3135 101b 50       	pushl %eax
 3136              	.LCFI326:
 3137 101c FF7120   	pushl 32(%ecx)
 3138              	.LCFI327:
 3139 101f FF7160   	pushl 96(%ecx)
 3140              	.LCFI328:
 3141 1022 68090400 	pushl $.LC18
 3141      00
 3142              	.LCFI329:
 3143 1027 53       	pushl %ebx
 3144              	.LCFI330:
 3145 1028 E8FCFFFF 	call sprintf
 3145      FF
 3146 102d 01C3     	addl %eax,%ebx
 695:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     "tx_pn=%02x%02x%02x%02x%02x%02x "
 696:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     "rx_pn=%02x%02x%02x%02x%02x%02x "
 697:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     "replays=%d icv_errors=%d local_mic_failures=%d\n",
 698:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     tkip->key_idx, tkip->key_set,
 699:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     (tkip->tx_iv32 >> 24) & 0xff,
 700:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     (tkip->tx_iv32 >> 16) & 0xff,
 701:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     (tkip->tx_iv32 >> 8) & 0xff,
 702:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     tkip->tx_iv32 & 0xff,
 703:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     (tkip->tx_iv16 >> 8) & 0xff,
 704:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     tkip->tx_iv16 & 0xff,
 705:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     (tkip->rx_iv32 >> 24) & 0xff,
 706:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     (tkip->rx_iv32 >> 16) & 0xff,
 707:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     (tkip->rx_iv32 >> 8) & 0xff,
 708:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     tkip->rx_iv32 & 0xff,
GAS LISTING  			page 120


 709:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     (tkip->rx_iv16 >> 8) & 0xff,
 710:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     tkip->rx_iv16 & 0xff,
 711:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     tkip->dot11RSNAStatsTKIPReplays,
 712:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     tkip->dot11RSNAStatsTKIPICVErrors,
 713:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 		     tkip->dot11RSNAStatsTKIPLocalMICFailures);
 714:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return p;
 3147              	.loc 1 714 0
 3148 102f 83C44C   	addl $76,%esp
 3149              	.LCFI331:
 715:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 3150              	.loc 1 715 0
 3151 1032 89D8     	movl %ebx,%eax
 3152 1034 5B       	popl %ebx
 3153 1035 C3       	ret
 3154              	.LFE711:
 3156              	.section .rodata.str1.1
 3157              	.LC19:
 3158 0493 544B4950 	.string "TKIP"
 3158      00
 3159              	.data
 3160              	.align 32
 3163              	ieee80211_crypt_tkip:
 3164 0000 93040000 	.long .LC19
 3165 0004 00000000 	.zero 8
 3165      00000000 
 3166 000c 20000000 	.long ieee80211_tkip_init
 3167 0010 BB000000 	.long ieee80211_tkip_deinit
 3168 0014 62040000 	.long ieee80211_tkip_hdr
 3169 0018 72050000 	.long ieee80211_tkip_encrypt
 3170 001c E0060000 	.long ieee80211_tkip_decrypt
 3171 0020 380C0000 	.long ieee80211_michael_mic_add
 3172 0024 9E0D0000 	.long ieee80211_michael_mic_verify
 3173 0028 B60E0000 	.long ieee80211_tkip_set_key
 3174 002c 640F0000 	.long ieee80211_tkip_get_key
 3175 0030 C60F0000 	.long ieee80211_tkip_print_stats
 3176 0034 15000000 	.long ieee80211_tkip_get_flags
 3177 0038 00000000 	.long ieee80211_tkip_set_flags
 3178 003c 08000000 	.long 8
 3179 0040 04000000 	.long 4
 3180 0044 00000000 	.zero 4
 3181 0048 08000000 	.long 8
 3182 004c 00000000 	.long __this_module
 3183              	.section .init.text,"ax",@progbits
 3185              	ieee80211_crypto_tkip_init:
 3186              	.LFB712:
 716:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 717:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static struct ieee80211_crypto_ops ieee80211_crypt_tkip = {
 718:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.name = "TKIP",
 719:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.init = ieee80211_tkip_init,
 720:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.deinit = ieee80211_tkip_deinit,
 721:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.build_iv = ieee80211_tkip_hdr,
 722:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.encrypt_mpdu = ieee80211_tkip_encrypt,
 723:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.decrypt_mpdu = ieee80211_tkip_decrypt,
 724:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.encrypt_msdu = ieee80211_michael_mic_add,
 725:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.decrypt_msdu = ieee80211_michael_mic_verify,
 726:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.set_key = ieee80211_tkip_set_key,
 727:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.get_key = ieee80211_tkip_get_key,
GAS LISTING  			page 121


 728:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.print_stats = ieee80211_tkip_print_stats,
 729:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.extra_mpdu_prefix_len = 4 + 4,	/* IV + ExtIV */
 730:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.extra_mpdu_postfix_len = 4,	/* ICV */
 731:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.extra_msdu_postfix_len = 8,	/* MIC */
 732:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.get_flags = ieee80211_tkip_get_flags,
 733:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.set_flags = ieee80211_tkip_set_flags,
 734:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	.owner = THIS_MODULE,
 735:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** };
 736:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 737:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static int __init ieee80211_crypto_tkip_init(void)
 738:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 3187              	.loc 1 738 0
 739:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	return ieee80211_register_crypto_ops(&ieee80211_crypt_tkip);
 3188              	.loc 1 739 0
 3189 0000 68000000 	pushl $ieee80211_crypt_tkip
 3189      00
 3190              	.LCFI332:
 3191 0005 E8FCFFFF 	call ieee80211_register_crypto_ops
 3191      FF
 3192 000a 5A       	popl %edx
 3193              	.LCFI333:
 740:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** }
 3194              	.loc 1 740 0
 3195 000b C3       	ret
 3196              	.LFE712:
 3198              	.section .exit.text,"ax",@progbits
 3200              	ieee80211_crypto_tkip_exit:
 3201              	.LFB713:
 741:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 
 742:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** static void __exit ieee80211_crypto_tkip_exit(void)
 743:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** {
 3202              	.loc 1 743 0
 744:/home/usuario/ipw3945install/ieee80211-1.1.12/ieee80211_crypt_tkip.c **** 	ieee80211_unregister_crypto_ops(&ieee80211_crypt_tkip);
 3203              	.loc 1 744 0
 3204 0000 68000000 	pushl $ieee80211_crypt_tkip
 3204      00
 3205              	.LCFI334:
 3206 0005 E8FCFFFF 	call ieee80211_unregister_crypto_ops
 3206      FF
 3207 000a 59       	popl %ecx
 3208              	.LCFI335:
 3209 000b C3       	ret
 3210              	.LFE713:
 3212              	.globl init_module
 3213              	.set init_module,ieee80211_crypto_tkip_init
 3214              	.globl cleanup_module
 3215              	.set cleanup_module,ieee80211_crypto_tkip_exit
 5441              	.Letext0:
 31826              	.ident "GCC: (GNU) 3.4.5 20050809 (prerelease) (Ubuntu 3.4.4-6ubuntu8.1)"
GAS LISTING  			page 122


DEFINED SYMBOLS
                            *ABS*:0000000000000000 ieee80211_crypt_tkip.c
 {entrada estndar}:13     .modinfo:0000000000000000 __mod_author29
 {entrada estndar}:18     .modinfo:0000000000000020 __mod_description30
 {entrada estndar}:22     .modinfo:0000000000000040 __mod_license31
 {entrada estndar}:26     .text:0000000000000000 ieee80211_tkip_set_flags
 {entrada estndar}:42     .text:0000000000000015 ieee80211_tkip_get_flags
 {entrada estndar}:63     .text:0000000000000020 ieee80211_tkip_init
 {entrada estndar}:223    .text:00000000000000bb ieee80211_tkip_deinit
 {entrada estndar}:265    .rodata:0000000000000000 Sbox
 {entrada estndar}:524    .text:00000000000000ea tkip_mixing_phase1
 {entrada estndar}:748    .text:000000000000027d tkip_mixing_phase2
 {entrada estndar}:1018   .text:0000000000000462 ieee80211_tkip_hdr
 {entrada estndar}:1221   .text:0000000000000572 ieee80211_tkip_encrypt
 {entrada estndar}:1516   .text:00000000000006e0 ieee80211_tkip_decrypt
 {entrada estndar}:2082   .text:0000000000000ab4 michael_mic
 {entrada estndar}:2298   .text:0000000000000b9a michael_mic_hdr
 {entrada estndar}:2413   .text:0000000000000c38 ieee80211_michael_mic_add
 {entrada estndar}:2588   .text:0000000000000d02 ieee80211_michael_mic_failure
 {entrada estndar}:2689   .text:0000000000000d9e ieee80211_michael_mic_verify
 {entrada estndar}:2886   .text:0000000000000eb6 ieee80211_tkip_set_key
 {entrada estndar}:3003   .text:0000000000000f64 ieee80211_tkip_get_key
 {entrada estndar}:3080   .text:0000000000000fc6 ieee80211_tkip_print_stats
 {entrada estndar}:3163   .data:0000000000000000 ieee80211_crypt_tkip
 {entrada estndar}:3185   .init.text:0000000000000000 ieee80211_crypto_tkip_init
 {entrada estndar}:3200   .exit.text:0000000000000000 ieee80211_crypto_tkip_exit
 {entrada estndar}:3185   .init.text:0000000000000000 init_module
 {entrada estndar}:3200   .exit.text:0000000000000000 cleanup_module

UNDEFINED SYMBOLS
malloc_sizes
kmem_cache_alloc
crypto_alloc_tfm
printk
crypto_free_tfm
kfree
skb_under_panic
memmove
net_ratelimit
skb_over_panic
crc32_le
mem_map
memcmp
___pskb_trim
sprintf
wireless_send_event
__this_module
ieee80211_register_crypto_ops
ieee80211_unregister_crypto_ops
